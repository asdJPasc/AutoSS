/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 0.7.2 -> Note to Marc: Also change var VERSION below.
 * @requires jQuery v1.4.2 or greater - jQuery 1.7+ recommended
 *
 * Copyright (c) 2009-2012 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */

(function ($) {

	// Version info
	var VERSION					= "0.7.2";

	// String constants
	//   General
	var SLASH					= "/";
	var TXTColumnNotFound		= "Column not found on page";
	var SCHEMASharePoint		= "http://schemas.microsoft.com/sharepoint";

	//   Web Service names
	var ALERTS					= "Alerts";
	var AUTHENTICATION			= "Authentication";
	var COPY					= "Copy";
	var FORMS					= "Forms";
	var LISTS					= "Lists";
	var MEETINGS				= "Meetings";
	var PEOPLE					= "People";
	var PERMISSIONS				= "Permissions";
	var PUBLISHEDLINKSSERVICE	= "PublishedLinksService";
	var SEARCH					= "Search";
	var SHAREPOINTDIAGNOSTICS	= "SharePointDiagnostics";
	var SITEDATA				= "SiteData";
	var SITES					= "Sites";
	var SOCIALDATASERVICE		= "SocialDataService";
	var SPELLCHECK				= "SpellCheck";
    var TAXONOMYSERVICE			= "TaxonomyClientService";
	var USERGROUP				= "usergroup";
	var USERPROFILESERVICE		= "UserProfileService";
	var VERSIONS				= "Versions";
	var VIEWS					= "Views";
	var WEBPARTPAGES			= "WebPartPages";
	var WEBS					= "Webs";
	var WORKFLOW				= "Workflow";

	// Global variables
	var thisSite = "";		// The current site
	var thisList = "";		// The current list when in a list context
	var i = 0;				// Generic loop counter
	var t = "";				// Temporary string variable

	// Array to store Web Service information
	//	WSops.OpName = [WebService, needs_SOAPAction];
	//		OpName				The name of the Web Service operation -> These names are unique
	//		WebService			The name of the WebService this operation belongs to
	//		needs_SOAPAction	Boolean indicating whether the operatio needs to have the SOAPAction passed in the setRequestHeaderfunction.
	//							true if the operation does a write, else false

	var WSops = [];

	WSops.GetAlerts									= [ALERTS, false];
	WSops.DeleteAlerts								= [ALERTS, true];

	WSops.Mode										= [AUTHENTICATION, false];
	WSops.Login										= [AUTHENTICATION, false];

	WSops.CopyIntoItems								= [COPY, true];
	WSops.CopyIntoItemsLocal						= [COPY, true];
	WSops.GetItem									= [COPY, false];

	WSops.GetForm									= [FORMS, false];
	WSops.GetFormCollection							= [FORMS, false];

	WSops.AddAttachment								= [LISTS, true];
	WSops.AddDiscussionBoardItem					= [LISTS, true];
	WSops.AddList									= [LISTS, true];
	WSops.AddListFromFeature						= [LISTS, true];
	WSops.ApplyContentTypeToList					= [LISTS, true];
	WSops.CheckInFile								= [LISTS, true];
	WSops.CheckOutFile								= [LISTS, true];
	WSops.CreateContentType							= [LISTS, true];
	WSops.DeleteAttachment							= [LISTS, true];
	WSops.DeleteContentType							= [LISTS, true];
	WSops.DeleteContentTypeXmlDocument				= [LISTS, true];
	WSops.DeleteList								= [LISTS, true];
	WSops.GetAttachmentCollection					= [LISTS, false];
	WSops.GetList									= [LISTS, false];
	WSops.GetListAndView							= [LISTS, false];
	WSops.GetListCollection							= [LISTS, false];
	WSops.GetListContentType						= [LISTS, false];
	WSops.GetListContentTypes						= [LISTS, false];
	WSops.GetListItemChanges						= [LISTS, false];
	WSops.GetListItemChangesSinceToken				= [LISTS, false];
	WSops.GetListItems								= [LISTS, false];
	WSops.GetVersionCollection						= [LISTS, false];
	WSops.UndoCheckOut								= [LISTS, true];
	WSops.UpdateContentType							= [LISTS, true];
	WSops.UpdateContentTypesXmlDocument				= [LISTS, true];
	WSops.UpdateContentTypeXmlDocument				= [LISTS, true];
	WSops.UpdateList								= [LISTS, true];
	WSops.UpdateListItems							= [LISTS, true];

	WSops.AddMeeting								= [MEETINGS, true];
	WSops.CreateWorkspace							= [MEETINGS, true];
	WSops.RemoveMeeting								= [MEETINGS, true];
	WSops.SetWorkSpaceTitle							= [MEETINGS, true];

	WSops.ResolvePrincipals							= [PEOPLE, false];
	WSops.SearchPrincipals							= [PEOPLE, false];

	WSops.AddPermission								= [PERMISSIONS, true];
	WSops.AddPermissionCollection					= [PERMISSIONS, true];
	WSops.GetPermissionCollection					= [PERMISSIONS, true];
	WSops.RemovePermission							= [PERMISSIONS, true];
	WSops.RemovePermissionCollection				= [PERMISSIONS, true];
	WSops.UpdatePermission							= [PERMISSIONS, true];

	WSops.GetLinks									= [PUBLISHEDLINKSSERVICE, true];

	WSops.GetPortalSearchInfo						= [SEARCH, false];
	WSops.GetQuerySuggestions						= [SEARCH, false];
	WSops.GetSearchMetadata							= [SEARCH, false];
	WSops.Query										= [SEARCH, false];
	WSops.QueryEx									= [SEARCH, false];
	WSops.Registration								= [SEARCH, false];
	WSops.Status									= [SEARCH, false];

	WSops.SendClientScriptErrorReport				= [SHAREPOINTDIAGNOSTICS,true];

	WSops.GetAttachments							= [SITEDATA, false];
	WSops.EnumerateFolder							= [SITEDATA, false];
	WSops.SiteDataGetList							= [SITEDATA, false];
	WSops.SiteDataGetListCollection					= [SITEDATA, false];
	WSops.SiteDataGetSite							= [SITEDATA, false];
	WSops.SiteDataGetSiteUrl						= [SITEDATA, false];
	WSops.SiteDataGetWeb							= [SITEDATA, false];

	WSops.CreateWeb									= [SITES, true];
	WSops.DeleteWeb									= [SITES, false];
	WSops.GetSite									= [SITES, false];
	WSops.GetSiteTemplates							= [SITES, false];

	WSops.AddComment								= [SOCIALDATASERVICE, true];
	WSops.AddTag									= [SOCIALDATASERVICE, true];
	WSops.AddTagByKeyword							= [SOCIALDATASERVICE, true];
	WSops.CountCommentsOfUser						= [SOCIALDATASERVICE, false];
	WSops.CountCommentsOfUserOnUrl					= [SOCIALDATASERVICE, false];
	WSops.CountCommentsOnUrl						= [SOCIALDATASERVICE, false];
	WSops.CountRatingsOnUrl							= [SOCIALDATASERVICE, false];
	WSops.CountTagsOfUser							= [SOCIALDATASERVICE, false];
	WSops.DeleteComment								= [SOCIALDATASERVICE, true];
	WSops.DeleteRating								= [SOCIALDATASERVICE, true];
	WSops.DeleteTag									= [SOCIALDATASERVICE, true];
	WSops.DeleteTagByKeyword						= [SOCIALDATASERVICE, true];
	WSops.DeleteTags								= [SOCIALDATASERVICE, true];
	WSops.GetAllTagTerms							= [SOCIALDATASERVICE, false];
	WSops.GetAllTagTermsForUrlFolder				= [SOCIALDATASERVICE, false];
	WSops.GetAllTagUrls								= [SOCIALDATASERVICE, false];
	WSops.GetAllTagUrlsByKeyword					= [SOCIALDATASERVICE, false];
	WSops.GetCommentsOfUser							= [SOCIALDATASERVICE, false];
	WSops.GetCommentsOfUserOnUrl					= [SOCIALDATASERVICE, false];
	WSops.GetCommentsOnUrl							= [SOCIALDATASERVICE, false];
	WSops.GetRatingAverageOnUrl						= [SOCIALDATASERVICE, false];
	WSops.GetRatingOfUserOnUrl						= [SOCIALDATASERVICE, false];
	WSops.GetRatingOnUrl							= [SOCIALDATASERVICE, false];
	WSops.GetRatingsOfUser							= [SOCIALDATASERVICE, false];
	WSops.GetRatingsOnUrl							= [SOCIALDATASERVICE, false];
	WSops.GetSocialDataForFullReplication			= [SOCIALDATASERVICE, false];
	WSops.GetTags									= [SOCIALDATASERVICE, true];
	WSops.GetTagsOfUser								= [SOCIALDATASERVICE, true];
	WSops.GetTagTerms								= [SOCIALDATASERVICE, true];
	WSops.GetTagTermsOfUser							= [SOCIALDATASERVICE, true];
	WSops.GetTagTermsOnUrl							= [SOCIALDATASERVICE, true];
	WSops.GetTagUrlsOfUser							= [SOCIALDATASERVICE, true];
	WSops.GetTagUrlsOfUserByKeyword					= [SOCIALDATASERVICE, true];
	WSops.GetTagUrls								= [SOCIALDATASERVICE, true];
	WSops.GetTagUrlsByKeyword						= [SOCIALDATASERVICE, true];
	WSops.SetRating									= [SOCIALDATASERVICE, true];
	WSops.UpdateComment								= [SOCIALDATASERVICE, true];

	WSops.SpellCheck								= [SPELLCHECK, false];

    // Taxonomy Service Calls
    // Updated 2011.01.27 by Thomas McMillan
    WSops.AddTerms									= [TAXONOMYSERVICE, true];
    WSops.GetChildTermsInTerm						= [TAXONOMYSERVICE, false];
    WSops.GetChildTermsInTermSet					= [TAXONOMYSERVICE, false];
    WSops.GetKeywordTermsByGuids					= [TAXONOMYSERVICE, false];
    WSops.GetTermsByLabel							= [TAXONOMYSERVICE, false];
    WSops.GetTermSets								= [TAXONOMYSERVICE, false];

	WSops.AddGroup									= [USERGROUP, true];
	WSops.AddGroupToRole							= [USERGROUP, true];
	WSops.AddRole									= [USERGROUP, true];
	WSops.AddRoleDef								= [USERGROUP, true];
	WSops.AddUserCollectionToGroup					= [USERGROUP, true];
	WSops.AddUserCollectionToRole					= [USERGROUP, true];
	WSops.AddUserToGroup							= [USERGROUP, true];
	WSops.AddUserToRole								= [USERGROUP, true];
	WSops.GetAllUserCollectionFromWeb				= [USERGROUP, false];
	WSops.GetGroupCollection						= [USERGROUP, false];
	WSops.GetGroupCollectionFromRole				= [USERGROUP, false];
	WSops.GetGroupCollectionFromSite				= [USERGROUP, false];
	WSops.GetGroupCollectionFromUser				= [USERGROUP, false];
	WSops.GetGroupCollectionFromWeb					= [USERGROUP, false];
	WSops.GetGroupInfo								= [USERGROUP, false];
	WSops.GetRoleCollection							= [USERGROUP, false];
	WSops.GetRoleCollectionFromGroup				= [USERGROUP, false];
	WSops.GetRoleCollectionFromUser					= [USERGROUP, false];
	WSops.GetRoleCollectionFromWeb					= [USERGROUP, false];
	WSops.GetRoleInfo								= [USERGROUP, false];
	WSops.GetRolesAndPermissionsForCurrentUser		= [USERGROUP, false];
	WSops.GetRolesAndPermissionsForSite				= [USERGROUP, false];
	WSops.GetUserCollection							= [USERGROUP, false];
	WSops.GetUserCollectionFromGroup				= [USERGROUP, false];
	WSops.GetUserCollectionFromRole					= [USERGROUP, false];
	WSops.GetUserCollectionFromSite					= [USERGROUP, false];
	WSops.GetUserCollectionFromWeb					= [USERGROUP, false];
	WSops.GetUserInfo								= [USERGROUP, false];
	WSops.GetUserLoginFromEmail						= [USERGROUP, false];
	WSops.RemoveGroup								= [USERGROUP, true];
	WSops.RemoveGroupFromRole						= [USERGROUP, true];
	WSops.RemoveRole								= [USERGROUP, true];
	WSops.RemoveUserCollectionFromGroup				= [USERGROUP, true];
	WSops.RemoveUserCollectionFromRole				= [USERGROUP, true];
	WSops.RemoveUserCollectionFromSite				= [USERGROUP, true];
	WSops.RemoveUserFromGroup						= [USERGROUP, true];
	WSops.RemoveUserFromRole						= [USERGROUP, true];
	WSops.RemoveUserFromSite						= [USERGROUP, true];
	WSops.RemoveUserFromWeb							= [USERGROUP, true];
	WSops.UpdateGroupInfo							= [USERGROUP, true];
	WSops.UpdateRoleDefInfo							= [USERGROUP, true];
	WSops.UpdateRoleInfo							= [USERGROUP, true];
	WSops.UpdateUserInfo							= [USERGROUP, true];

	WSops.AddColleague								= [USERPROFILESERVICE, true]; 
	WSops.AddLink									= [USERPROFILESERVICE, true];
	WSops.AddMembership								= [USERPROFILESERVICE, true]; 
	WSops.AddPinnedLink								= [USERPROFILESERVICE, true];
	WSops.CreateMemberGroup							= [USERPROFILESERVICE, true]; 
	WSops.CreateUserProfileByAccountName			= [USERPROFILESERVICE, true];
	WSops.GetCommonColleagues						= [USERPROFILESERVICE, false];
	WSops.GetCommonManager							= [USERPROFILESERVICE, false];
	WSops.GetCommonMemberships						= [USERPROFILESERVICE, false];
	WSops.GetInCommon								= [USERPROFILESERVICE, false];
	WSops.GetPropertyChoiceList						= [USERPROFILESERVICE, false];
	WSops.GetUserColleagues							= [USERPROFILESERVICE, false];
	WSops.GetUserLinks								= [USERPROFILESERVICE, false];
	WSops.GetUserMemberships						= [USERPROFILESERVICE, false];
	WSops.GetUserPinnedLinks						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileByGuid						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileByIndex						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileByName						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileCount						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileSchema						= [USERPROFILESERVICE, false];
	WSops.ModifyUserPropertyByAccountName			= [USERPROFILESERVICE, true];
	WSops.RemoveAllColleagues						= [USERPROFILESERVICE, true];
	WSops.RemoveAllLinks							= [USERPROFILESERVICE, true];
	WSops.RemoveAllMemberships						= [USERPROFILESERVICE, true];
	WSops.RemoveAllPinnedLinks						= [USERPROFILESERVICE, true];
	WSops.RemoveColleague							= [USERPROFILESERVICE, true];
	WSops.RemoveLink								= [USERPROFILESERVICE, true];
	WSops.RemoveMembership							= [USERPROFILESERVICE, true];
	WSops.RemovePinnedLink							= [USERPROFILESERVICE, true]; 
	WSops.UpdateColleaguePrivacy					= [USERPROFILESERVICE, true];
	WSops.UpdateLink								= [USERPROFILESERVICE, true];
	WSops.UpdateMembershipPrivacy					= [USERPROFILESERVICE, true];
	WSops.UpdatePinnedLink							= [USERPROFILESERVICE, true];

	WSops.DeleteAllVersions							= [VERSIONS, true];
	WSops.DeleteVersion								= [VERSIONS, true];
	WSops.GetVersions								= [VERSIONS, false];
	WSops.RestoreVersion							= [VERSIONS, true];

	WSops.AddView									= [VIEWS, true];
	WSops.DeleteView								= [VIEWS, true];
	WSops.GetView									= [VIEWS, false];
	WSops.GetViewHtml								= [VIEWS, false];
	WSops.GetViewCollection							= [VIEWS, false];
	WSops.UpdateView								= [VIEWS, true];
	WSops.UpdateViewHtml							= [VIEWS, true];

	WSops.AddWebPart								= [WEBPARTPAGES, true];
	WSops.AddWebPartToZone							= [WEBPARTPAGES, true];
	WSops.GetWebPart2								= [WEBPARTPAGES, false];
	WSops.GetWebPartPage							= [WEBPARTPAGES, false];
	WSops.GetWebPartProperties						= [WEBPARTPAGES, false];
	WSops.GetWebPartProperties2						= [WEBPARTPAGES, false];

	WSops.CreateContentType							= [WEBS, true];
	WSops.GetColumns								= [WEBS, false];
	WSops.GetContentType							= [WEBS, false];
	WSops.GetContentTypes							= [WEBS, false];
	WSops.GetCustomizedPageStatus					= [WEBS, false];
	WSops.GetListTemplates							= [WEBS, false];
	WSops.GetObjectIdFromUrl						= [WEBS, false]; // 2010
	WSops.GetWeb									= [WEBS, false];
	WSops.GetWebCollection							= [WEBS, false];
	WSops.GetAllSubWebCollection					= [WEBS, false];
	WSops.UpdateColumns								= [WEBS, true];
	WSops.UpdateContentType							= [WEBS, true];
	WSops.WebUrlFromPageUrl							= [WEBS, false];

	WSops.AlterToDo									= [WORKFLOW, true];
	WSops.GetTemplatesForItem						= [WORKFLOW, false];
	WSops.GetToDosForItem							= [WORKFLOW, false];
	WSops.GetWorkflowDataForItem					= [WORKFLOW, false];
	WSops.GetWorkflowTaskData						= [WORKFLOW, false];
	WSops.StartWorkflow								= [WORKFLOW, true];

	// Set up SOAP envelope
	var SOAPEnvelope = {};
	SOAPEnvelope.header = "<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";
	SOAPEnvelope.footer = "</soap:Body></soap:Envelope>";
	SOAPEnvelope.payload = "";
	var SOAPAction;


	// Main function, which calls SharePoint's Web Services directly.
	$.fn.SPServices = function(options) {

		// If there are no options passed in, use the defaults.  Extend replaces each default with the passed option.
		var opt = $.extend({}, $.fn.SPServices.defaults, options);

		// Put together operation header and SOAPAction for the SOAP call based on which Web Service we're calling
		SOAPEnvelope.opheader = "<" + opt.operation + " ";
		switch(WSops[opt.operation][0]) {
			case ALERTS:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/2002/1/alerts/' >";
				SOAPAction = SCHEMASharePoint + "/soap/2002/1/alerts/";
				break;
			case MEETINGS:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/meetings/' >";
				SOAPAction = SCHEMASharePoint + "/soap/meetings/";
				break;
			case PERMISSIONS:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/directory/' >";
				SOAPAction = SCHEMASharePoint + "/soap/directory/";
				break;
			case PUBLISHEDLINKSSERVICE:
				SOAPEnvelope.opheader += "xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";
				SOAPAction = "http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";
				break;
			case SEARCH:
				SOAPEnvelope.opheader += "xmlns='urn:Microsoft.Search' >";
				SOAPAction = "urn:Microsoft.Search/";
				break;
			case SHAREPOINTDIAGNOSTICS:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/diagnostics/' >";
				SOAPAction = "http://schemas.microsoft.com/sharepoint/diagnostics/";
				break;
			case SOCIALDATASERVICE:
				SOAPEnvelope.opheader += "xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >";
				SOAPAction = "http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";
				break;
			case SPELLCHECK:
				SOAPEnvelope.opheader += "xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/'";
				SOAPAction = "http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";
				break;
            case TAXONOMYSERVICE:
                SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/taxonomy/soap/' >";
                SOAPAction = SCHEMASharePoint + "/taxonomy/soap/";
                break;
			case USERGROUP:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/directory/' >";
				SOAPAction = SCHEMASharePoint + "/soap/directory/";
				break;
			case USERPROFILESERVICE:
				SOAPEnvelope.opheader += "xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";
				SOAPAction = "http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";
				break;
			case WEBPARTPAGES:
				SOAPEnvelope.opheader += "xmlns='http://microsoft.com/sharepoint/webpartpages' >";
				SOAPAction = "http://microsoft.com/sharepoint/webpartpages/";
				break;
			case WORKFLOW:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/workflow/' >";
				SOAPAction = SCHEMASharePoint + "/soap/workflow/";
				break;
			default:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/'>";
				SOAPAction = SCHEMASharePoint + "/soap/";
				break;
		}
		
		// Add the operation to the SOAPAction and opfooter
		SOAPAction += opt.operation;
		SOAPEnvelope.opfooter = "</" + opt.operation + ">";

		// Build the URL for the Ajax call based on which operation we're calling
		// If the webURL has been provided, then use it, else use the current site
		var ajaxURL = "_vti_bin/" + WSops[opt.operation][0] + ".asmx";
		if(opt.webURL.charAt(opt.webURL.length - 1) === SLASH) {
			ajaxURL = opt.webURL + ajaxURL;
		} else if(opt.webURL.length > 0) {
			ajaxURL = opt.webURL + SLASH + ajaxURL;
		} else {
			ajaxURL = $().SPServices.SPGetCurrentSite() + SLASH + ajaxURL;
		}

		SOAPEnvelope.payload = "";
		// Each operation requires a different set of values.  This switch statement sets them up in the SOAPEnvelope.payload.
		switch(opt.operation) {
			// ALERT OPERATIONS
			case "GetAlerts":
				break;
			case "DeleteAlerts":
				SOAPEnvelope.payload += "<IDs>";
				for (i=0; i < opt.IDs.length; i++) {
					SOAPEnvelope.payload += wrapNode("string", opt.IDs[i]);
				}
				SOAPEnvelope.payload += "</IDs>";
				break;

			// AUTHENTICATION OPERATIONS
			case "Mode":
				break;
			case "Login":
				addToPayload(opt, ["username", "password"]);
				break;

			// COPY OPERATIONS
			case "CopyIntoItems":
				addToPayload(opt, ["SourceUrl"]);
				SOAPEnvelope.payload += "<DestinationUrls>";
				for (i=0; i < opt.DestinationUrls.length; i++) {
					SOAPEnvelope.payload += wrapNode("string", opt.DestinationUrls[i]);
				}
				SOAPEnvelope.payload += "</DestinationUrls>";
				addToPayload(opt, ["Fields", "Stream", "Results"]);
				break;
			case "CopyIntoItemsLocal":
				addToPayload(opt, ["SourceUrl"]);
				SOAPEnvelope.payload += "<DestinationUrls>";
				for (i=0; i < opt.DestinationUrls.length; i++) {
					SOAPEnvelope.payload += wrapNode("string", opt.DestinationUrls[i]);
				}
				SOAPEnvelope.payload += "</DestinationUrls>";
				break;
			case "GetItem":
				addToPayload(opt, ["Url", "Fields", "Stream"]);
				break;

			// FORM OPERATIONS
			case "GetForm":
				addToPayload(opt, ["listName", "formUrl"]);
				break;
			case "GetFormCollection":
				addToPayload(opt, ["listName"]);
				break;

			// LIST OPERATIONS
			case "AddAttachment":
				addToPayload(opt, ["listName", "listItemID", "fileName", "attachment"]);
				break;
			case "AddDiscussionBoardItem":
				addToPayload(opt, ["listName", "message"]);
				break;
			case "AddList":
				addToPayload(opt, ["listName", "description", "templateID"]);
				break;
			case "AddListFromFeature":
				addToPayload(opt, ["listName", "description", "featureID", "templateID"]);
				break;
			case "ApplyContentTypeToList":
				addToPayload(opt, ["webUrl", "contentTypeId", "listName"]);
				break;
			case "CheckInFile":
				addToPayload(opt, ["pageUrl", "comment", "CheckinType"]);
				break;
			case "CheckOutFile":
				addToPayload(opt, ["pageUrl", "checkoutToLocal", "lastmodified"]);
				break;
			case "CreateContentType":
				addToPayload(opt, ["listName", "displayName", "parentType", "fields", "contentTypeProperties", "addToView"]);
				break;
			case "DeleteAttachment":
				addToPayload(opt, ["listName", "listItemID", "url"]);
				break;
			case "DeleteContentType":
				addToPayload(opt, ["listName", "contentTypeId"]);
				break;
			case "DeleteContentTypeXmlDocument":
				addToPayload(opt, ["listName", "contentTypeId", "documentUri"]);
				break;
			case "DeleteList":
				addToPayload(opt, ["listName"]);
				break;
			case "GetAttachmentCollection":
				addToPayload(opt, ["listName", ["listItemID", "ID"]]);
				break;
			case "GetList":
				addToPayload(opt, ["listName"]);
				break;
			case "GetListAndView":
				addToPayload(opt, ["listName", "viewName"]);
				break;
			case "GetListCollection":
				break;
			case "GetListContentType":
				addToPayload(opt, ["listName", "contentTypeId"]);
				break;
			case "GetListContentTypes":
				addToPayload(opt, ["listName"]);
				break;
			case "GetListItems":
				addToPayload(opt, ["listName", "viewName", ["query", "CAMLQuery"], ["viewFields", "CAMLViewFields"], ["rowLimit", "CAMLRowLimit"], ["queryOptions", "CAMLQueryOptions"]]);
				break;
			case "GetListItemChanges":
				addToPayload(opt, ["listName", "viewFields", "since", "contains"]);
				break;
			case "GetListItemChangesSinceToken":
				addToPayload(opt, ["listName", "viewName", "query", "viewFields", "rowLimit", "queryOptions", "changeToken", "contains"]);
				break;
			case "GetVersionCollection":
				addToPayload(opt, ["strlistID", "strlistItemID", "strFieldName"]);
				break;
			case "UndoCheckOut":
				addToPayload(opt, ["pageUrl"]);
				break;
			case "UpdateContentType":
				addToPayload(opt, ["listName", "contentTypeId", "contentTypeProperties", "newFields", "updateFields", "deleteFields", "addToView"]);
				break;
			case "UpdateContentTypesXmlDocument":
				addToPayload(opt, ["listName", "newDocument"]);
				break;
			case "UpdateContentTypeXmlDocument":
				addToPayload(opt, ["listName", "contentTypeId", "newDocument"]);
				break;
			case "UpdateList":
				addToPayload(opt, ["listName", "listProperties", "newFields", "updateFields", "deleteFields", "listVersion"]);
				break;
			case "UpdateListItems":
				addToPayload(opt, ["listName"]);
				if(opt.updates !== undefined && opt.updates.length > 0) {
					addToPayload(opt, ["updates"]);
				} else {
					SOAPEnvelope.payload += "<updates><Batch OnError='Continue'><Method ID='1' Cmd='" + opt.batchCmd + "'>";
					for (i=0; i < opt.valuepairs.length; i++) { 
						SOAPEnvelope.payload += "<Field Name='" + opt.valuepairs[i][0] + "'>" + escapeColumnValue(opt.valuepairs[i][1]) + "</Field>";
					}
					if(opt.batchCmd !== "New") {
						SOAPEnvelope.payload += "<Field Name='ID'>" + opt.ID + "</Field>";
					}
					SOAPEnvelope.payload += "</Method></Batch></updates>";
				}
				break;

			// MEETINGS OPERATIONS
			case "AddMeeting":
				addToPayload(opt, ["organizerEmail", "uid", "sequence", "utcDateStamp", "title", "location", "utcDateStart", "utcDateEnd", "nonGregorian"]);
				break;
			case "CreateWorkspace":
				addToPayload(opt, ["title", "templateName", "lcid", "timeZoneInformation"]);
				break;
			case "RemoveMeeting":
				addToPayload(opt, ["recurrenceId", "uid", "sequence", "utcDateStamp", "cancelMeeting"]);
				break;
			case "SetWorkspaceTitle":
				addToPayload(opt, ["title"]);
				break;

			// PEOPLE OPERATIONS
			case "ResolvePrincipals":
				addToPayload(opt, ["principalKeys", "principalType", "addToUserInfoList"]);
				break;
			case "SearchPrincipals":
				addToPayload(opt, ["searchText", "maxResults", "principalType"]);
				break;

			// PERMISSION OPERATIONS
			case "AddPermission":
				addToPayload(opt, ["objectName", "objectType", "permissionIdentifier", "permissionType", "permissionMask"]);
				break;
			case "AddPermissionCollection":
				addToPayload(opt, ["objectName", "objectType", "permissionsInfoXml"]);
				break;
			case "GetPermissionCollection":
				addToPayload(opt, ["objectName", "objectType"]);
				break;
			case "RemovePermission":
				addToPayload(opt, ["objectName", "objectType", "permissionIdentifier", "permissionType"]);
				break;
			case "RemovePermissionCollection":
				addToPayload(opt, ["objectName", "objectType", "memberIdsXml"]);
				break;
			case "UpdatePermission":
				addToPayload(opt, ["objectName", "objectType", "permissionIdentifier", "permissionType", "permissionMask"]);
				break;

			// PUBLISHEDLINKSSERVICE OPERATIONS
			case "GetLinks":
				break;

			// SEARCH OPERATIONS
			case "GetPortalSearchInfo":
				SOAPEnvelope.opheader = "<" + opt.operation + " xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";
				SOAPAction = "http://microsoft.com/webservices/OfficeServer/QueryService/" + opt.operation;
				break;
			case "GetQuerySuggestions":
				SOAPEnvelope.opheader = "<" + opt.operation + " xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";
				SOAPAction = "http://microsoft.com/webservices/OfficeServer/QueryService/" + opt.operation;
				SOAPEnvelope.payload += wrapNode("queryXml", escapeHTML(opt.queryXml));
				break;
			case "GetSearchMetadata":
				SOAPEnvelope.opheader = "<" + opt.operation + " xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";
				SOAPAction = "http://microsoft.com/webservices/OfficeServer/QueryService/" + opt.operation;
				break;
			case "Query":
				SOAPEnvelope.payload += wrapNode("queryXml", escapeHTML(opt.queryXml));
				break;
			case "QueryEx":
				SOAPEnvelope.opheader = "<" + opt.operation + " xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";
				SOAPAction = "http://microsoft.com/webservices/OfficeServer/QueryService/" + opt.operation;
				SOAPEnvelope.payload += wrapNode("queryXml", escapeHTML(opt.queryXml));
				break;
			case "Registration":
				SOAPEnvelope.payload += wrapNode("registrationXml", escapeHTML(opt.registrationXml));
				break;
			case "Status":
				break;

			// SHAREPOINTDIAGNOSTICS OPERATIONS
			case "SendClientScriptErrorReport":
				addToPayload(opt, ["message", "file", "line", "client", "stack", "team", "originalFile"]);
				break;

			// SITEDATA OPERATIONS
			case "EnumerateFolder":
				addToPayload(opt, ["strFolderUrl"]);
				break;
			case "GetAttachments":
				addToPayload(opt, ["strListName", "strItemId"]);
				break;
			case "SiteDataGetList":
				addToPayload(opt, ["strListName"]);
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;
			case "SiteDataGetListCollection":
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;
			case "SiteDataGetSite":
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;
			case "SiteDataGetSiteUrl":
				addToPayload(opt, ["Url"]);
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;
			case "SiteDataGetWeb":
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;

			// SITES OPERATIONS
			case "CreateWeb":
				addToPayload(opt, ["urlType", "titleType", "descriptionType", "templateNameType", "languageType", "languageSpecifiedType",
					"localeType", "localeSpecifiedType", "collationLocaleType", "collationLocaleSpecifiedType", "uniquePermissionsType",
					"uniquePermissionsSpecifiedType", "anonymousType", "anonymousSpecifiedType", "presenceType", "presenceSpecifiedType"]);
				break;
			case "DeleteWeb":
				addToPayload(opt, ["url"]);
				break;
			case "GetSite":
				addToPayload(opt, ["SiteUrl"]);
				break;
			case "GetSiteTemplates":
				addToPayload(opt, ["LCID", "TemplateList"]);
				break;

			// SOCIALDATASERVICE OPERATIONS
			case "AddComment":
				addToPayload(opt, ["url", "comment", "isHighPriority", "title"]);
				break;
			case "AddTag":
				addToPayload(opt, ["url", "termID", "title", "isPrivate"]);
				break;
			case "AddTagByKeyword":
				addToPayload(opt, ["url", "keyword", "title", "isPrivate"]);
				break;
			case "CountCommentsOfUser":
				addToPayload(opt, ["userAccountName"]);
				break;
			case "CountCommentsOfUserOnUrl":
				addToPayload(opt, ["userAccountName", "url"]);
				break;
			case "CountCommentsOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "CountRatingsOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "CountTagsOfUser":
				addToPayload(opt, ["userAccountName"]);
				break;
			case "DeleteComment":
				addToPayload(opt, ["url", "lastModifiedTime"]);
				break;
			case "DeleteRating":
				addToPayload(opt, ["url"]);
				break;
			case "DeleteTag":
				addToPayload(opt, ["url", "termID"]);
				break;
			case "DeleteTagByKeyword":
				addToPayload(opt, ["url", "keyword"]);
				break;
			case "DeleteTags":
				addToPayload(opt, ["url"]);
				break;
			case "GetAllTagTerms":
				addToPayload(opt, ["maximumItemsToReturn"]);
				break;
			case "GetAllTagTermsForUrlFolder":
				addToPayload(opt, ["urlFolder", "maximumItemsToReturn"]);
				break;
			case "GetAllTagUrls":
				addToPayload(opt, ["termID"]);
				break;
			case "GetAllTagUrlsByKeyword":
				addToPayload(opt, ["keyword"]);
				break;
			case "GetCommentsOfUser":
				addToPayload(opt, ["userAccountName", "maximumItemsToReturn", "startIndex"]);
				break;
			case "GetCommentsOfUserOnUrl":
				addToPayload(opt, ["userAccountName", "url"]);
				break;
			case "GetCommentsOnUrl":
				addToPayload(opt, ["url", "maximumItemsToReturn", "startIndex"]);
				if(opt.excludeItemsTime !== undefined && opt.excludeItemsTime.length > 0) {
					SOAPEnvelope.payload += wrapNode("excludeItemsTime", opt.excludeItemsTime);
				}
				break;
			case "GetRatingAverageOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "GetRatingOfUserOnUrl":
				addToPayload(opt, ["userAccountName", "url"]);
				break;
			case "GetRatingOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "GetRatingsOfUser":
				addToPayload(opt, ["userAccountName"]);
				break;
			case "GetRatingsOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "GetSocialDataForFullReplication":
				addToPayload(opt, ["userAccountName"]);
				break;
			case "GetTags":
				addToPayload(opt, ["url"]);
				break;
			case "GetTagsOfUser":
				addToPayload(opt, ["userAccountName", "maximumItemsToReturn", "startIndex"]);
				break;
			case "GetTagTerms":
				addToPayload(opt, ["maximumItemsToReturn"]);
				break;
			case "GetTagTermsOfUser":
				addToPayload(opt, ["userAccountName", "maximumItemsToReturn"]);
				break;
			case "GetTagTermsOnUrl":
				addToPayload(opt, ["url", "maximumItemsToReturn"]);
				break;
			case "GetTagUrls":
				addToPayload(opt, ["termID"]);
				break;
			case "GetTagUrlsByKeyword":
				addToPayload(opt, ["keyword"]);
				break;
			case "GetTagUrlsOfUser":
				addToPayload(opt, ["termID", "userAccountName"]);
				break;
			case "GetTagUrlsOfUserByKeyword":
				addToPayload(opt, ["keyword", "userAccountName"]);
				break;
			case "SetRating":
				addToPayload(opt, ["url", "rating", "title", "analysisDataEntry"]);
				break;
			case "UpdateComment":
				addToPayload(opt, ["url", "lastModifiedTime", "comment", "isHighPriority"]);
				break;

			// SPELLCHECK OPERATIONS 
            case "SpellCheck":
				addToPayload(opt, ["chunksToSpell", "declaredLanguage", "useLad"]);
                break;

           // TAXONOMY OPERATIONS 
            case "AddTerms":
				addToPayload(opt, ["sharedServiceId", "termSetId", "lcid", "newTerms"]);
                break;
            case "GetChildTermsInTerm":
				addToPayload(opt, ["sspId", "lcid", "termId", "termSetId"]);
                break;
            case "GetChildTermsInTermSet":
				addToPayload(opt, ["sspId", "lcid", "termSetId"]);
                break;
            case "GetKeywordTermsByGuids":
				addToPayload(opt, ["termIds", "lcid"]);
                break;
            case "GetTermsByLabel":
				addToPayload(opt, ["label", "lcid", "matchOption", "resultCollectionSize", "termIds", "addIfNotFound"]);
                break;
            case "GetTermSets":
				addToPayload(opt, ["sharedServiceId", "termSetId", "lcid", "clientTimeStamps", "clientVersions"]);
                break;

			// USERS AND GROUPS OPERATIONS
			case "AddGroup":
				addToPayload(opt, ["groupName", "ownerIdentifier", "ownerType", "defaultUserLoginName", "description"]);
				break;
			case "AddGroupToRole":
				addToPayload(opt, ["groupName", "roleName"]);
				break;
			case "AddRole":
				addToPayload(opt, ["roleName", "description", "permissionMask"]);
				break;
			case "AddRoleDef":
				addToPayload(opt, ["roleName", "description", "permissionMask"]);
				break;
			case "AddUserCollectionToGroup":
				addToPayload(opt, ["groupName", "usersInfoXml"]);
				break;
			case "AddUserCollectionToRole":
				addToPayload(opt, ["roleName", "usersInfoXml"]);
				break;
			case "AddUserToGroup":
				addToPayload(opt, ["groupName", "userName", "userLoginName", "userEmail", "userNotes"]);
				break;
			case "AddUserToRole":
				addToPayload(opt, ["roleName", "userName", "userLoginName", "userEmail", "userNotes"]);
				break;
			case "GetAllUserCollectionFromWeb":
				break;
			case "GetGroupCollection":
				addToPayload(opt, ["groupNamesXml"]);
				break;
			case "GetGroupCollectionFromRole":
				addToPayload(opt, ["roleName"]);
				break;
			case "GetGroupCollectionFromSite":
				break;
			case "GetGroupCollectionFromUser":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "GetGroupCollectionFromWeb":
				break;
			case "GetGroupInfo":
				addToPayload(opt, ["groupName"]);
				break;
			case "GetRoleCollection":
				addToPayload(opt, ["roleNamesXml"]);
				break;
			case "GetRoleCollectionFromGroup":
				addToPayload(opt, ["groupName"]);
				break;
			case "GetRoleCollectionFromUser":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "GetRoleCollectionFromWeb":
				break;
			case "GetRoleInfo":
				addToPayload(opt, ["roleName"]);
				break;
			case "GetRolesAndPermissionsForCurrentUser":
				break;
			case "GetRolesAndPermissionsForSite":
				break;
			case "GetUserCollection":
				addToPayload(opt, ["userLoginNamesXml"]);
				break;
			case "GetUserCollectionFromGroup":
				addToPayload(opt, ["groupName"]);
				break;
			case "GetUserCollectionFromRole":
				addToPayload(opt, ["roleName"]);
				break;
			case "GetUserCollectionFromSite":
				break;
			case "GetUserCollectionFromWeb":
				break;
			case "GetUserInfo":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "GetUserLoginFromEmail":
				addToPayload(opt, ["emailXml"]);
				break;
			case "RemoveGroup":
				addToPayload(opt, ["groupName"]);
				break;
			case "RemoveGroupFromRole":
				addToPayload(opt, ["roleName", "groupName"]);
				break;
			case "RemoveRole":
				addToPayload(opt, ["roleName"]);
				break;
			case "RemoveUserCollectionFromGroup":
				addToPayload(opt, ["groupName", "userLoginNamesXml"]);
				break;
			case "RemoveUserCollectionFromRole":
				addToPayload(opt, ["roleName", "userLoginNamesXml"]);
				break;
			case "RemoveUserCollectionFromSite":
				addToPayload(opt, ["userLoginNamesXml"]);
				break;
			case "RemoveUserFromGroup":
				addToPayload(opt, ["groupName", "userLoginName"]);
				break;
			case "RemoveUserFromRole":
				addToPayload(opt, ["roleName", "userLoginName"]);
				break;
			case "RemoveUserFromSite":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "RemoveUserFromWeb":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "UpdateGroupInfo":
				addToPayload(opt, ["oldGroupName", "groupName", "ownerIdentifier", "ownerType", "description"]);
				break;
			case "UpdateRoleDefInfo":
				addToPayload(opt, ["oldRoleName", "roleName", "description", "permissionMask"]);
				break;
			case "UpdateRoleInfo":
				addToPayload(opt, ["oldRoleName", "roleName", "description", "permissionMask"]);
				break;
			case "UpdateUserInfo":
				addToPayload(opt, ["userLoginName", "userName", "userEmail", "userNotes"]);
				break;

			// USERPROFILESERVICE OPERATIONS
			case "AddColleague":
				addToPayload(opt, ["accountName", "colleagueAccountName", "group", "privacy", "isInWorkGroup"]);
				break;																			
			case "AddLink":
				addToPayload(opt, ["accountName", "name", "url", "group", "privacy"]);
				break;																						
			case "AddMembership":
				addToPayload(opt, ["accountName", "membershipInfo", "group", "privacy"]);
				break;															
			case "AddPinnedLink":
				addToPayload(opt, ["accountName", "name", "url"]);
				break;
			case "CreateMemberGroup":
				addToPayload(opt, ["membershipInfo"]);
				break;
			case "CreateUserProfileByAccountName":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetCommonColleagues":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetCommonManager":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetCommonMemberships":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetInCommon":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetPropertyChoiceList":
				addToPayload(opt, ["propertyName"]);
				break;
			case "GetUserColleagues":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetUserLinks":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetUserMemberships":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetUserPinnedLinks":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetUserProfileByGuid":
				addToPayload(opt, ["guid"]);
				break;
			case "GetUserProfileByIndex":
				addToPayload(opt, ["index"]);
				break;
			case "GetUserProfileByName":
				// Note that this operation is inconsistent with the others, using AccountName rather than accountName
				if(opt.accountName !== undefined && opt.accountName.length > 0) {
					addToPayload(opt, [["AccountName", "accountName"]]);
				} else {
					addToPayload(opt, ["AccountName"]);
				}
				break;
			case "GetUserProfileCount":
				break;
			case "GetUserProfileSchema":
				break;
			case "ModifyUserPropertyByAccountName":
				addToPayload(opt, ["accountName", "newData"]);
				break;
			case "RemoveAllColleagues":
				addToPayload(opt, ["accountName"]);
				break;
			case "RemoveAllLinks":
				addToPayload(opt, ["accountName"]);
				break;
			case "RemoveAllMemberships":
				addToPayload(opt, ["accountName"]);
				break;
			case "RemoveAllPinnedLinks":
				addToPayload(opt, ["accountName"]);
				break;	
			case "RemoveColleague":
				addToPayload(opt, ["accountName", "colleagueAccountName"]);
				break;	
			case "RemoveLink":
				addToPayload(opt, ["accountName", "id"]);
				break;
			case "RemoveMembership":
				addToPayload(opt, ["accountName", "sourceInternal", "sourceReference"]);
				break;
			case "RemovePinnedLink":
				addToPayload(opt, ["accountName", "id"]);
				break;																							
			case "UpdateColleaguePrivacy":
				addToPayload(opt, ["accountName", "colleagueAccountName", "newPrivacy"]);
				break;
			case "UpdateLink":
				addToPayload(opt, ["accountName", "data"]);
				break;			
			case "UpdateMembershipPrivacy":  
				addToPayload(opt, ["accountName", "sourceInternal", "sourceReference", "newPrivacy"]);
				break;
			case "UpdatePinnedLink ":
				addToPayload(opt, ["accountName", "data"]);
				break;

			// VERSIONS OPERATIONS
			case "DeleteAllVersions":
				addToPayload(opt, ["fileName"]);
				break;
			case "DeleteVersion":
				addToPayload(opt, ["fileName", "fileVersion"]);
				break;
			case "GetVersions":
				addToPayload(opt, ["fileName"]);
				break;
			case "RestoreVersion":
				addToPayload(opt, ["fileName", "fileVersion"]);
				break;

			// VIEW OPERATIONS
			case "AddView":
				addToPayload(opt, ["listName", "viewName", "viewFields", "query", "rowLimit", "rowLimit", "type", "makeViewDefault"]);
				break;
			case "DeleteView":
				addToPayload(opt, ["listName", "viewName"]);
				break;
			case "GetView":
				addToPayload(opt, ["listName", "viewName"]);
				break;
			case "GetViewCollection":
				addToPayload(opt, ["listName"]);
				break;
			case "GetViewHtml":
				addToPayload(opt, ["listName", "viewName"]);
				break;
			case "UpdateView":
				addToPayload(opt, ["listName", "viewName", "viewProperties", "query", "viewFields", "aggregations", "formats", "rowLimit"]);
				break;
			case "UpdateViewHtml":
				addToPayload(opt, ["listName", "viewName", "viewProperties", "toolbar", "viewHeader", "viewBody", "viewFooter", "viewEmpty", "rowLimitExceeded",
					"query", "viewFields", "aggregations", "formats", "rowLimit"]);
				break;

			// WEBPARTPAGES OPERATIONS
			case "AddWebPart":
				addToPayload(opt, ["pageUrl", "webPartXml", "storage"]);
				break;
			case "AddWebPartToZone":
				addToPayload(opt, ["pageUrl", "webPartXml", "storage", "zoneId", "zoneIndex"]);
				break;
			case "GetWebPart2":
				addToPayload(opt, ["pageUrl", "storageKey", "storage", "behavior"]);
				break;
			case "GetWebPartPage":
				addToPayload(opt, ["documentName", "behavior"]);
				break;
			case "GetWebPartProperties":
				addToPayload(opt, ["pageUrl", "storage"]);
				break;
			case "GetWebPartProperties2":
				addToPayload(opt, ["pageUrl", "storage", "behavior"]);
				break;

			// WEBS OPERATIONS
			case "Webs.CreateContentType":
				addToPayload(opt, ["displayName", "parentType", "newFields", "contentTypeProperties"]);
				break;
			case "GetColumns":
				addToPayload(opt, ["webUrl"]);
				break;
			case "GetContentType":
				addToPayload(opt, ["contentTypeId"]);
				break;
			case "GetContentTypes":
				break;
			case "GetCustomizedPageStatus":
				addToPayload(opt, ["fileUrl"]);
				break;
			case "GetListTemplates":
				break;
			case "GetObjectIdFromUrl":
				addToPayload(opt, ["objectUrl"]);
				break;
			case "GetWeb":
				addToPayload(opt, [["webUrl", "webURL"]]);
				break;
			case "GetWebCollection":
				break;
			case "GetAllSubWebCollection":
				break;
			case "UpdateColumns":
				addToPayload(opt, ["newFields", "updateFields", "deleteFields"]);
				break;				
			case "Webs.UpdateContentType":
				addToPayload(opt, ["contentTypeId", "contentTypeProperties", "newFields", "updateFields", "deleteFields"]);
				break;				
			case "WebUrlFromPageUrl":
				addToPayload(opt, [["pageUrl", "pageURL"]]);
				break;

			// WORKFLOW OPERATIONS
			case "AlterToDo":
				addToPayload(opt, ["item", "todoId", "todoListId", "taskData"]);
				break;
			case "GetTemplatesForItem":
				addToPayload(opt, ["item"]);
				break;
			case "GetToDosForItem":
				addToPayload(opt, ["item"]);
				break;
			case "GetWorkflowDataForItem":
				addToPayload(opt, ["item"]);
				break;
			case "GetWorkflowTaskData":
				addToPayload(opt, ["item", "listId", "taskId"]);
				break;
			case "StartWorkflow":
				addToPayload(opt, ["item", "templateId", "workflowParameters"]);
				break;

			default:
				break;
		}

		// Glue together the pieces of the SOAP message
		var msg = SOAPEnvelope.header +
			SOAPEnvelope.opheader +
			SOAPEnvelope.payload +
			SOAPEnvelope.opfooter +
			SOAPEnvelope.footer;

		var cachedXML;
		var status = null;

		if(opt.cacheXML) {
			cachedXML = $("body").data(msg);
		}
		
		if(cachedXML === undefined) {
			// Make the Ajax call
			$.ajax({
				url: ajaxURL,											// The relative URL for the AJAX call
				async: opt.async,										// By default, the AJAX calls are asynchronous.  You can specify false to require a synchronous call.
				beforeSend: function (xhr) {							// Before sending the msg, need to send the request header
					// If we need to pass the SOAPAction, do so
					if(WSops[opt.operation][1]) {
						xhr.setRequestHeader("SOAPAction", SOAPAction);
					}
				},
				type: "POST",											// This is a POST
				data: msg,												// Here is the SOAP request we've built above
				dataType: "xml",										// We're getting XML; tell jQuery so that it doesn't need to do a best guess
				contentType: "text/xml;charset='utf-8'",				// and this is its content type
				complete: function(xData, Status) {
					if(opt.cacheXML) {
						$("body").data(msg, xData);				// Cache the results
					}
					cachedXML = xData;
					status = Status;
					opt.completefunc(cachedXML, status);				// When the call is complete, do this
				}
			});

		} else {
			opt.completefunc(cachedXML, status);						// Call the completefunc
		}

	}; // End $.fn.SPServices

	// Defaults added as a function in our library means that the caller can override the defaults
	// for their session by calling this function.  Each operation requires a different set of options;
	// we allow for all in a standardized way.
	$.fn.SPServices.defaults = {

		cacheXML: false,				// If true, we'll cache the XML results with jQuery's .data() function
		operation: "",				// The Web Service operation
		webURL: "",					// URL of the target Web
		makeViewDefault: false,		// true to make the view the default view for the list

		// For operations requiring CAML, these options will override any abstractions
		CAMLViewName: "",			// View name in CAML format.
		CAMLQuery: "",				// Query in CAML format
		CAMLViewFields: "",			// View fields in CAML format
		CAMLRowLimit: 0,			// Row limit as a string representation of an integer
		CAMLQueryOptions: "<QueryOptions></QueryOptions>",		// Query options in CAML format

		// Abstractions for CAML syntax
		batchCmd: "Update",			// Method Cmd for UpdateListItems
		valuepairs: [],				// Fieldname / Fieldvalue pairs for UpdateListItems

		// As of v0.7.1, removed all options which were assigned an empty string ("")
		DestinationUrls: [],		// Array of destination URLs for copy operations
		behavior: "Version3",		// An SPWebServiceBehavior indicating whether the client supports Windows SharePoint Services 2.0 or Windows SharePoint Services 3.0: {Version2 | Version3 }
		storage: "Shared",			// A Storage value indicating how the Web Part is stored: {None | Personal | Shared}
		objectType: "List",			// objectType for operations which require it
		cancelMeeting: true,		// true to delete a meeting;false to remove its association with a Meeting Workspace site
		nonGregorian: false,		// true if the calendar is set to a format other than Gregorian;otherwise, false.
		fClaim: false,				// Specifies if the action is a claim or a release. Specifies true for a claim and false for a release.
		recurrenceId: 0,			// The recurrence ID for the meeting that needs its association removed. This parameter can be set to 0 for single-instance meetings.
		sequence: 0,				// An integer that is used to determine the ordering of updates in case they arrive out of sequence. Updates with a lower-than-current sequence are discarded. If the sequence is equal to the current sequence, the latest update are applied.
		maximumItemsToReturn: 0,	// SocialDataService maximumItemsToReturn
		startIndex: 0,				// SocialDataService startIndex
		isHighPriority: false,		// SocialDataService isHighPriority
		isPrivate: false,			// SocialDataService isPrivate
		rating: 1,					// SocialDataService rating
		maxResults: 10,				// Unless otherwise specified, the maximum number of principals that can be returned from a provider is 10.
		principalType: "User",		// Specifies user scope and other information: [None | User | DistributionList | SecurityGroup | SharePointGroup | All]

		async: true,				// Allow the user to force async
		completefunc: null			// Function to call on completion

	}; // End $.fn.SPServices.defaults

	// Function to determine the current Web's URL.  We need this for successful Ajax calls.
	// The function is also available as a public function.
	$.fn.SPServices.SPGetCurrentSite = function() {

		// Do we already know the current site?
		if(thisSite.length > 0) {
			return thisSite;
		}

		// SharePoint 2010 provides the current context, so if available, let's use it
//		thisSite = (typeof SP !== "undefined") ? SP.ClientContext.get_current().get_url() : undefined;
//		if(thisSite !== undefined) return thisSite = location.protocol + "//" + location.hostname + thisSite;
		
		var msg = SOAPEnvelope.header +
				"<WebUrlFromPageUrl xmlns='" + SCHEMASharePoint + "/soap/' ><pageUrl>" +
				((location.href.indexOf("?") > 0) ? location.href.substr(0, location.href.indexOf("?")) : location.href) +
				"</pageUrl></WebUrlFromPageUrl>" +
				SOAPEnvelope.footer;
		$.ajax({
			async: false, // Need this to be synchronous so we're assured of a valid value
			url: "/_vti_bin/Webs.asmx",
			type: "POST",
			data: msg,
			dataType: "xml",
			contentType: "text/xml;charset=\"utf-8\"",
			complete: function (xData, Status) {
				thisSite = $(xData.responseXML).find("WebUrlFromPageUrlResult").text();
			}
		});
		return thisSite; // Return the URL
	}; // End $.fn.SPServices.SPGetCurrentSite

	// Function to set up cascading dropdowns on a SharePoint form
	// (Newform.aspx, EditForm.aspx, or any other customized form.)
	$.fn.SPServices.SPCascadeDropdowns = function(options) {

		var opt = $.extend({}, {
			relationshipWebURL: "",				// [Optional] The name of the Web (site) which contains the relationships list
			relationshipList: "",				// The name of the list which contains the parent/child relationships
			relationshipListParentColumn: "",	// The internal name of the parent column in the relationship list
			relationshipListChildColumn: "",	// The internal name of the child column in the relationship list
			relationshipListSortColumn: "",		// [Optional] If specified, sort the options in the dropdown by this column,
												// otherwise the options are sorted by relationshipListChildColumn
			parentColumn: "",					// The display name of the parent column in the form
			childColumn: "",					// The display name of the child column in the form
			listName: $().SPServices.SPListNameFromUrl(),		// The list the form is working with. This is useful if the form is not in the list context.
			CAMLQuery: "",						// [Optional] For power users, this CAML fragment will be Anded with the default query on the relationshipList
			promptText: "",						// [DEPRECATED] Text to use as prompt. If included, {0} will be replaced with the value of childColumn. IOrignal value "Choose {0}..."
			noneText: "(None)",					// [Optional] Text to use for the (None) selection. Provided for non-English language support.
			simpleChild: false,					// [Optional] If set to true and childColumn is a complex dropdown, convert it to a simple dropdown
			selectSingleOption: false,			// [Optional] If set to true and there is only a single child option, select it
			matchOnId: false,					// By default, we match on the lookup's text value. If matchOnId is true, we'll match on the lookup id instead.
			completefunc: null,					// Function to call on completion of rendering the change.
			debug: false						// If true, show error messages;if false, run silent
		}, options);


		var thisParentSetUp = false;
		var thisFunction = "SPServices.SPCascadeDropdowns";

		// Find the parent column's select (dropdown)
		var parentSelect = new DropdownCtl(opt.parentColumn);
		if(parentSelect.Obj.html() === null && opt.debug) {errBox(thisFunction, "parentColumn: " + opt.parentColumn , TXTColumnNotFound);return;}

		// Find the child column's select (dropdown)
		var childSelect = new DropdownCtl(opt.childColumn);
		if(childSelect.Obj.html() === null && opt.debug) {errBox(thisFunction, "childColumn: " + opt.childColumn, TXTColumnNotFound);return;}

		// If requested and the childColumn is a complex dropdown, convert to a simple dropdown
		if(opt.simpleChild === true && childSelect.Type === "C") {
			$().SPServices.SPComplexToSimpleDropdown({
				columnName: opt.childColumn
			});
			// Set the childSelect to reference the new simple dropdown
			childSelect = new DropdownCtl(opt.childColumn);
		}

		// Get information about the childColumn from the current list
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			listName: opt.listName,
			completefunc: function(xData, Status) {
				$(xData.responseXML).find("Fields").each(function() {
					$(this).find("Field[DisplayName='" + opt.childColumn + "']").each(function() {
						// Determine whether childColumn is Required
						childColumnRequired = ($(this).attr("Required") === "TRUE") ? true : false;
						childColumnStatic = $(this).attr("StaticName");
						// Stop looking; we're done
						return false;
					});
				});
			}
		});

		// Save data about each child column on the parent
		var childColumn = {opt: opt, childSelect: childSelect, childColumnStatic: childColumnStatic, childColumnRequired: childColumnRequired};
		var childColumns = parentSelect.Obj.data("SPCascadeDropdownsChildColumns");

		// If this is the first child for this parent, then create the data object to hold the settings
		if(childColumns === undefined) {
			parentSelect.Obj.data("SPCascadeDropdownsChildColumns", [childColumn]);
		// If we already have a data object for this parent, then add the setting for this child to it
		} else {
			childColumns.push(childColumn);
			parentSelect.Obj.data("SPCascadeDropdownsChildColumns", childColumns);
			thisParentSetUp = true;
		}

		// We only need to bind to the event(s) if we haven't already done so
		if(!thisParentSetUp) {
			switch(parentSelect.Type) {
				// Plain old select
				case "S":
					parentSelect.Obj.bind("change", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
					});
					break;
				// Input / Select hybrid
				case "C":
					// Bind to any change on the hidden input element
					$("input[id='"+ parentSelect.Obj.attr("optHid") + "']").bind("propertychange", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
					});
					break;
				// Multi-select hybrid
				case "M":
					// Handle the dblclick on the candidate select
					parentSelect.Obj.bind("dblclick", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
					});
					// Handle the dblclick on the selected values
					parentSelections = parentSelect.Obj.closest("span").find("select[id$='SelectResult']");
					parentSelections.bind("dblclick", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
					});
					// Handle a button click
					parentSelect.Obj.closest("span").find("button").each(function() {
						$(this).bind("click", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
						});
					});
					break;
				default:
					break;
			}
		}
		// Fire the change to set the initially allowable values
		cascadeDropdown(opt.parentColumn, parentSelect);

	}; // End $.fn.SPServices.SPCascadeDropdowns

	function cascadeDropdown(parentColumn, parentSelect) {
		var choices = "";
		var parentSelectSelected;
		var childSelectSelected = null;
		var master;
		var MultiLookupPickerdata;
		var newMultiLookupPickerdata;
		var numChildOptions;
		var firstChildOptionId;
		var firstChildOptionValue;

		// Filter each child column
		var childColumns = parentSelect.Obj.data("SPCascadeDropdownsChildColumns");
		$(childColumns).each(function() {

			// Break out the data objects for this child column
			var opt = this.opt;
			var childSelect = this.childSelect;
			var childColumnStatic = this.childColumnStatic;
			var childColumnRequired = this.childColumnRequired;

			// Get the parent column selection(s)
			parentSelectSelected = getDropdownSelected(parentSelect, opt.matchOnId);

			// If the selection hasn't changed, then there's nothing to do right now.  This is useful to reduce
			// the number of Web Service calls when the parentSelect.Type = "C" or "M", as there are multiple propertychanges
			// which don't require any action.  The attribute will be unique per child column in case there are
			// multiple children for a given parent.
			var allParentSelections = parentSelectSelected.join(";#");
			if(parentSelect.Obj.data("SPCascadeDropdown_Selected_" + childColumnStatic) === allParentSelections) {
				return;
			}
			parentSelect.Obj.data("SPCascadeDropdown_Selected_" + childColumnStatic, allParentSelections);

			// Get the current child column selection(s)
			childSelectSelected = getDropdownSelected(childSelect, true);

			// Find the important bits of the multi-select
			if(childSelect.Type === "M") {
				MultiLookupPickerdata = childSelect.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");
				master = window[childSelect.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,'MultiLookupPicker_m')];
				currentSelection = childSelect.Obj.closest("span").find("select[ID$='SelectResult']");
			}

			// When the parent column's selected option changes, get the matching items from the relationship list
			// Get the list items which match the current selection
			var sortColumn = (opt.relationshipListSortColumn.length > 0) ? opt.relationshipListSortColumn : opt.relationshipListChildColumn;
			var camlQuery = "<Query><OrderBy><FieldRef Name='" + sortColumn + "'/></OrderBy><Where><And>";
			if(opt.CAMLQuery.length > 0) {
				camlQuery += "<And>";
			}

			// Build up the criteria for inclusion
			if(parentSelectSelected.length === 0) {
				// Handle the case where no values are selected in multi-selects
				camlQuery += "<Eq><FieldRef Name='" + opt.relationshipListParentColumn + "'/><Value Type='Text'></Value></Eq>";
			} else if(parentSelectSelected.length === 1) {
				// Only one value is selected
				camlQuery += "<Eq><FieldRef Name='" + opt.relationshipListParentColumn +
					(opt.matchOnId ? "' LookupId='True'/><Value Type='Integer'>" : "'/><Value Type='Text'>") +
					escapeColumnValue(parentSelectSelected[0]) + "</Value></Eq>";
			} else {
				var compound = (parentSelectSelected.length > 2) ? true : false;
				for(i=0; i < (parentSelectSelected.length - 1); i++) {
					camlQuery += "<Or>";
				}
				for(i=0; i < parentSelectSelected.length; i++) {
					camlQuery += "<Eq><FieldRef Name='" + opt.relationshipListParentColumn +
						(opt.matchOnId ? "' LookupId='True'/><Value Type='Integer'>" : "'/><Value Type='Text'>") +
						escapeColumnValue(parentSelectSelected[i]) + "</Value></Eq>";
					if(i>0 && (i < (parentSelectSelected.length - 1)) && compound) {
						camlQuery += "</Or>";
					}
				}
				camlQuery += "</Or>";
			}

			if(opt.CAMLQuery.length > 0) {
				camlQuery += opt.CAMLQuery + "</And>";
			}

			// Make sure we don't get any items which don't have the child value
			camlQuery += "<IsNotNull><FieldRef Name='" + opt.relationshipListChildColumn + "' /></IsNotNull>";

			camlQuery += "</And></Where></Query>";
		
			$().SPServices({
				operation: "GetListItems",
				// Force sync so that we have the right values for the child column onchange trigger
				async: false,
				webURL: opt.relationshipWebURL,
				listName: opt.relationshipList,
				// Filter based on the currently selected parent column's value
				CAMLQuery: camlQuery,
				// Only get the parent and child columns
				CAMLViewFields: "<ViewFields><FieldRef Name='" + opt.relationshipListParentColumn + "' /><FieldRef Name='" + opt.relationshipListChildColumn + "' /></ViewFields>",
				// Override the default view rowlimit and get all appropriate rows
				CAMLRowLimit: 0,
				// Even though setting IncludeMandatoryColumns to FALSE doesn't work as the docs describe, it fixes a bug in GetListItems with mandatory multi-selects
				CAMLQueryOptions: "<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",
				completefunc: function(xData, Status) {

					// Handle errors
					$(xData.responseXML).find("errorstring").each(function() {
						var thisFunction = "SPServices.SPCascadeDropdowns";
						var errorText = $(this).text();
						if(opt.debug && errorText === "One or more field types are not installed properly. Go to the list settings page to delete these fields.") {
							errBox(thisFunction,
								"relationshipListParentColumn: " + opt.relationshipListParentColumn + " or " +
								"relationshipListChildColumn: " + opt.relationshipListChildColumn,
								"Not found in relationshipList " + opt.relationshipList);
						} else if (opt.debug && errorText === "Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).") {
							errBox(thisFunction,
								"relationshipList: " + opt.relationshipList,
								"List not found");
						}
						return;
					});

					// Add an explanatory prompt
					switch(childSelect.Type) {
						case "S":
							// Remove all of the existing options
							$(childSelect.Obj).find("option").remove();
							// If the column is required or the promptText option is empty, don't add the prompt text
							if(!childColumnRequired && (opt.promptText.length > 0)) {
								childSelect.Obj.append("<option value='0'>" + opt.promptText.replace(/\{0\}/g, opt.childColumn) + "</option>");
							} else if(!childColumnRequired){
								childSelect.Obj.append("<option value='0'>" + opt.noneText + "</option>");
							}
							break;
						case "C":
							// If the column is required, don't add the "(None)" option
							choices = childColumnRequired ? "" : opt.noneText + "|0";
							childSelect.Obj.attr("value", "");
							break;
						case "M":
							// Remove all of the existing options
							$(childSelect.Obj).find("option").remove();
							newMultiLookupPickerdata = "";
							break;
						default:
							break;
					}
					// Get the count of items returned and save it so that we can select if it's a single option 
					// The item count is stored thus: <rs:data ItemCount="1">
					numChildOptions = parseFloat($(xData.responseXML).SPFilterNode("rs:data").attr("ItemCount"));

					// Add an option for each child item
					$(xData.responseXML).SPFilterNode("z:row").each(function() {

						var thisOptionId, thisOptionValue;

						// If relationshipListChildColumn is a Lookup column, then the ID should be for the Lookup value,
						// else the ID of the relationshipList item
						var thisValue = $(this).attr("ows_" + opt.relationshipListChildColumn);
						
						if(thisValue !== undefined && thisValue.indexOf(";#") > 0) {
							var splitValue = thisValue.split(";#");
							thisOptionId = splitValue[0];
							thisOptionValue = splitValue[1];
						} else {
							thisOptionId = $(this).attr("ows_ID");
							thisOptionValue = thisValue;						
						}

						// If the relationshipListChildColumn is a calculated column, then the value isn't preceded by the ID,
						// but by the datatype.  In this case, thisOptionId should be the ID of the relationshipList item.
						// e.g., float;#12345.67
						if(isNaN(thisOptionId)) {
							thisOptionId = $(this).attr("ows_ID");
						}
					
						// Save the id and value for the first child option in case we need to select it (selectSingleOption option is true)
						firstChildOptionId = thisOptionId;
						firstChildOptionValue = thisOptionValue;
					
						switch(childSelect.Type) {
							case "S":
								var selected = ($(this).attr("ows_ID") === childSelectSelected[0]) ? " selected='selected'" : "";
								childSelect.Obj.append("<option" + selected + " value='" + thisOptionId + "'>" + thisOptionValue + "</option>");
								break;
							case "C":
								if(thisOptionId === childSelectSelected[0]) {
									childSelect.Obj.attr("value", thisOptionValue);
								}
								choices = choices + ((choices.length > 0) ? "|" : "") + thisOptionValue + "|" + thisOptionId;
								break;
							case "M":
								childSelect.Obj.append("<option value='" + thisOptionId + "'>" + thisOptionValue + "</option>");
								newMultiLookupPickerdata += thisOptionId + "|t" + thisOptionValue + "|t |t |t";
								break;
							default:
								break;
						}
					});

					switch(childSelect.Type) {
						case "S":
							childSelect.Obj.trigger("change");
							// If there is only one option and the selectSingleOption option is true, then select it
							if(numChildOptions === 1 && opt.selectSingleOption === true) {
								$(childSelect.Obj).find("option[value!='0']:first").attr("selected", "selected");
							}
							break;
						case "C":
							// Set the allowable choices
							childSelect.Obj.attr("choices", choices);
							// If there is only one option and the selectSingleOption option is true, then select it
							if(numChildOptions === 1 && opt.selectSingleOption === true) {
								// Set the input element value
								$(childSelect.Obj).attr("value", firstChildOptionValue);
								// Set the value of the optHid input element
								$("input[id='" + childSelect.Obj.attr("optHid") + "']").val(firstChildOptionId);
							}
							// If there's no selection, then remove the value in the associated hidden input element (optHid)
							if(childSelect.Obj.val() === "") {
								$("input[id='" + childSelect.Obj.attr("optHid") + "']").val("");
							}
							break;
						case "M":
							// Clear the master
							master.data = "";
							MultiLookupPickerdata.attr("value", newMultiLookupPickerdata);

							// Clear any prior selections that are no longer valid or aren't selected
							$(currentSelection).find("option").each(function() {
								var thisSelected = $(this);
								var thisValue = $(this).html();
								$(this).attr("selected", "selected");
								$(childSelect.Obj).find("option").filter(function() {
									return $(this).text() == thisValue.replace(/&amp;/, "&");	
								}).each(function() {
									if($(this).html() === thisValue) {
										thisSelected.removeAttr("selected");
									}
								});
							});
							GipRemoveSelectedItems(master);

							// Hide any options in the candidate list which are already selected
							$(childSelect.Obj).find("option").each(function() {
								var thisSelected = $(this);
								$(currentSelection).find("option").each(function() {
									if($(this).html() === thisSelected.html()) {
										thisSelected.remove();
									}
								});
							});
							GipAddSelectedItems(master);

							// Set master.data to the newly allowable values
							master.data = GipGetGroupData(newMultiLookupPickerdata);

							// Trigger a dblclick so that the child will be cascaded if it is a multiselect.
							childSelect.Obj.trigger("dblclick");

							break;
						default:
							break;
					}
				}
			});
			// If present, call completefunc when all else is done
			if(opt.completefunc !== null) {
				opt.completefunc();
			}
		}); // $(childColumns).each(function()

	} // End cascadeDropdown


	// function to convert complex dropdowns to simple dropdowns
	$.fn.SPServices.SPComplexToSimpleDropdown = function(options) {

		var opt = $.extend({}, {
			columnName: "",						// The display name of the column in the form
			completefunc: null,					// Function to call on completion of rendering the change.
			debug: false						// If true, show error messages;if false, run silent
		}, options);

		// Find the column's select (dropdown)
		var columnSelect = new DropdownCtl(opt.columnName);
		if(columnSelect.Obj.html() === null && opt.debug) {errBox("SPServices.SPComplexToSimpleDropdown", "columnName: " + opt.columnName, TXTColumnNotFound); return;	}

		// If we don't have a complex dropdown, then there is nothing to do
		if(columnSelect.Type !== "C") { return; }
		
		// The available options are stored in the choices attribute of the complex dropdowns's input element...
		var choices = $(columnSelect.Obj).attr("choices").split("|");
		// The optHid attribute contains the id of a hidden input element which stores the selected value for the commit
		var columnOptHid = $(columnSelect.Obj).attr("optHid");
		var columnOptHidInput = $("input[id='" + columnOptHid + "']");
		// We need to know which option is selected already, if any
		var complexSelectSelectedId = $("input[id='" + columnOptHid + "']").val();

		// Build up the simple dropdown, giving it an easy to select id
		var simpleSelectId = genContainerId("SPComplexToSimpleDropdown", opt.columnName);

		var simpleSelect = "<select id='" + simpleSelectId + "' title='" + opt.columnName + "'>";		
		for(i=0; i < choices.length; i=i+2) {
			var simpleSelectSelected = (choices[i+1] === complexSelectSelectedId) ? " selected='selected' " : " ";
			simpleSelect += "<option" + simpleSelectSelected + "value='" + choices[i+1] + "'>" + choices[i] + "</option>";
		}
		simpleSelect += "</select>";
		
		// Append the new simple select to the form
		$(columnSelect.Obj).closest("td").prepend(simpleSelect);

		// Remove the complex dropdown functionality since we don't need it anymore...
		$(columnSelect.Obj).closest("span").find("img").remove();
		// ...and hide the input element
		$(columnSelect.Obj).closest("span").find("input").hide();

		// When the simple select changes...
		$("#" + simpleSelectId).change(function() {
			var thisVal = $(this).val();
			// ...set the optHid input element's value to the valus of the selected option...
			columnOptHidInput.val(thisVal);
			// ...and save the selected value as the hidden input's value only if the value is not equal to "0" (None)
			$(columnSelect.Obj).val($(this).find("option[value='" + (thisVal !== "0" ? thisVal : "") + "']").html());
		});
		// Trigger a change to ensure that the selected value registers in the complex dropdown
		$("#" + simpleSelectId).trigger("change");

		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}

	}; // End $.fn.SPServices.SPConvertToSimpleDropdown


	// Function to display related information when an option is selected on a form.
	$.fn.SPServices.SPDisplayRelatedInfo = function(options) {

		var opt = $.extend({}, {
			columnName: "",						// The display name of the column in the form
			relatedWebURL: "",					// [Optional] The name of the Web (site) which contains the related list
			relatedList: "",					// The name of the list which contains the additional information
			relatedListColumn: "",				// The internal name of the related column in the related list
			relatedColumns: [],					// An array of related columns to display
			displayFormat: "table",				// The format to use in displaying the related information.  Possible values are: [table, list]
			headerCSSClass: "ms-vh2",			// CSS class for the table headers
			rowCSSClass: "ms-vb",				// CSS class for the table rows
			CAMLQuery: "",						// [Optional] For power users, this CAML fragment will be <And>ed with the default query on the relatedList
			numChars: 0,						// If used on an input column (not a dropdown), no matching will occur until at least this number of characters has been entered
			matchType: "Eq",					// If used on an input column (not a dropdown), type of match. Can be any valid CAML comparison operator, most often "Eq" or "BeginsWith"
			matchOnId: false,					// By default, we match on the lookup's text value. If matchOnId is true, we'll match on the lookup id instead.
			completefunc: null,					// Function to call on completion of rendering the change.
			debug: false						// If true, show error messages;if false, run silent
		}, options);

		var divId;
		var relatedColumnsXML = [];
		var relatedListXML;
		var thisFunction = "SPServices.SPDisplayRelatedInfo";

		// Find the column's select (dropdown)
		var columnSelect = new DropdownCtl(opt.columnName);
		if(columnSelect.Obj.html() === null && opt.debug) {errBox(thisFunction, "columnName: " + opt.columnName, TXTColumnNotFound); return; }

		// Generate a unique id for the container
		divId = genContainerId("SPDisplayRelatedInfo", opt.columnName);

		// Get information about the related list and its columns
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			webURL: opt.relatedWebURL,
			listName: opt.relatedList,
			completefunc: function(xData, Status) {
				// If debug is on, notify about an error
				$(xData.responseXML).find("faultcode").each(function() {
					if(opt.debug) {errBox(thisFunction, "relatedList: " + opt.relatedList, "List not found"); return; }
				});
				// Get info about the related list
				relatedListXML = $(xData.responseXML).find("List");
				// Save the information about each column requested
				for (i=0; i < opt.relatedColumns.length; i++) {
					relatedColumnsXML[i] = $(xData.responseXML).find("Fields > Field[Name='" + opt.relatedColumns[i] + "']");
				}
			}
		});

		switch(columnSelect.Type) {
			// Plain old select
			case "S":
				columnSelect.Obj.bind("change", function() {
					showRelated(opt, divId, relatedListXML, relatedColumnsXML);
				});
				break;
			// Input / Select hybrid
			case "C":
				// Bind to any change on the hidden input element
                $("input[id='" + columnSelect.Obj.attr("optHid") + "']").bind("propertychange", function() {
					showRelated(opt, divId, relatedListXML, relatedColumnsXML);
				});
				break;
			// Multi-select hybrid
			case "M":
				if(opt.debug) {errBox(thisFunction, "columnName: " + opt.columnName, "Multi-select columns not supported by this function"); }
				break;
			default:
				break;
		}
		// Fire the change to set the initially allowable values
		showRelated(opt, divId, relatedListXML, relatedColumnsXML);

	}; // End $.fn.SPServices.SPDisplayRelatedInfo

	function showRelated(opt, divId, relatedListXML, relatedColumnsXML) {

		var columnSelectSelected = null;
		var thisFunction = "SPServices.SPDisplayRelatedInfo";

		// Find the column's select (dropdown)
		var columnSelect = new DropdownCtl(opt.columnName);

		// Get the current column selection(s)
		columnSelectSelected = getDropdownSelected(columnSelect, opt.matchOnId);
		if(columnSelect.Type === "C" && opt.numChars > 0 && columnSelectSelected[0].length < opt.numChars) {
			return;
		}

		// If the selection hasn't changed, then there's nothing to do right now.  This is useful to reduce
		// the number of Web Service calls when the parentSelect.Type = "C", as there are multiple propertychanges
		// which don't require any action.
		if(columnSelect.Obj.attr("showRelatedSelected") === columnSelectSelected[0]) {
			return;
		}
		columnSelect.Obj.attr("showRelatedSelected", columnSelectSelected[0]);

		// Remove the old container...
		$("#" + divId).remove();
		// ...and append a new, empty one
		columnSelect.Obj.parent().append("<div id=" + divId + "></div>");

		// Get the list items which match the current selection
		var camlQuery = "<Query><Where>";
		if(opt.CAMLQuery.length > 0) {
			camlQuery += "<And>";
		}

		camlQuery += "<Eq><FieldRef Name='" + opt.relatedListColumn +
			(opt.matchOnId ? "' LookupId='True'/><Value Type='Integer'>" : "'/><Value Type='Text'>") +
			escapeColumnValue(columnSelectSelected[0]) + "</Value></Eq>";

		if(opt.CAMLQuery.length > 0) {
			camlQuery += opt.CAMLQuery + "</And>";
		}
		camlQuery += "</Where></Query>";

		var viewFields = " ";
		for (i=0; i < opt.relatedColumns.length; i++) {
			viewFields += "<FieldRef Name='" + opt.relatedColumns[i] + "' />";
		}

		$().SPServices({
			operation: "GetListItems",
			async: false,
			webURL: opt.relatedWebURL,
			listName: opt.relatedList,
			// Filter based on the column's currently selected value
			CAMLQuery: camlQuery,
			CAMLViewFields: "<ViewFields>" + viewFields +  "</ViewFields>",
			// Override the default view rowlimit and get all appropriate rows
			CAMLRowLimit: 0,
			completefunc: function(xData, Status) {

				// Handle errors
				$(xData.responseXML).find("errorstring").each(function() {
					var errorText = $(this).text();
					if(opt.debug && errorText === "One or more field types are not installed properly. Go to the list settings page to delete these fields.") {
						errBox(thisFunction,
							"relatedListColumn: " + opt.relatedListColumn,
							"Column not found in relatedList " + opt.relatedList);
					} else if (opt.debug && errorText === "Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).") {
						errBox(thisFunction,
							"relatedList: " + opt.relatedList,
							"List not found");
					}
					return;
				});

				var outString;
				// Output each row
				switch(opt.displayFormat) {
					// Only implementing the table format in the first iteration (v0.2.9)
					case "table":
						outString = "<table>";
						outString += "<tr>";
						for (i=0; i < opt.relatedColumns.length; i++) {
							if(typeof relatedColumnsXML[i] === 'undefined' && opt.debug) {errBox(thisFunction, "columnName: " + opt.relatedColumns[i], "Column not found in relatedList"); return; }
							outString += "<th class='" + opt.headerCSSClass + "'>" + relatedColumnsXML[i].attr("DisplayName") + "</th>";
						}
						outString += "</tr>";
						// Add an option for each child item
						$(xData.responseXML).SPFilterNode("z:row").each(function() {
							outString += "<tr>";
							for (i=0; i < opt.relatedColumns.length; i++) {
								outString += "<td class='" + opt.rowCSSClass + "'>" + showColumn(relatedListXML, relatedColumnsXML[i], $(this).attr("ows_" + opt.relatedColumns[i]), opt) + "</td>";
							}
							outString += "</tr>";
						});
						outString += "</table>";
						break;
					// list format implemented in v0.5.0. Still table-based, but vertical orientation.
					case "list":
						outString = "<table>";
						$(xData.responseXML).SPFilterNode("z:row").each(function() {
							for (i=0; i < opt.relatedColumns.length; i++) {
								if(typeof relatedColumnsXML[i] === 'undefined' && opt.debug) {errBox(thisFunction, "columnName: " + opt.relatedColumns[i], "Column not found in relatedList"); return; }
								outString += "<tr>";
								outString += "<th class='" + opt.headerCSSClass + "'>" + relatedColumnsXML[i].attr("DisplayName") + "</th>";
								outString += "<td class='" + opt.rowCSSClass + "'>" + showColumn(relatedListXML, relatedColumnsXML[i], $(this).attr("ows_" + opt.relatedColumns[i]), opt) + "</td>";
								outString += "</tr>";
							}
						});
						outString += "</table>";
						break;
					default:
						break;
				}
				// Write out the results
				$("#" + divId).html(outString);
			}
		});
		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}
	} // End showRelated

	// Function to filter a lookup based dropdown 
	$.fn.SPServices.SPFilterDropdown = function(options) {
		var opt = $.extend({}, {
			relationshipWebURL: "",				// [Optional] The name of the Web (site) which contains the relationshipList
			relationshipList: "",				// The name of the list which contains the lookup values
			relationshipListColumn: "",			// The internal name of the column in the relationship list
			relationshipListSortColumn: "",		// [Optional] If specified, sort the options in the dropdown by this column,
												// otherwise the options are sorted by relationshipListColumn
			columnName: "",						// The display name of the column in the form
			listName: $().SPServices.SPListNameFromUrl(),		// The list the form is working with. This is useful if the form is not in the list context.
			promptText: "",						// [DEPRECATED] Text to use as prompt. If included, {0} will be replaced with the value of columnName. IOrignal value "Choose {0}..."
			noneText: "(None)",					// [Optional] Text to use for the (None) selection. Provided for non-English language support.
			CAMLQuery: "",						// This CAML fragment will be applied to the relationshipList
			CAMLQueryOptions: "<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>", // Need this to mirror SharePoint's behavior, but it can be overridden
			completefunc: null,					// Function to call on completion of rendering the change.
			debug: false						// If true, show error messages; if false, run silent
		}, options);
	
		var choices = "";
		var columnSelectSelected = null;
		var master;
		var MultiLookupPickerdata;
		var newMultiLookupPickerdata;
		var columnColumnRequired;
		var thisFunction = "SPServices.SPFilterDropdown";
	
		// Find the column's select (dropdown)
		var columnSelect = new DropdownCtl(opt.columnName);
		if(columnSelect.Obj.html() === null && opt.debug) {errBox(thisFunction, "columnName: " + opt.columnName, TXTColumnNotFound); return;}
	
		// Get the current column selection(s)
		columnSelectSelected = getDropdownSelected(columnSelect, true);

		// Get the relationshipList items which match the current selection
		var sortColumn = (opt.relationshipListSortColumn.length > 0) ? opt.relationshipListSortColumn : opt.relationshipListColumn;
		var camlQuery = "<Query><OrderBy><FieldRef Name='" + sortColumn + "'/></OrderBy><Where>";
		if(opt.CAMLQuery.length > 0) {
			camlQuery += opt.CAMLQuery;
		}
		camlQuery += "</Where></Query>";
	
		// Get information about columnName from the current list
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			listName: opt.listName,
			completefunc: function(xData, Status) {
				$(xData.responseXML).find("Fields").each(function() {
					$(this).find("Field[DisplayName='" + opt.columnName + "']").each(function() {
						// Determine whether columnName is Required
						columnColumnRequired = ($(this).attr("Required") === "TRUE") ? true : false;
						// Stop looking; we're done
						return false;
					});
				});
			}
		});
		
		$().SPServices({
			operation: "GetListItems",
			// Force sync so that we have the right values for the column onchange trigger
			async: false,
			webURL: opt.relationshipWebURL,
			listName: opt.relationshipList,
			// Filter based on the specified CAML
			CAMLQuery: camlQuery,
			// Only get the columnName's data (plus columns we can't prevent)
			CAMLViewFields: "<ViewFields><FieldRef Name='" + opt.relationshipListColumn + "' /></ViewFields>",
			// Override the default view rowlimit and get all appropriate rows
			CAMLRowLimit: 0,
			// Even though setting IncludeMandatoryColumns to FALSE doesn't work as the docs describe, it fixes a bug in GetListItems with mandatory multi-selects
			CAMLQueryOptions: opt.CAMLQueryOptions,
			completefunc: function(xData, Status) {

				// Handle errors
				$(xData.responseXML).find("errorstring").each(function() {
					var errorText = $(this).text();
					if(opt.debug && errorText === "One or more field types are not installed properly. Go to the list settings page to delete these fields.") {
						errBox(thisFunction,
							"relationshipListColumn: " + opt.relationshipListColumn,
							"Not found in relationshipList " + opt.relationshipList);
					} else if (opt.debug && errorText === "Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).") {
						errBox(thisFunction,
							"relationshipList: " + opt.relationshipList,
							"List not found");
					}
					return;
				});

				// Add an explanatory prompt
				switch(columnSelect.Type) {
					case "S":
						// Remove all of the existing options
						$(columnSelect.Obj).find("option").remove();
						// If the column is required or the promptText option is empty, don't add the prompt text
						if(!columnColumnRequired && (opt.promptText.length > 0)) {
							columnSelect.Obj.append("<option value='0'>" + opt.promptText.replace(/\{0\}/g, opt.columnName) + "</option>");
						} else if(!columnColumnRequired){
							columnSelect.Obj.append("<option value='0'>" + opt.noneText + "</option>");
						}
						break;
					case "C":
						// If the column is required, don't add the "(None)" option
						choices = columnColumnRequired ? "" : opt.noneText + "|0";
						columnSelect.Obj.attr("value", "");
						break;
					case "M":
						// Remove all of the existing options
						$(columnSelect.Obj).find("option").remove();
						newMultiLookupPickerdata = "";
						break;
					default:
						break;
				}

				// Add an option for each item
				$(xData.responseXML).SPFilterNode("z:row").each(function() {
					
					var thisOptionId, thisOptionValue;

					// If relationshipListColumn is a Lookup column, then the ID should be for the Lookup value,
					// else the ID of the relationshipList item
					var thisValue = $(this).attr("ows_" + opt.relationshipListColumn);
					
					if(thisValue !== undefined && thisValue.indexOf(";#") > 0) {
						var splitValue = thisValue.split(";#");
						thisOptionId = splitValue[0];
						thisOptionValue = splitValue[1];
					} else {
						thisOptionId = $(this).attr("ows_ID");
						thisOptionValue = thisValue;						
					}

					// If the relationshipListColumn is a calculated column, then the value isn't preceded by the ID,
					// but by the datatype.  In this case, thisOptionId should be the ID of the relationshipList item.
					// e.g., float;#12345.67
					if(isNaN(thisOptionId)) {
						thisOptionId = $(this).attr("ows_ID");
					}
					
					switch(columnSelect.Type) {
						case "S":
							var selected = ($(this).attr("ows_ID") === columnSelectSelected[0]) ? " selected='selected'" : "";
							columnSelect.Obj.append("<option" + selected + " value='" + thisOptionId + "'>" + thisOptionValue + "</option>");
							break;
						case "C":
							if(thisOptionId === columnSelectSelected[0]) {
								columnSelect.Obj.attr("value", thisOptionValue);
							}
							choices = choices + ((choices.length > 0) ? "|" : "") + thisOptionValue + "|" + thisOptionId;
							break;
						case "M":
							columnSelect.Obj.append("<option value='" + thisOptionId + "'>" + thisOptionValue + "</option>");
							newMultiLookupPickerdata += thisOptionId + "|t" + thisOptionValue + "|t |t |t";
							break;
						default:
							break;
					}
				});
	
				switch(columnSelect.Type) {
					case "S":
						columnSelect.Obj.trigger("change");
						break;
					case "C":
						columnSelect.Obj.attr("choices", choices);
						columnSelect.Obj.trigger("propertychange");
						break;
					case "M":
						// Find the important bits of the multi-select
						MultiLookupPickerdata = columnSelect.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");
						master = window[columnSelect.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,'MultiLookupPicker_m')];
						currentSelection = columnSelect.Obj.closest("span").find("select[ID$='SelectResult']");
						// Clear the master
						master.data = "";

						MultiLookupPickerdata.attr("value", newMultiLookupPickerdata);
						// Clear any prior selections that are no longer valid
						$(currentSelection).find("option").each(function() {
							var thisSelected = $(this);
							$(this).attr("selected", "selected");
							$(columnSelect.Obj).find("option").each(function() {
								if($(this).html() === thisSelected.html()) {
									thisSelected.removeAttr("selected");
								}
							});
						});
						GipRemoveSelectedItems(master);
						// Hide any options in the candidate list which are already selected
						$(columnSelect.Obj).find("option").each(function() {
							var thisSelected = $(this);
							$(currentSelection).find("option").each(function() {
								if($(this).html() === thisSelected.html()) {
									thisSelected.remove();
								}
							});
						});
						GipAddSelectedItems(master);
						// Set master.data to the newly allowable values
						master.data = GipGetGroupData(newMultiLookupPickerdata);

						// Trigger a dblclick so that the child will be cascaded if it is a multiselect.
						columnSelect.Obj.trigger("dblclick");

						break;
					default:
						break;
				}
			}
		});
		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}
	}; // End $.fn.SPServices.SPFilterDropdown


	// Utility function to show the results of a Web Service call formatted well in the browser.
	$.fn.SPServices.SPDebugXMLHttpResult = function(options) {

		var opt = $.extend({}, {
			node: null,							// An XMLHttpResult object from an ajax call
			indent: 0							// Number of indents
		}, options);

		var i;
		var NODE_TEXT = 3;
		var NODE_CDATA_SECTION = 4;

		var outString = "";
		// For each new subnode, begin rendering a new TABLE
		outString += "<table class='ms-vb' style='margin-left:" + opt.indent * 3 + "px;' width='100%'>";
		// DisplayPatterns are a bit unique, so let's handle them differently
		if(opt.node.nodeName === "DisplayPattern") {
			outString += "<tr><td width='100px' style='font-weight:bold;'>" + opt.node.nodeName +
				"</td><td><textarea readonly='readonly' rows='5' cols='50'>" + opt.node.xml + "</textarea></td></tr>";
		// A node which has no children
		} else if (!opt.node.hasChildNodes()) {
			outString += "<tr><td width='100px' style='font-weight:bold;'>" + opt.node.nodeName +
				"</td><td>" + ((opt.node.nodeValue !== null) ? checkLink(opt.node.nodeValue) : "&nbsp;") + "</td></tr>";
			if (opt.node.attributes) {
				outString += "<tr><td colspan='99'>" + showAttrs(opt.node, opt) + "</td></tr>";
			}
		// A CDATA_SECTION node
		} else if (opt.node.hasChildNodes() && opt.node.firstChild.nodeType === NODE_CDATA_SECTION) {
			outString += "<tr><td width='100px' style='font-weight:bold;'>" + opt.node.nodeName +
				"</td><td><textarea readonly='readonly' rows='5' cols='50'>" + opt.node.parentNode.text + "</textarea></td></tr>";
		// A TEXT node
		} else if (opt.node.hasChildNodes() && opt.node.firstChild.nodeType === NODE_TEXT) {
			outString += "<tr><td width='100px' style='font-weight:bold;'>" + opt.node.nodeName +
				"</td><td>" + checkLink(opt.node.firstChild.nodeValue) + "</td></tr>";
		// Handle child nodes
		} else {
			outString += "<tr><td width='100px' style='font-weight:bold;' colspan='99'>" + opt.node.nodeName + "</td></tr>";
			if (opt.node.attributes) {
				outString += "<tr><td colspan='99'>" + showAttrs(opt.node, opt) + "</td></tr>";
			}
			// Since the node has child nodes, recurse
			outString += "<tr><td>";
			for (i = 0;i < opt.node.childNodes.length; i++) {
				outString += $().SPServices.SPDebugXMLHttpResult({
					node: opt.node.childNodes.item(i),
					indent: opt.indent + 1
				});
			}
			outString += "</td></tr>";
		}
		outString += "</table>";
		// Return the HTML which we have built up
		return outString;
	}; // End $.fn.SPServices.SPDebugXMLHttpResult

	// Function which returns the account name for the current user in DOMAIN\username format
	$.fn.SPServices.SPGetCurrentUser = function(options) {

		var opt = $.extend({}, {
			fieldName: "Name",				// Specifies which field to return from the userdisp.aspx page
			fieldNames: {},					// Specifies which fields to return from the userdisp.aspx page - added in v0.7.2 to allow multiple columns
			debug: false					// If true, show error messages; if false, run silent
		}, options);

		// The current user's ID is reliably available in an existing JavaScript variable
		if(opt.fieldName === "ID" && _spUserId != undefined) {
			return _spUserId;
		}

		var thisField = "";
		var theseFields = {};
		var fieldCount = opt.fieldNames.length > 0 ? opt.fieldNames.length : 1;
		var thisUserDisp;

		// Get the UserDisp.aspx page using AJAX
		$.ajax({
			// Need this to be synchronous so we're assured of a valid value
			async: false,
			// Force parameter forces redirection to a page that displays the information as stored in the UserInfo table rather than My Site.
			// Adding the extra Query String parameter with the current date/time forces the server to view this as a new request.
			url: $().SPServices.SPGetCurrentSite() + "/_layouts/userdisp.aspx?Force=True&" + new Date().getTime(),
			complete: function (xData, Status) {
				thisUserDisp = xData;
			}
		});

		for(i=0; i < fieldCount; i++) {

			// The current user's ID is reliably available in an existing JavaScript variable
			if(opt.fieldNames[i] === "ID") {
				thisField = _spUserId;
			} else {
				var thisTextValue;
				if(fieldCount > 1) {
					thisTextValue = RegExp("FieldInternalName=\"" + opt.fieldNames[i] + "\"", "gi");
				} else {
					thisTextValue = RegExp("FieldInternalName=\"" + opt.fieldName + "\"", "gi");
				}
				$(thisUserDisp.responseText).find("table.ms-formtable td[id^='SPField']").each(function() {
					if(thisTextValue.test($(this).html())) {
						// Each fieldtype contains a different data type, as indicated by the id
						switch($(this).attr("id")) {
							case "SPFieldText":
								thisField = $(this).text();
								break;
							case "SPFieldNote":
								thisField = $(this).find("div").html();
								break;
							case "SPFieldURL":
								thisField = $(this).find("img").attr("src");
								break;
							// Just in case
							default:
								thisField = $(this).text();
								break;						
						}
						// Stop looking; we're done
						return false;
					}
				});
			}
			if(opt.fieldNames[i] !== "ID") {
				thisField = (thisField !== undefined) ? thisField.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g, '') : null;
			}
			if(fieldCount > 1) {
				theseFields[opt.fieldNames[i]] = thisField;
			}
		}

		return (fieldCount > 1) ? theseFields : thisField;

	}; // End $.fn.SPServices.SPGetCurrentUser


	// Function which provides a link on a Lookup column for the user to follow
	// which allows them to add a new value to the Lookup list.
	// Based on http://blog.mastykarz.nl/extending-lookup-fields-add-new-item-option/
	// by Waldek Mastykarz
	$.fn.SPServices.SPLookupAddNew = function(options) {

		var opt = $.extend({}, {
			lookupColumn: "",				// The display name of the Lookup column
			promptText: "Add new {0}",		// Text to use as prompt + column name
			newWindow: false,				// If true, the link will open in a new window *without* passing the Source.
			ContentTypeID: "",				// [Optional] Pass the ContentTypeID if you'd like to specify it
			completefunc: null,				// Function to call on completion of rendering the change.
			debug: false					// If true, show error messages;if false, run silent
		}, options);

		var thisFunction = "SPServices.SPLookupAddNew";

		// Find the lookup column's select (dropdown)
		var lookupSelect = new DropdownCtl(opt.lookupColumn);
		if(lookupSelect.Obj.html() === null && opt.debug) { errBox(thisFunction, "lookupColumn: " + opt.lookupColumn, TXTColumnNotFound);return;}

		var newUrl = "";
		var lookupListUrl = "";
		var lookupColumnStaticName = "";
		// Use GetList for the current list to determine the details for the Lookup column
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			listName: $().SPServices.SPListNameFromUrl(),
			completefunc: function (xData, Status) {
				$(xData.responseXML).find("Field[DisplayName='" + opt.lookupColumn + "']").each(function() {
					lookupColumnStaticName = $(this).attr("StaticName");
					// Use GetList for the Lookup column's list to determine the list's URL
					$().SPServices({
						operation: "GetList",
						async: false,
						cacheXML: true,
						listName: $(this).attr("List"),
						completefunc: function (xData, Status) {
							$(xData.responseXML).find("List").each(function() {
								lookupListUrl = $(this).attr("WebFullUrl");
								// Need to handle when list is in the root site
								lookupListUrl = lookupListUrl !== SLASH ? lookupListUrl + SLASH : lookupListUrl;
							});
						}
					});
					// Get the NewItem form for the Lookup column's list
					newUrl = getListFormUrl($(this).attr("List"), "NewForm");
					// Stop looking;we're done
					return false;
				});
			}
		});

		if(lookupListUrl.length === 0 && opt.debug) {
			errBox(thisFunction, "lookupColumn: " + opt.lookupColumn, "This column does not appear to be a lookup column");
			return;
		}
		if(newUrl.length > 0) {
			// Build the link to the Lookup column's list enclosed in a div with the id="SPLookupAddNew_" + lookupColumnStaticName
			var newHref = lookupListUrl + newUrl;
			// If requested, open the link in a new window and if requested, pass the ContentTypeID
			newHref += opt.newWindow ?
					((opt.ContentTypeID.length > 0) ? "?ContentTypeID=" + opt.ContentTypeID : "") + "' target='_blank'" :
					"?" + ((opt.ContentTypeID.length > 0) ? "ContentTypeID=" + opt.ContentTypeID + "&" : "") + "Source=" + escapeUrl(location.href) + "'";
			newLink = "<div id='SPLookupAddNew_" + lookupColumnStaticName + "'>" + "<a href='" + newHref + ">" + opt.promptText.replace(/\{0\}/g, opt.lookupColumn) + "</a></div>";
			// Append the link to the Lookup columns's formbody table cell
			$(lookupSelect.Obj).parents("td.ms-formbody").append(newLink);
		} else if(opt.debug) {
			errBox(thisFunction, "lookupColumn: " + opt.lookupColumn, "NewForm cannot be found");
			return;
		}
		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}
	}; // End $.fn.SPServices.SPLookupAddNew

	// Function to return the ID of the last item created on a list by a specific user. Useful for maintaining parent/child relationships
	// between list forms
	$.fn.SPServices.SPGetLastItemId = function(options) {

		var opt = $.extend({}, {
			webURL: "",				// URL of the target Web.  If not specified, the current Web is used.
			listName: "",			// The name or GUID of the list
			userAccount: "",		// The account for the user in DOMAIN\username format. If not specified, the current user is used.
			CAMLQuery: ""			// [Optional] For power users, this CAML fragment will be Anded with the default query on the relatedList
		}, options);

		var userId;
		var lastId = 0;
		$().SPServices({
			operation: "GetUserInfo",
			webURL: opt.webURL,
			async: false,
			userLoginName: (opt.userAccount !== "") ? opt.userAccount : $().SPServices.SPGetCurrentUser(),
			completefunc: function (xData, Status) {
				$(xData.responseXML).find("User").each(function() {
					userId = $(this).attr("ID");
				});
			}
		});

		// Get the list items for the user, sorted by Created, descending. If the CAMLQuery option has been specified, And it with
		// the existing Where clause
		var camlQuery = "<Query><Where>";
		if(opt.CAMLQuery.length > 0) {
			camlQuery += "<And>";
		}
		camlQuery += "<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>" + userId + "</Value></Eq>";
		if(opt.CAMLQuery.length > 0) {
			camlQuery += opt.CAMLQuery + "</And>";
		}
		camlQuery += "</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";

		$().SPServices({
			operation: "GetListItems",
			async: false,
			webURL: opt.webURL,
			listName: opt.listName,
			CAMLQuery: camlQuery,
			CAMLViewFields: "<ViewFields><FieldRef Name='ID'/></ViewFields>",
			CAMLRowLimit: 1,
			CAMLQueryOptions: "<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",
			completefunc: function(xData, Status) {
				$(xData.responseXML).SPFilterNode("z:row").each(function() {
					lastId = $(this).attr("ows_ID");
				});
			}
		});
		return lastId;
	}; // End $.fn.SPServices.SPGetLastItemId
	
	// Function which checks to see if the value for a column on the form is unique in the list.
	$.fn.SPServices.SPRequireUnique = function (options) {

		var opt = $.extend({}, {
			columnStaticName: "Title",					// Name of the column
			duplicateAction: 0,							// 0 = warn, 1 = prevent
			ignoreCase: false,							// If set to true, the function ignores case, if false it looks for an exact match
			initMsg: "This value must be unique.",		// Initial message to display after setup
			initMsgCSSClass: "ms-vb",					// CSS class for initial message
			errMsg: "This value is not unique.",		// Error message to display if not unique
			errMsgCSSClass: "ms-formvalidation",		// CSS class for error message
			showDupes: false,							// If true, show links to the duplicate item(s) after the error message
			completefunc: null							// Function to call on completion of rendering the change.
		}, options);

		// Get the current item's ID from the Query String
		var queryStringVals = $().SPServices.SPGetQueryString();
		var thisID = queryStringVals.ID;
		var thisList = $().SPServices.SPListNameFromUrl();

		// Set the messages based on the options provided
		var msg = "<span id='SPRequireUnique" + opt.columnStaticName + "' class='{0}'>{1}</span><br/>";
		var firstMsg = msg.replace(/\{0\}/g, opt.initMsgCSSClass).replace(/\{1\}/g, opt.initMsg);
		
		// We need the DisplayName
		var columnDisplayName = $().SPServices.SPGetDisplayFromStatic({
			listName: thisList,
			columnStaticName: opt.columnStaticName
		});
		var columnObj = $("input[Title='" + columnDisplayName + "']");
		$(columnObj).parent().append(firstMsg);

		$(columnObj).blur(function () {
			var columnValueIDs = [];
			// Get the columnDisplayName's value
			var columnValue = $(this).attr("value");
			if(columnValue.length === 0) { return false; }

			// Call the Lists Web Service (GetListItems) to see if the value already exists
			$().SPServices({
				operation: "GetListItems",
				async: false,
				listName: thisList,
				// Make sure we get all the items, ignoring any filters on the default view.
				CAMLQuery: "<Query><Where><IsNotNull><FieldRef Name='" + opt.columnStaticName + "'/></IsNotNull></Where></Query>",
				// Filter based on columnStaticName's value
				CAMLViewFields: "<ViewFields><FieldRef Name='ID' /><FieldRef Name='" + opt.columnStaticName + "' /></ViewFields>",
				// Override the default view rowlimit and get all appropriate rows
				CAMLRowLimit: 0,
				completefunc: function(xData, Status) {
					var testValue = opt.ignoreCase ? columnValue.toUpperCase() : columnValue;
					$(xData.responseXML).SPFilterNode("z:row").each(function() {
						var thisValue = opt.ignoreCase ? $(this).attr("ows_" + opt.columnStaticName).toUpperCase() : $(this).attr("ows_" + opt.columnStaticName);
						// If this value already exists in columnStaticName and it's not the current item, then save the ID in the array
						if((testValue === thisValue) && ($(this).attr("ows_ID") !== thisID)) {
							columnValueIDs.push([$(this).attr("ows_ID"), $(this).attr("ows_" + opt.columnStaticName)]);
						}
					});
				}
			});
			var newMsg = opt.initMsg;
			$("span#SPRequireUnique" + opt.columnStaticName).html(newMsg).attr("class", opt.initMsgCSSClass);

			$("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled");
			if(columnValueIDs.length > 0) {
				newMsg = opt.errMsg;
				$("span#SPRequireUnique" + opt.columnStaticName).html(newMsg).attr("class", opt.errMsgCSSClass);
				if(opt.duplicateAction === 1) {
					$("input[Title='" + opt.columnDisplayName + "']").focus();
					$("input[value='OK'], input[value='Save']").attr("disabled", "disabled");
				}
				if(opt.showDupes) {
					var out = " " + columnValueIDs.length + " duplicate item" + (columnValueIDs.length > 1 ? "s" : "") + ": ";
					for (i=0;i < columnValueIDs.length; i++) {
						out += "<a href='DispForm.aspx?ID=" + columnValueIDs[i][0] + "&Source=" + location.href + "'>" + columnValueIDs[i][1] + "</a> ";
					}
					$("span#SPRequireUnique" + opt.columnStaticName).append(out);
				}
			}

		});
		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}
	}; // End $.fn.SPServices.SPRequireUnique

	// This function returns the DisplayName for a column based on the StaticName.
	$.fn.SPServices.SPGetDisplayFromStatic = function (options) {

		var opt = $.extend({}, {
			webURL: "",						// URL of the target Web.  If not specified, the current Web is used.
			listName: "",					// The name or GUID of the list
			columnStaticName: "",			// StaticName of the column
			columnStaticNames: {}			// StaticName of the columns - added in v0.7.2 to allow multiple columns
		}, options);

		var displayName = "";
		var displayNames = {};
		var nameCount = opt.columnStaticNames.length > 0 ? opt.columnStaticNames.length : 1;

		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			webURL: opt.webURL,
			listName: opt.listName,
			completefunc: function(xData, Status) {
				if(nameCount > 1) {
					for(i=0; i < nameCount; i++) {
						displayNames[opt.columnStaticNames[i]] = $(xData.responseXML).find("Field[StaticName='" + opt.columnStaticNames[i] + "']").attr("DisplayName");
					}
				} else {
					displayName = $(xData.responseXML).find("Field[StaticName='" + opt.columnStaticName + "']").attr("DisplayName");
				}
			}
		});

		return (nameCount > 1) ? displayNames : displayName;

	}; // End $.fn.SPServices.SPGetDisplayFromStatic

	// This function returns the StaticName for a column based on the DisplayName.
	$.fn.SPServices.SPGetStaticFromDisplay = function (options) {

		var opt = $.extend({}, {
			webURL: "",						// URL of the target Web.  If not specified, the current Web is used.
			listName: "",					// The name or GUID of the list
			columnDisplayName: "",			// DisplayName of the column
			columnDisplayNames: {}			// DisplayNames of the columns - added in v0.7.2 to allow multiple columns
		}, options);

		var staticName = "";
		var staticNames = {};
		var nameCount = opt.columnDisplayNames.length > 0 ? opt.columnDisplayNames.length : 1;

		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			webURL: opt.webURL,
			listName: opt.listName,
			completefunc: function(xData, Status) {
				if(nameCount > 1) {
					for(i=0; i < nameCount; i++) {
						staticNames[opt.columnDisplayNames[i]] = $(xData.responseXML).find("Field[DisplayName='" + opt.columnDisplayNames[i] + "']").attr("StaticName");
					}
				} else {
					staticName = $(xData.responseXML).find("Field[DisplayName='" + opt.columnDisplayName + "']").attr("StaticName");
				}
			}
		});

		return (nameCount > 1) ? staticNames : staticName;

	}; // End $.fn.SPServices.SPGetStaticFromDisplay

	// This function allows you to redirect to a another page from a new item form with the new
	// item's ID. This allows chaining of forms from item creation onward.
	$.fn.SPServices.SPRedirectWithID = function (options) {

		var opt = $.extend({}, {
			redirectUrl: "",			// Page for the redirect
			qsParamName: "ID"			// In some cases, you may want to pass the newly created item's ID with a different
										// parameter name than ID. Specify that name here, if needed.
		}, options);

		var thisList = $().SPServices.SPListNameFromUrl();
		var queryStringVals = $().SPServices.SPGetQueryString();
		var lastID = queryStringVals.ID;
		var QSList = queryStringVals.List;
		var QSRootFolder = queryStringVals.RootFolder;
		var QSContentTypeId = queryStringVals.ContentTypeId;
		
		// On first load, change the form actions to redirect back to this page with the current lastID for this user and the
		// original Source.
		if(typeof queryStringVals.ID === 'undefined') {
			lastID = $().SPServices.SPGetLastItemId({
				listName: thisList
			});
			$("form[name='aspnetForm']").each(function() {
				// This page...
				var thisUrl = (location.href.indexOf("?") > 0) ? location.href.substring(0, location.href.indexOf("?")) : location.href;
				// ... plus the Source if it exists
				var thisSource = (typeof queryStringVals.Source === "string") ?
					"Source=" + queryStringVals.Source.replace(/\//g, "%2f").replace(/:/g, "%3a") : "";
				
				var newQS = [];
				if(typeof QSList !== 'undefined') {
					newQS.push("List=" + QSList);
				}
				if(typeof QSRootFolder !== 'undefined') {
					newQS.push("RootFolder=" + QSRootFolder);
				}
				if(typeof QSContentTypeId !== 'undefined') {
					newQS.push("ContentTypeId=" + QSContentTypeId);
				}

				var newAction = thisUrl +
					((newQS.length > 0) ? ("?" + newQS.join("&") + "&") : "?") +
					// Set the Source to point back to this page with the lastID this user has added
					"Source=" + thisUrl +
					"?ID=" + lastID +
					// Pass the original source as RealSource, if present
					((thisSource.length > 0) ? ("%26RealSource=" + queryStringVals.Source) : "") +
					// Pass the override RedirectURL, if present
					((typeof queryStringVals.RedirectURL === "string") ? ("%26RedirectURL=" + queryStringVals.RedirectURL) : "");
				$(this).attr("action", newAction);
			});
		// If this is the load after the item is saved, wait until the new item has been saved (commits are asynchronous),
		// then do the redirect to redirectUrl with the new lastID, passing along the original Source.
		} else {
			while(queryStringVals.ID === lastID) {
				lastID = $().SPServices.SPGetLastItemId({
					listName: thisList
				});
			}
			// If there is a RedirectURL parameter on the Query String, then redirect there instead of the value
			// specified in the options (opt.redirectUrl)
			var thisRedirectUrl = (typeof queryStringVals.RedirectURL === "string") ? queryStringVals.RedirectURL : opt.redirectUrl;
			location.href = thisRedirectUrl + "?" + opt.qsParamName + "=" + lastID +
				((typeof queryStringVals.RealSource === "string") ? ("&Source=" + queryStringVals.RealSource) : "");
		}
	}; // End $.fn.SPServices.SPRedirectWithID

	// The SPSetMultiSelectSizes function sets the sizes of the multi-select boxes for a column on a form automagically
	// based on the values they contain. The function takes into account the fontSize, fontFamily, fontWeight, etc., in its algorithm.
	$.fn.SPServices.SPSetMultiSelectSizes = function (options) {

		var opt = $.extend({}, {
			multiSelectColumn: "",
			minWidth: 0,
			maxWidth: 0,
			debug: false
		}, options);

		var thisFunction = "SPServices.SPSetMultiSelectSizes";

		// Find the multi-select column
		var thisMultiSelect = new DropdownCtl(opt.multiSelectColumn);
		if(thisMultiSelect.Obj.html() === null && opt.debug) { errBox(thisFunction, "multiSelectColumn: " + opt.multiSelectColumn, TXTColumnNotFound);return;}
		if(thisMultiSelect.Type !== "M" && opt.debug) { errBox(thisFunction, "multiSelectColumn: " + opt.multiSelectColumn, "Column is not multi-select.");return;}

		var possibleValues = thisMultiSelect.Obj;
		var selectedValues = possibleValues.closest("span").find("select[ID$='SelectResult']");

		// Create a temporary clone of the select to use to determine the appropriate width settings.
		// We'll append it to the end of the enclosing span.
		var cloneId = genContainerId("SPSetMultiSelectSizes", opt.multiSelectColumn);
		possibleValues.clone().appendTo(possibleValues.closest("span")).css({
			"width": "auto",		// We want the clone to resize its width based on the contents
			"height": 0,			// Just to keep the page clean while we are using the clone
			"visibility": "hidden"	// And let's keep it hidden
		}).attr({
			id: cloneId,			// We don't want the clone to have the same id as its source
			length: 0				// And let's start with no options
		});
		var cloneObj = $("#" + cloneId);

		// Add all the values to the cloned select.  First the left (possible values) select...
		possibleValues.find("option").each(function() {
			cloneObj.append("<option value='" + $(this).html() + "'>" + $(this).html() + "</option>");
		});
		// ...then the right (selected values) select (in case some values have already been selected)
		selectedValues.find("option").each(function() {
			cloneObj.append("<option value='" + $(this).html() + "'>" + $(this).html() + "</option>");
		});

		// We'll add 5px for a little padding on the right.
		var divWidth = $("#" + cloneId).width() + 5;
		var newDivWidth = divWidth;
		if(opt.minWidth > 0 || opt.maxWidth > 0) {
			if(divWidth < opt.minWidth) {
				divWidth = opt.minWidth;
			}
			if(newDivWidth < opt.minWidth) {
				newDivWidth = opt.minWidth;
			}
			if(newDivWidth > opt.maxWidth) {
				newDivWidth = opt.maxWidth;
			}
		}
		var selectWidth = divWidth;

		// Set the new widths
		possibleValues.css("width", selectWidth + "px").parent().css("width", newDivWidth + "px");
		selectedValues.css("width", selectWidth + "px").parent().css("width", newDivWidth + "px");

		// Remove the select's clone, since we're done with it
		$("#" + cloneId).remove();
	}; // End $.fn.SPServices.SPSetMultiSelectSizes

	// Does an audit of a site's list forms to show where script is in use.
	$.fn.SPServices.SPScriptAudit = function (options) {

		var opt = $.extend({}, {
			webURL: "",						// [Optional] The name of the Web (site) to audit
			listName: "",					// [Optional] The name of a specific list to audit. If not present, all lists in the site are audited.
			outputId: "",					// The id of the DOM object for output
			auditForms: true,				// Audit the form pages
			auditViews: true,				// Audit the view pages
			auditPages: true,				// Audit the Pages Document Library
			auditPagesListName: "Pages",	// The Pages Document Library(ies), if desired. Either a single string or an array of strings.
			showHiddenLists: false,			// Show output for hidden lists
			showNoScript: false,			// Show output for lists with no scripts (effectively "verbose")
			showSrc: true					// Show the source location for included scripts
		}, options);

		var formTypes = [["New", "NewForm.aspx", false], ["Display", "DispForm.aspx", false], ["Edit", "EditForm.aspx", false]];
		var listXml;

		// Build the table to contain the results
		$("#" + opt.outputId)
			.append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>" +
					"<tr>" +
						"<th></th>" +
						"<th>List</th>" +
						"<th>Page Class</th>" +
						"<th>Page Type</th>" +
						"<th>Page</th>" +
						(opt.showSrc ? "<th>Script References</th>" : "") +
					"</tr>" +
				"</table>");
		// Apply the CSS class to the headers
		$("#SPScriptAudit th").attr("class", "ms-vh2-nofilter");
		
		// Don't bother with the lists if the options don't require them
		if(opt.auditForms || opt.auditViews) {
			// First, get all of the lists within the site
			$().SPServices({
				operation: "GetListCollection",
				webURL: opt.webURL,
				async: false, // Need this to be synchronous so we're assured of a valid value
				completefunc: function (xData, Status) {
					$(xData.responseXML).find("List").each(function() {
						listXml = $(this);
							
						// If listName has been specified, then only return results for that list
						if((opt.listName.length === 0) || (listXml.attr("Title") === opt.listName)) {
							// Don't work with hidden lists unless we're asked to
							if((opt.showHiddenLists && listXml.attr("Hidden") === "False") || !opt.showHiddenLists) {
	
								// Audit the list's forms
								if(opt.auditForms) {
									// Get the list's Content Types, therefore the form pages
									$().SPServices({
										operation: "GetListContentTypes",
										webURL: opt.webURL,
										listName: listXml.attr("ID"),
										async: false, // Need this to be synchronous so we're assured of a valid value
										completefunc: function (xData, Status) {
											$(xData.responseXML).find("ContentType").each(function() {
												// Don't deal with folders
												if($(this).attr("ID").substring(0,6) !== "0x0120") {
													var formUrls = $(this).find("FormUrls");
													for(i=0; i < formTypes.length; i++) {
														// Look for a customized form...
														$(formUrls).find(formTypes[i][0]).each(function() {
															SPScriptAuditPage(opt, listXml, "Form", this.nodeName,
																((opt.webURL.length > 0) ? opt.webURL : $().SPServices.SPGetCurrentSite()) + SLASH + $(this).text());
															formTypes[i][2] = true;
														});
														// ...else the uncustomized form
														if(!formTypes[i][2]) {
															var defaultViewUrl = listXml.attr("DefaultViewUrl");
															SPScriptAuditPage(opt, listXml, "Form", formTypes[i][0],
																defaultViewUrl.substring(0, defaultViewUrl.lastIndexOf(SLASH)+1) + formTypes[i][1]);
														}
													}
													// Reset the form types
													for(i=0; i < formTypes.length; i++) {
														formTypes[i][2] = false;
													}
												}
											});
										}
									});
								}
	
								// Audit the list's views
								if(opt.auditViews) {
									// Get the list's Views
									$().SPServices({
										operation: "GetViewCollection",
										webURL: opt.webURL,
										listName: listXml.attr("ID"),
										async: false, // Need this to be synchronous so we're assured of a valid value
										completefunc: function (xData, Status) {
											$(xData.responseXML).find("View").each(function() {
												SPScriptAuditPage(opt, listXml, "View", $(this).attr("DisplayName"), $(this).attr("Url"));
											});
										}
									});
								}

							}
						}
					});
				}
			});
		}

		// Don't bother with auditing pages if the options don't require it
		var numLists = 0;
		var listsArray = [];
		if(typeof opt.auditPagesListName === "string") {
			numLists = 1;
			listsArray.push(opt.auditPagesListName);
		} else {
			numLists = opt.auditPagesListName.length;
			listsArray = opt.auditPagesListName;
		}
		
		if(opt.auditPages) {
			for(i=0; i < numLists; i++) {
				$().SPServices({
					operation: "GetList",
					async: false,
					cacheXML: true,
					webURL: opt.webURL,
					listName: listsArray[i],
					completefunc: function (xData, Status) {
						$(xData.responseXML).find("List").each(function() {
							listXml = $(this);
						});
					}
				});
				// Get all of the items from the Document Library
				$().SPServices({
					operation: "GetListItems",
					async: false,
					webURL: opt.webURL,
					listName: listsArray[i],
					CAMLQuery: "<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",
					CAMLViewFields: "<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",
					CAMLRowLimit: 0,
					completefunc: function(xData, Status) {
						$(xData.responseXML).SPFilterNode("z:row").each(function() {
							var thisPageUrl = $(this).attr("ows_FileRef").split(";#")[1];
							var thisPageType = (typeof $(this).attr("ows_Title") !== 'undefined') ? $(this).attr("ows_Title") : "";
							if(thisPageUrl.indexOf(".aspx") > 0) {
								SPScriptAuditPage(opt, listXml, "Page", thisPageType, SLASH + thisPageUrl);
							}
						});
					}
				});
			}
		}
		// Remove progress indicator and make the output pretty by cleaning up the ms-alternating CSS class
		$("#SPScriptAudit tr[class='ms-alternating']:even").removeAttr("class");
	}; // End $.fn.SPServices.SPScriptAudit

	// Displays the usage of scripts in a site
	function SPScriptAuditPage(opt, listXml, pageClass, pageType, pageUrl) {

		var i = 0;
		var jQueryPage = 0;
		var pageScriptSrc = {};
		pageScriptSrc.type = [];
		pageScriptSrc.src = [];
		pageScriptSrc.script = [];
		var scriptRegex = RegExp("<script[\\s\\S]*?/script>", "gi");

		// Fetch the page
		$.ajax({
			type: "GET",
			url: pageUrl,
			dataType: "text",
			async: false,
			success: function(xData) {

				while (scriptMatch = scriptRegex.exec(xData)) {
					var scriptLanguage = getScriptAttribute(scriptMatch, "language");
					var scriptType = getScriptAttribute(scriptMatch, "type");
					var scriptSrc = getScriptAttribute(scriptMatch, "src");
					if(scriptSrc !== null && scriptSrc.length > 0 && !coreScript(scriptSrc)) {
						pageScriptSrc.type.push((scriptLanguage !== null && scriptLanguage.length > 0) ? scriptLanguage : scriptType);
						pageScriptSrc.src.push(scriptSrc);
						jQueryPage++;
					}
				}

				// Only show pages without script if we've been asked to do so.
				if((!opt.showNoScript && (pageScriptSrc.type.length > 0)) || opt.showNoScript)  {
					var pagePath = pageUrl.substring(0, pageUrl.lastIndexOf(SLASH)+1);
					var out = "<tr class=ms-alternating>" +
						"<td class=ms-vb-icon><a href='" + listXml.attr("DefaultViewUrl") + "'><IMG border=0 src='" + listXml.attr("ImageUrl") + "'width=16 height=16></A></TD>" +
						"<td class=ms-vb2><a href='" + listXml.attr("DefaultViewUrl") + "'>" + listXml.attr("Title") + ((listXml.attr("Hidden") === "True") ? '(Hidden)' : '')+ "</td>" +
						"<td class=ms-vb2>" + pageClass + "</td>" +
						"<td class=ms-vb2>" + pageType + "</td>" +
						"<td class=ms-vb2><a href='" + pageUrl + "'>" + fileName(pageUrl) + "</td>";
					if(opt.showSrc) {
						var thisSrcPath; 
						out += "<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";
						for(i=0; i < pageScriptSrc.type.length; i++) {
							thisSrcPath = (pageScriptSrc.src[i].substr(0,1) !== SLASH) ? pagePath + pageScriptSrc.src[i] : pageScriptSrc.src[i];
							out += "<tr><td class=ms-vb2 width='30%'>" + pageScriptSrc.type[i] + "</td>";
							out += "<td class=ms-vb2 width='70%'><a href='" + thisSrcPath + "'>" + fileName(pageScriptSrc.src[i]) + "</td></tr>";
						}
						out += "</table></td>";
					}
					$("#SPScriptAudit").append(out);
				}
			}
		});
	} // End of function SPScriptAuditPage
	
	function getScriptAttribute(source, attribute) {
		var regex = RegExp(attribute + "=(\"([^\"]*)\")|('([^']*)')", "gi");
		if(matches = regex.exec(source)) {
			return matches[2];
		}
		return null;
	} // End of function getScriptAttribute

	// Check to see if the script reference is part of SharePoint core so that we can ignore it
	function coreScript(src) {
		var i;
		var coreScriptLocations = ["WebResource.axd", "_layouts"];
		for(i=0; i < coreScriptLocations.length; i++) {
			if(src.indexOf(coreScriptLocations[i]) > -1) {
				return true;	
			}
		}
		return false;
	} // End of function coreScript

	// Rearrange radio buttons or checkboxes in a form from vertical to horizontal display to save page real estate
	$.fn.SPServices.SPArrangeChoices = function (options) {

		var opt = $.extend({}, {
			listName: "",					// The list name for the current form
			columnName: "",					// The display name of the column in the form
			perRow: 99,						// Maximum number of choices desired per row.
			randomize: false				// If true, randomize the order of the options
		}, options);

		var columnFillInChoice = false;
		var columnOptions = [];
		var out;
		
		// Get information about columnName from the list to determine if we're allowing fill-in choices
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			listName: (opt.listName.length > 0) ? opt.listName : $().SPServices.SPListNameFromUrl(),
			completefunc: function(xData, Status) {
				$(xData.responseXML).find("Fields").each(function() {
					$(this).find("Field[DisplayName='" + opt.columnName + "']").each(function() {
						// Determine whether columnName allows a fill-in choice
						columnFillInChoice = ($(this).attr("FillInChoice") === "TRUE") ? true : false;
						// Stop looking;we're done
						return false;
					});
				});
			}
		});

		var thisFormField = findFormField(opt.columnName);
		
		var totalChoices = $(thisFormField).find("tr").length;
		var choiceNumber = 0;
		var fillinPrompt;
		var fillinInput;
		// Collect all of the choices
		$(thisFormField).find("tr").each(function() {
			choiceNumber++;
			// If this is the fill-in prompt, save it...
			if(columnFillInChoice && choiceNumber === (totalChoices - 1)) {
				fillinPrompt = $(this).find("td").html();
			// ...or if it is the fill-in input box, save it...
			} else if(columnFillInChoice && choiceNumber === totalChoices) {
				fillinInput = $(this).find("td").html();
			// ...else push into the columnOptions array.
			} else {
				columnOptions.push($(this).html());
			}
		});
		out = "<TR>";

		// If randomize is true, randomly sort the options
		if(opt.randomize) {
			columnOptions.sort(randOrd);
		}

		// Add all of the options to the out string
		for(i=0; i < columnOptions.length; i++) {
			out += columnOptions[i];
			// If we've already got perRow columnOptions in the row, close off the row
			if((i+1) % opt.perRow === 0) {
				out += "</TR><TR>";
			}
		}
		out += "</TR>";

		// If we are allowing a fill-in choice, add that option in a separate row at the bottom
		if(columnFillInChoice) {
			out += "<TR><TD colspan='99'>" + fillinPrompt + fillinInput + "</TD></TR>";
		}

		// Remove the existing rows...
		$(thisFormField).find("tr").remove();
		// ...and append the out string
		$(thisFormField).find("table").append(out);

	}; // End $.fn.SPServices.SPArrangeChoices

	// Provide suggested values from a list for in input column based on characters typed
	$.fn.SPServices.SPAutocomplete = function (options) {

		var opt = $.extend({}, {
			WebURL: "",							// [Optional] The name of the Web (site) which contains the sourceList
			sourceList: "",						// The name of the list which contains the values
			sourceColumn: "",					// The static name of the column which contains the values
			columnName: "",						// The display name of the column in the form
			CAMLQuery: "",						// [Optional] For power users, this CAML fragment will be Anded with the default query on the relatedList
			CAMLQueryOptions: "<QueryOptions></QueryOptions>",	// [Optional] For power users, allows specifying the CAMLQueryOptions for the GetListItems call
			CAMLRowLimit: 0,					// [Optional] Override the default view rowlimit and get all appropriate rows
			filterType: "BeginsWith",			// Type of filtering: [BeginsWith, Contains]
			numChars: 0,						// Wait until this number of characters has been typed before attempting any actions
			ignoreCase: false,					// If set to true, the function ignores case, if false it looks for an exact match
			highlightClass: "",					// If a class is supplied, highlight the matched characters in the values by applying that class to a wrapping span
			uniqueVals: false,					// If set to true, the function only adds unique values to the list (no duplicates)
			maxHeight: 99999,					// Sets the maximum number of values to display before scrolling occurs
			slideDownSpeed: "fast",				// Speed at which the div should slide down when values match (milliseconds or ["fast" | "slow"])
			processingIndicator: "_layouts/images/REFRESH.GIF",				// If present, show this while processing
			debug: false						// If true, show error messages;if false, run silent
		}, options);

		var matchNum;

		// Find the input control for the column and save some of its attributes
		var columnObj = $("input[Title='" + opt.columnName + "']");
		$("input[Title='" + opt.columnName + "']").css("position", "");
		var columnObjId = columnObj.attr("ID");
		var columnObjColor = columnObj.css("color");
		var columnObjWidth = columnObj.css("width");

		if(columnObj.html() === null && opt.debug) {
			errBox("SPServices.SPAutocomplete",
				"columnName: " + opt.columnName,
				"Column is not an input control or is not found on page");
			return;
		}

		// Remove the <br/> which isn't needed and messes up the formatting
		columnObj.closest("span").find("br").remove();
		columnObj.wrap("<div>");

		// Create a div to contain the matching values and add it to the DOM
		var containerId = genContainerId("SPAutocomplete", opt.columnName);		
		columnObj.after("<div><ul id='" + containerId + "' style='width:" + columnObjWidth + ";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");

		// Set the width to match the width of the input control
		$("#" + containerId).css("width", columnObjWidth);		

		// Handle keypresses
		$(columnObj).keyup(function () {

			// Get the column's value
			var columnValue = $(this).val();

			// Hide the container while we're working on it
			$("#" + containerId).hide();

			// Have enough characters been typed yet?
			if(columnValue.length < opt.numChars) {
				return false;
			}

			// Show the the processingIndicator as a background image in the input element
			columnObj.css({
				"background-image": "url(" + opt.processingIndicator + ")",
				"background-position": "right",
				"background-repeat": "no-repeat"
			});

			// Array to hold the matched values
			var matchArray = [];
			
			// Build the appropriate CAMLQuery
			var camlQuery = "<Query><OrderBy><FieldRef Name='" + opt.sourceColumn + "'/></OrderBy><Where>";
			if(opt.CAMLQuery.length > 0) {
				camlQuery += "<And>";
			}
			camlQuery += "<" + opt.filterType + "><FieldRef Name='" + opt.sourceColumn + "'/><Value Type='Text'>" + columnValue + "</Value></" + opt.filterType + ">";			
			if(opt.CAMLQuery.length > 0) {
				camlQuery += opt.CAMLQuery + "</And>";
			}
			camlQuery += "</Where></Query>";

			// Call GetListItems to find all of the potential values
			$().SPServices({
				operation: "GetListItems",
				async: false,
				webURL: opt.WebURL,
				listName: opt.sourceList,
				CAMLQuery: camlQuery,
				CAMLQueryOptions: opt.CAMLQueryOptions,
				CAMLViewFields: "<ViewFields><FieldRef Name='" + opt.sourceColumn + "' /></ViewFields>",
				CAMLRowLimit: opt.CAMLRowLimit,
				completefunc: function(xData, Status) {
					// Handle upper/lower case if ignoreCase = true
					var testValue = opt.ignoreCase ? columnValue.toUpperCase() : columnValue;
					// See which values match and add the ones that do to matchArray
					$(xData.responseXML).SPFilterNode("z:row").each(function() {
						var thisValue = $(this).attr("ows_" + opt.sourceColumn);
						var thisValueTest = opt.ignoreCase ? $(this).attr("ows_" + opt.sourceColumn).toUpperCase() : $(this).attr("ows_" + opt.sourceColumn);
						// Make sure we have a match...
						if(opt.filterType === "Contains") {
							var firstMatch = thisValueTest.indexOf(testValue);
							if((firstMatch >= 0) &&
								// ...and that the match is not already in the array if we want uniqueness
								(!opt.uniqueVals || ($.inArray(thisValue, matchArray) === -1))) {
								matchArray.push($(this).attr("ows_" + opt.sourceColumn));
							}
						} else {
							// Handles normal case, which is BeginsWith and and other unknown values
							if(testValue === thisValueTest.substr(0,testValue.length) &&
									// ...and that the match is not already in the array if we want uniqueness
									(!opt.uniqueVals || ($.inArray(thisValue, matchArray) === -1))) {
								matchArray.push($(this).attr("ows_" + opt.sourceColumn));
							}
						}
					});
				}
			});

			// Build out the set of list elements to contain the available values
			var out = "";
			for (i=0; i < matchArray.length; i++) {
				// If a highlightClass has been supplied, wrap a span around each match
				if(opt.highlightClass.length > 0) {
					// Set up Regex based on whether we want to ignore case
					var thisRegex = RegExp(columnValue, opt.ignoreCase ? "gi" : "g");
					// Look for all occurrences
					var matches = matchArray[i].match(thisRegex);
					var startLoc = 0;
					// Loop for each occurrence, wrapping each in a span with the highlightClass CSS class
					for (matchNum=0; matchNum < matches.length; matchNum++) {
						var thisPos = matchArray[i].indexOf(matches[matchNum], startLoc);
						var endPos = thisPos + matches[matchNum].length;
						var thisSpan = "<span class='" + opt.highlightClass + "'>" + matches[matchNum] + "</span>";
						matchArray[i] = matchArray[i].substr(0, thisPos) + thisSpan + matchArray[i].substr(endPos);
						startLoc = thisPos + thisSpan.length;
					}
				}
				// Add the value to the markup for the container
				out += "<li style='display: block;position: relative;cursor: pointer;'>" + matchArray[i] + "</li>";
			}
			
			// Add all the list elements to the containerId container
			$("#" + containerId).html(out);
			// Set up hehavior for the available values in the list element
			$("#" + containerId + " li").click(function () {
				$("#" + containerId).fadeOut(opt.slideUpSpeed);
				$("#" + columnObjId).val($(this).text());
			}).mouseover(function () {
				var mouseoverCss = {
					"cursor": "hand",
					"color": "#ffffff",
					"background": "#3399ff"
				};
				$(this).css(mouseoverCss);
			}).mouseout(function () {
				var mouseoutCss = {
					"cursor": "inherit",
					"color": columnObjColor,
					"background": "transparent"
				};
				$(this).css(mouseoutCss);
			});

			// If we've got some values to show, then show 'em!
			if(matchArray.length > 0) {
				$("#" + containerId).slideDown(opt.slideDownSpeed);
			}
			// Remove the processing indicator
			columnObj.css("background-image", "");
		});

	}; // End $.fn.SPServices.SPAutocomplete

	// Get the Query String parameters and their values and return in an array
	$.fn.SPServices.SPGetQueryString = function () {

		var i;
		var queryStringVals = {};

		var qs = location.search.substring(1, location.search.length);
		var args = qs.split("&");
		var rxQS = /^([^=]+)=(.*)/i;

		for (i=0; i < args.length; i++) {
			matches = rxQS.exec(args[i]);
			if (rxQS.test(location.href)) {
				if (matches !== null && matches.length > 2) {
					queryStringVals[matches[1]] = unescape(matches[2]).replace(/\+/g,' ');
				}
			}
		}
		return queryStringVals;

	}; // End $.fn.SPServices.SPGetQueryString

	// Get the current list's GUID (ID) from the current URL.  Use of this function only makes sense if we're in a list's context,
	// and we assume that we are calling it from an aspx page which is a form or view for the list.
	$.fn.SPServices.SPListNameFromUrl = function (options) {

		var opt = $.extend({}, {
			listName: ""		// [Optional] Pass in the name or GUID of a list if you are not in its context. e.g., on a Web Part pages in the Pages library
		}, options);

		// Has the name or GUID been passed in?
		if(opt.listName.length > 0) {
			thisList = opt.listName;
			return thisList;
		// Do we already know the current list?
		} else if(thisList.length > 0) {
			return thisList;
		}

		// Parse out the list's root URL from the current location or the passed url
		var thisPage = location.href;
		var thisPageBaseName = thisPage.substring(0, thisPage.indexOf(".aspx"));
		var listPath = decodeURIComponent(thisPageBaseName.substring(0, thisPageBaseName.lastIndexOf(SLASH) + 1)).toUpperCase();

		// Call GetListCollection and loop through the results to find a match with the list's URL to get the list's GUID
		$().SPServices({
			operation: "GetListCollection",
			async: false,
			completefunc: function(xData, Status) {
				$(xData.responseXML).find("List").each(function() {
					var defaultViewUrl = $(this).attr("DefaultViewUrl");
					var listCollList = defaultViewUrl.substring(0, defaultViewUrl.lastIndexOf(SLASH) + 1).toUpperCase();
					if(listPath.indexOf(listCollList) > 0) {
						thisList = $(this).attr("ID");
						return false;
					}
				});
			}
		});

		// Return the GUID (ID)
		return thisList;
	}; // End $.fn.SPServices.SPListNameFromUrl

	// SPUpdateMultipleListItems allows you to update multiple items in a list based upon some common characteristic or metadata criteria.
	$.fn.SPServices.SPUpdateMultipleListItems = function(options) {

		var opt = $.extend({}, {
			webURL: "",			// [Optional] URL of the target Web.  If not specified, the current Web is used.
			listName: "",		// The list to operate on.
			CAMLQuery: "",		// A CAML fragment specifying which items in the list will be selected and updated
			batchCmd: "Update",	// The operation to perform. By default, Update.
			valuepairs: [],		// Valuepairs for the update in the form [[fieldname1, fieldvalue1], [fieldname2, fieldvalue2]...]
			completefunc: null,	// Function to call on completion of rendering the change.
			debug: false		// If true, show error messages;if false, run silent
		}, options);

		var i;
		var itemsToUpdate = [];
		var documentsToUpdate = [];

		// Call GetListItems to find all of the items matching the CAMLQuery
		$().SPServices({
			operation: "GetListItems",
			async: false,
			webURL: opt.webURL,
			listName: opt.listName,
			CAMLQuery: opt.CAMLQuery,
			CAMLQueryOptions: "<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",
			completefunc: function(xData, Status) {
				$(xData.responseXML).SPFilterNode("z:row").each(function() {
					itemsToUpdate.push($(this).attr("ows_ID"));
					var fileRef = $(this).attr("ows_FileRef");
					fileRef = "/" + fileRef.substring(fileRef.indexOf(";#")+2);
					documentsToUpdate.push(fileRef);
				});
			}
		});

		var fieldNum;
		var batch = "<Batch OnError='Continue'>";
		for(i=0; i < itemsToUpdate.length; i++) {
			batch += "<Method ID='" + i + "' Cmd='" + opt.batchCmd + "'>";
			for (fieldNum=0; fieldNum < opt.valuepairs.length; fieldNum++) {
				batch += "<Field Name='" + opt.valuepairs[fieldNum][0] + "'>" + escapeColumnValue(opt.valuepairs[fieldNum][1]) + "</Field>";
			}
			batch += "<Field Name='ID'>" + itemsToUpdate[i] + "</Field>";
			if(documentsToUpdate[i].length > 0) {
				batch += "<Field Name='FileRef'>" + documentsToUpdate[i] + "</Field>";
			}
			batch += "</Method>";
		}
		batch += "</Batch>";

		// Call UpdateListItems to update all of the items matching the CAMLQuery
		$().SPServices({
			operation: "UpdateListItems",
			async: false,
			webURL: opt.webURL,
			listName: opt.listName,
			updates: batch,
			completefunc: function(xData, Status) {
				// If present, call completefunc when all else is done
				if(opt.completefunc !== null) {
					opt.completefunc(xData, Status);
				}
			}
		});

	}; // End $.fn.SPServices.SPUpdateMultipleListItems

	// This method for finding specific nodes in the returned XML was developed by Steve Workman. See his blog post
	// http://www.steveworkman.com/html5-2/javascript/2011/improving-javascript-xml-node-finding-performance-by-2000/
	// for performance details.
	$.fn.SPFilterNode = function(name) {
		return this.find('*').filter(function() {
			return this.nodeName === name;
		});
	}; // End $.fn.SPFilterNode


	// This function converts an XML node set to JSON
	// Initial implementation focuses only on GetListItems
	$.fn.SPXmlToJson = function(options) {

		var opt = $.extend({}, {
			mapping: {},			// columnName: mappedName: "mappedName", objectType: "objectType"
			includeAllAttrs: false, // If true, return all attributes, regardless whether they are in the mapping
			removeOws: true			// Specifically for GetListItems, if true, the leading ows_ will be stripped off the field name
		}, options);

		var colNum;
		var jsonObject = [];

		this.each(function() {
			var row = {};
			var colValue;
			var rowAttrs = this.attributes;

			// Bring back all mapped columns, even those with no value
			$.each(opt.mapping, function() { 
				row[this.mappedName] = ""; 
			});

			// Parse through the element's attributes
			for(attrNum = 0; attrNum < rowAttrs.length; attrNum++) {
				var thisAttrName = rowAttrs[attrNum].name;
				var thisMapping = opt.mapping[thisAttrName];
				var thisObjectName = thisMapping !== undefined ? thisMapping.mappedName : opt.removeOws ? thisAttrName.split("ows_")[1] : thisAttrName;
				var thisObjectType = thisMapping !== undefined ? thisMapping.objectType : undefined;
				if(opt.includeAllAttrs || thisMapping !== undefined) {
					row[thisObjectName] = attrToJson(rowAttrs[attrNum].value, thisObjectType);
				}
			}
			// Push this item into the JSON Object			
			jsonObject.push(row);

		});

		// Return the JSON object
		return jsonObject;

	}; // End $.fn.SPServices.SPXmlToJson


	function attrToJson(v, objectType) {

		switch (objectType) {
			case "DateTime":
			case "datetime": 							// For calculated columns, stored as datetime;#value
				// Dates have dashes instead of slashes: ows_Created="2009-08-25 14:24:48"
				colValue = dateToJsonObject(v);
				break;
			case "User":
				colValue = userToJsonObject(v);
				break;
			case "UserMulti":
				colValue = userMultiToJsonObject(v);
				break;
			case "Lookup":
				colValue = lookupToJsonObject(v);
				break;
			case "LookupMulti":
				colValue = lookupMultiToJsonObject(v);
				break;
			case "Boolean":
				colValue = booleanToJsonObject(v);
				break;
			case "Integer":
				colValue = intToJsonObject(v);
				break;
			case "Counter":
				colValue = intToJsonObject(v);
				break;
			case "MultiChoice":
				colValue = choiceMultiToJsonObject(v);
				break;
			case "Currency":
			case "float":							// For calculated columns, stored as float;#value
				colValue = floatToJsonObject(v);
				break;
			case "Calc":
				colValue = calcToJsonObject(v);
				break;
			default:
				// All other objectTypes will be simple strings
				colValue = stringToJsonObject(v);
				break;
		}
		return colValue;
	}

	function stringToJsonObject(s) {
		return s;
	}
	function intToJsonObject(s) {
		return parseInt(s, 10);
	}
	function floatToJsonObject(s) {
		return parseFloat(s);
	}
	function booleanToJsonObject(s) {
		var out = s === "0" ? false : true;
		return out;
	}
	function dateToJsonObject(s) {
		return new Date(s.replace(/-/g, "/"));
	}
   function userToJsonObject(s) {
        if (s.length === 0) {
			return null;
        } else {
            var thisUser = s.split(";#"); 
            var thisUserExpanded = thisUser[1].split(",#");
            if(thisUserExpanded.length == 1) {
                return {userId: thisUser[0], userName: thisUser[1]};
            } else {
                return {
					userId: thisUser[0], 
					userName: thisUserExpanded[0].replace( /(,,)/g, ","), 
					loginName: thisUserExpanded[1].replace( /(,,)/g, ","), 
					email: thisUserExpanded[2].replace( /(,,)/g, ","), 
					sipAddress: thisUserExpanded[3].replace( /(,,)/g, ","), 
					title: thisUserExpanded[4].replace( /(,,)/g, ",")
				};
            }
        }
    }
	function userMultiToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisUserMultiObject = [];
			var thisUserMulti = s.split(";#");
			for(i=0; i < thisUserMulti.length; i=i+2) {
				var thisUser = userToJsonObject(thisUserMulti[i] + ";#" + thisUserMulti[i+1]);
				thisUserMultiObject.push(thisUser);
			}
			return thisUserMultiObject;
		}
	}
	function lookupToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisLookup = s.split(";#");
			return {lookupId: thisLookup[0], lookupValue: thisLookup[1]};
		}
	}
	function lookupMultiToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisLookupMultiObject = [];
			var thisLookupMulti = s.split(";#");
			for(i=0; i < thisLookupMulti.length; i=i+2) {
				var thisLookup = lookupToJsonObject(thisLookupMulti[i] + ";#" + thisLookupMulti[i+1]);
				thisLookupMultiObject.push(thisLookup);
			}
			return thisLookupMultiObject;
		}
	}
	function choiceMultiToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisChoiceMultiObject = [];
			var thisChoiceMulti = s.split(";#");
			for(i=0; i < thisChoiceMulti.length; i++) {
				if(thisChoiceMulti[i].length !== 0) {
					thisChoiceMultiObject.push(thisChoiceMulti[i]);
				}
			}
			return thisChoiceMultiObject;
		}
	}
	function calcToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisCalc = s.split(";#");
			// The first value will be the calculated column value type, the second will be the value
			return attrToJson(thisCalc[1], thisCalc[0]);
		}
	}

	// Find a People Picker in the page
	// Returns references to:
	//   row - The TR which contains the People Picker (useful if you'd like to hide it at some point)
	//   contents - The element which contains the current value
	//   currentValue - The current value if it is set
	//   checkNames - The Check Names image (in case you'd like to click it at some point)
	$.fn.SPFindPeoplePicker = function(options) {

		var opt = $.extend({}, {
			peoplePickerDisplayName: "",	// The displayName of the People Picker on the form
			valueToSet: "",					// The value to set the People Picker to. Should be a string containing each username or groupname separated by semi-colons.
			checkNames: true				// If set to true, the Check Names image will be clicked to resolve the names
		}, options);

		var thisRow = $("nobr").filter(function() {
			// Ensures we get a match whether or not the People Picker is required (if required, the nobr contains a span also)
			return $(this).contents().eq(0).text() === opt.peoplePickerDisplayName;	
		}).closest("tr");

		var thisContents = thisRow.find("div[name='upLevelDiv']");
		var thisCheckNames = thisRow.find("img[Title='Check Names']:first");

		// If a value was provided, set the value
		if(opt.valueToSet.length > 0) {
			thisContents.html(opt.valueToSet);
		}

		// If checkName is true, click the check names icon
		if(opt.checkNames) {
			thisCheckNames.click();
		}
		var thisCurrentValue = $.trim(thisContents.text());

		// Parse the entity data
		var dictionaryEntries = [];

		// IE
		thisContents.children("span").each(function() {
		
			// Grab the entity data
			var thisData = $(this).find("div[data]").attr("data");

			var dictionaryEntry = {};

			// Entity data is only available in IE
			if(thisData != undefined) {
				var arrayOfDictionaryEntry = $.parseXML(thisData);
				$xml = $(arrayOfDictionaryEntry);

				$xml.find("DictionaryEntry").each(function() {
					var key = $(this).find("Key").text();
					var value = $(this).find("Value").text();
					dictionaryEntry[key] = value;
				});
				dictionaryEntries.push(dictionaryEntry);
			// For other browsers, we'll call GetUserInfo to get the data
			} else {
				$().SPServices({
					operation: "GetUserInfo",
					async: false,
					cacheXML: true,
					userLoginName: $(this).attr("title"),
					completefunc: function(xData, Status) {

						$(xData.responseXML).find("User").each(function() {
						
							$.each(this.attributes, function(i, attrib){ 
								var key = attrib.name; 
								var value = attrib.value; 
								dictionaryEntry[key] = value;
							});						
							dictionaryEntries.push(dictionaryEntry);
						});
					}
				});
			}	
		});
	
		return {row: thisRow, contents: thisContents, currentValue: thisCurrentValue, checkNames: thisCheckNames, dictionaryEntries: dictionaryEntries};
	};

	// Return the current version of SPServices as a string
	$.fn.SPServices.Version = function () {

		return VERSION;

	}; // End $.fn.SPServices.Version



////// PRIVATE FUNCTIONS ////////

	// Display a column (field) formatted correctly based on its definition in the list.
	// NOTE: Currently not dealing with locale differences.
	//   columnXML			The XML node for the column from a GetList operation
	//   columnValue		The text representation of the column's value
	//   opt				The current set of options
	function showColumn(listXML, columnXML, columnValue, opt) {

		if(typeof columnValue === 'undefined') {
			return "";
		}

		var i;
		var outString = "";
		var dispUrl;
		var numDecimals;
		var outArray =[];
		var webUrl = opt.relatedWebURL.length > 0 ? opt.relatedWebURL : $().SPServices.SPGetCurrentSite();

		switch(columnXML.attr("Type")) {
			case "Text":
				outString = columnValue;
				break;
			case "URL":
				switch(columnXML.attr("Format")) {
					// URL as hyperlink
					case "Hyperlink":
						outString = "<a href='" + columnValue.substring(0, columnValue.search(",")) + "'>" +
							columnValue.substring(columnValue.search(",") + 1) + "</a>";
						break;
					// URL as image
					case "Image":
						outString = "<img alt='" + columnValue.substring(columnValue.search(",") + 1) +
							"' src='" + columnValue.substring(0, columnValue.search(",")) + "'/>";
						break;
					// Just in case
					default:
						outString = columnValue;
						break;						
				}
				break;
			case "User":
			case "UserMulti":
				var userMultiValues = columnValue.split(";#");
				for(i=0; i < userMultiValues.length; i = i+2) {
					outArray.push("<a href='/_layouts/userdisp.aspx?ID=" + userMultiValues[i] +
						"&Source=" + escapeUrl(location.href) + "'>" +
						userMultiValues[i+1] +  "</a>");
				}
				outString = outArray.join(", ");
				break;
			case "Calculated":
				var calcColumn = columnValue.split(";#");
				outString = calcColumn[1];
				break;
			case "Number":
				numDecimals = columnXML.attr("Decimals");
				outString = numDecimals === undefined ?
					parseFloat(columnValue).toString() :
					parseFloat(columnValue).toFixed(numDecimals).toString();
				break;
			case "Currency":
				numDecimals = columnXML.attr("Decimals");
				outString = numDecimals === undefined ?
					parseFloat(columnValue).toFixed(2).toString() :
					parseFloat(columnValue).toFixed(numDecimals).toString();
				break;
			case "Lookup":
				switch(columnXML.attr("Name")) {
					case "FileRef":
						// Get the display form URL for the lookup source list
						dispUrl = listXML.attr("BaseType") === "1" ? listXML.attr("RootFolder") + SLASH + "Forms/DispForm.aspx" :
							listXML.attr("RootFolder") + SLASH + "DispForm.aspx";
						outString = "<a href='" + dispUrl +
							"?ID=" + columnValue.substring(0, columnValue.search(";#")) + "&RootFolder=*&Source=" + escapeUrl(location.href) + "'>" +
							columnValue.substring(columnValue.search(";#") + 2) + "</a>";
						break;
					case "FileDirRef":
						// Get the display form URL for the lookup source list
						dispUrl = SLASH + columnValue.substring(columnValue.search(";#") + 2);
						outString = "<a href='" + dispUrl + "'>" +
							columnValue.substring(columnValue.search(";#") + 2) + "</a>";
						break;
					// Any other lookup column
					default:
						// Get the display form URL for the lookup source list
						dispUrl = getListFormUrl(columnXML.attr("List"), "DisplayForm");
						outString = "<a href='" + opt.relatedWebURL + SLASH + dispUrl +
							"?ID=" + columnValue.substring(0, columnValue.search(";#")) + "&RootFolder=*&Source=" + escapeUrl(location.href) + "'>" +
							columnValue.substring(columnValue.search(";#") + 2) + "</a>";
						break;						
				}
				break;
			case "LookupMulti":
				// Get the display form URL for the lookup source list
				dispUrl = getListFormUrl(columnXML.attr("List"), "DisplayForm");
				// Show all the values as links to the items, separated by commas
				outString = "";
				if(columnValue.length > 0) {
					var lookupMultiValues = columnValue.split(";#");
					for(i=0; i < lookupMultiValues.length / 2; i++) {
						outArray.push("<a href='" + webUrl + SLASH + dispUrl +
							"?ID=" + lookupMultiValues[i * 2] + "&RootFolder=*&Source=" + escapeUrl(location.href) + "'>" +
							lookupMultiValues[(i * 2) + 1] + "</a>");
					}
				}
				outString = outArray.join(", ");
				break;
			case "File":
				fileName = columnValue.substring(columnValue.search(";#") + 2);
				outString = "<a href='" + listXML.attr("RootFolder") + SLASH + fileName + "'>" + fileName + "</a>";
				break;
			case "Counter":
				outString = columnValue;
				break;
			case "DateTime":
				outString = columnValue;
				break;
			default:
				outString = columnValue;
				break;
		}
		return outString;
	} // End of function showColumn

	// Show a single attribute of a node, enclosed in a table
	//   node				The XML node
	//   opt				The current set of options
	function showAttrs(node, opt) {
		var i;
		var out = "<table class='ms-vb' width='100%'>";
		for (i=0; i < node.attributes.length; i++) {
			out += "<tr><td width='10px' style='font-weight:bold;'>" + i + "</td><td width='100px'>" +
				node.attributes.item(i).nodeName + "</td><td>" + checkLink(node.attributes.item(i).nodeValue) + "</td></tr>";
		}
		out += "</table>";
		return out;
	} // End of function showAttrs

	// Find a dropdown (or multi-select) in the DOM. Returns the dropdown onject and its type:
	// S = Simple (select);C = Compound (input + select hybrid);M = Multi-select (select hybrid)
	function DropdownCtl(colName) {
		// Simple
		if((this.Obj = $("select[Title='" + colName + "']")).length === 1) {
			this.Type = "S";
		// Compound
		} else if((this.Obj = $("input[Title='" + colName + "']")).length === 1) {
			this.Type = "C";
		// Multi-select: This will find the multi-select column control in English and most other languages sites where the Title looks like 'Column Name possible values'
		} else if((this.Obj = $("select[ID$='SelectCandidate'][Title^='" + colName + " ']")).length === 1) {
			this.Type = "M";
		// Multi-select: This will find the multi-select column control on a Russian site (and perhaps others) where the Title looks like 'Выбранных значений: Column Name'
		} else if((this.Obj = $("select[ID$='SelectCandidate'][Title$=': " + colName + "']")).length === 1) {
			this.Type = "M";
		// Multi-select: This will find the multi-select column control on a German site (and perhaps others) where the Title looks like 'Mögliche Werte für &quot;Column name&quot;.'
		} else if((this.Obj = $("select[ID$='SelectCandidate'][Title$='\"" + colName + "\".']")).length === 1) {
			this.Type = "M";
		// Multi-select: This will find the multi-select column control on a Italian site (and perhaps others) where the Title looks like "Valori possibili Column name"
		} else if((this.Obj = $("select[ID$='SelectCandidate'][Title$=' " + colName + "']")).length === 1) {
			this.Type = "M";
		} else {
			this.Type = null;
		}
	} // End of function DropdownCtl

	// Returns the selected value(s) for a dropdown in an array. Expects a dropdown object as returned by the DropdownCtl function.
	// If matchOnId is true, returns the ids rather than the text values for the selection options(s).
	function getDropdownSelected(columnSelect, matchOnId) {

		var columnSelectSelected = [];
		
		switch(columnSelect.Type) {
			case "S":
				if(matchOnId) {
					columnSelectSelected.push(columnSelect.Obj.find("option:selected").val() || []);
				} else {
					columnSelectSelected.push(columnSelect.Obj.find("option:selected").text() || []);
				}
				break;
			case "C":
				if(matchOnId) {
					columnSelectSelected.push($("input[id='"+ columnSelect.Obj.attr("optHid") + "']").val() || []);
				} else {
					columnSelectSelected.push(columnSelect.Obj.attr("value") || []);
				}				
				break;
			case "M":
				var columnSelections = columnSelect.Obj.closest("span").find("select[ID$='SelectResult']");
				$(columnSelections).find("option").each(function() {
					columnSelectSelected.push($(this).html());
				});
				break;
			default:
				break;
		}
		return columnSelectSelected;

	} // End of function getDropdownSelected
	
	// Build an error message based on passed parameters
	function errBox(func, param, msg) {
		var errMsg = "<b>Error in function</b><br/>" + func + "<br/>" +
			"<b>Parameter</b><br/>" + param + "<br/>" +
			"<b>Message</b><br/>" + msg + "<br/><br/>" +
			"<span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";
		modalBox(errMsg);
	} // End of function errBox

	// Call this function to pop up a branded modal msgBox
	function modalBox(msg) {
		var boxCSS = "position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";
		$("#aspnetForm").parent().append("<div id='SPServices_msgBox' style=" + boxCSS + ">" + msg);
		var height = $("#SPServices_msgBox").height();
		var width = $("#SPServices_msgBox").width();
		var leftVal = ($(window).width() / 2) - (width / 2) + "px";
		var topVal = ($(window).height() / 2) - (height / 2) - 100 + "px";
		$("#SPServices_msgBox").css({border:'5px #C02000 solid', left:leftVal, top:topVal}).show().fadeTo("slow", 0.75).click(function () {
			$(this).fadeOut("3000", function () {
				$(this).remove();
			});
		});
	} // End of function modalBox

	// Generate a unique id for a containing div using the function name and the column display name
	function genContainerId(funcname, columnName) {
		return funcname + "_" + $().SPServices.SPGetStaticFromDisplay({
			listName: $().SPServices.SPListNameFromUrl(),
			columnDisplayName: columnName
		});
	} // End of function genContainerId
	
	// Get the URL for a specified form for a list
	function getListFormUrl(l, f) {

		var thisForm, u;

		$().SPServices({
			operation: "GetFormCollection",
			async: false,
			listName: l,
			completefunc: function (xData, Status) {
				u = $(xData.responseXML).find("Form[Type='" + f + "']").attr("Url");;
			}
		});
		return u;

	} // End of function getListFormUrl

	// Add the option values to the SOAPEnvelope.payload for the operation
	//	opt = options for the call
	//	paramArray = an array of option names to add to the payload
	//		"paramName" if the parameter name and the option name match
	//		["paramName", "optionName"] if the parameter name and the option name are different (this handles early "wrappings" with inconsistent naming)
	function addToPayload(opt, paramArray) {

		var i;

		for (i=0; i < paramArray.length; i++) {
			// the parameter name and the option name match
			if(typeof paramArray[i] === "string") {
				SOAPEnvelope.payload += wrapNode(paramArray[i], opt[paramArray[i]]);
			// the parameter name and the option name are different 
			} else if(paramArray[i].length === 2) {
				SOAPEnvelope.payload += wrapNode(paramArray[i][0], opt[paramArray[i][1]]);
			// something isn't right, so report it
			} else {
				errBox(opt.operation, "paramArray[" + i + "]: " + paramArray[i], "Invalid paramArray element passed to addToPayload()");
			}
		}
	} // End of function addToPayload

	// Finds the td which contains a form field in default forms using the comment which contains:
	//   <!--  FieldName="Title"
	//		 FieldInternalName="Title"
	//		 FieldType="SPFieldText"
	//	   -->
	// as the "anchor" to find it. Necessary because SharePoint doesn't give all field types ids or specific classes.
	function findFormField(columnName) {
		var thisFormBody;
		// There's no easy way to find one of these columns; we'll look for the comment with the columnName
		var searchText = RegExp("FieldName=\"" + columnName.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&") + "\"", "gi");
		// Loop through all of the ms-formbody table cells
		$("td.ms-formbody, td.ms-formbodysurvey").each(function() {
			// Check for the right comment
			if(searchText.test($(this).html())) {
				thisFormBody = $(this);
				// Found it, so we're done
				return false;
			}
		});
		return thisFormBody;
	} // End of function findFormField
	
	// The SiteData operations have the same names as other Web Service operations. To make them easy to call and unique, I'm using
	// the SiteData prefix on their names. This function replaces that name with the right name in the SOAPEnvelope.
	function siteDataFixSOAPEnvelope(SOAPEnvelope, siteDataOperation) {
		var siteDataOp = siteDataOperation.substring(8);
		SOAPEnvelope.opheader = SOAPEnvelope.opheader.replace(siteDataOperation, siteDataOp);
		SOAPEnvelope.opfooter = SOAPEnvelope.opfooter.replace(siteDataOperation, siteDataOp);
		return SOAPEnvelope;
	} // End of function siteDataFixSOAPEnvelope

	// Wrap an XML node (n) around a value (v)
	function wrapNode(n, v) {
		var thisValue = v !== undefined ? v : "";
		return "<" + n + ">" + thisValue + "</" + n + ">";
	}

	// Generate a random number for sorting arrays randomly
	function randOrd() {
		return (Math.round(Math.random())-0.5);
	}

	// If a string is a URL, format it as a link, else return the string as-is
	function checkLink(s) {
		return ((s.indexOf("http") === 0) || (s.indexOf(SLASH) === 0)) ? "<a href='" + s + "'>" + s + "</a>" : s;
	}

	// Get the filename from the full URL
	function fileName(s) {
		return s.substring(s.lastIndexOf(SLASH)+1,s.length);
	}

	// Escape string characters
	function escapeHTML(s) {
		return s.replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
	}

	// Escape column values
	function escapeColumnValue(s) {
		if(typeof s === "string") {
			return s.replace(/&(?![a-zA-Z]{1,8};)/g, "&amp;");
		} else {
			return s;
		}
	}

	// Escape Url
	function escapeUrl(u) {
		return u.replace(/&/g,'%26');
	}

})(jQuery);        1 x      20240222211730-8l1 gIS   https://www.ginniemae.gov/Style%20Library/GNMA%20Scripts/jquery.SPServices-0.7.2.js      Ƃ /*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 0.7.2 -> Note to Marc: Also change var VERSION below.
 * @requires jQuery v1.4.2 or greater - jQuery 1.7+ recommended
 *
 * Copyright (c) 2009-2012 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */

(function ($) {

	// Version info
	var VERSION					= "0.7.2";

	// String constants
	//   General
	var SLASH					= "/";
	var TXTColumnNotFound		= "Column not found on page";
	var SCHEMASharePoint		= "http://schemas.microsoft.com/sharepoint";

	//   Web Service names
	var ALERTS					= "Alerts";
	var AUTHENTICATION			= "Authentication";
	var COPY					= "Copy";
	var FORMS					= "Forms";
	var LISTS					= "Lists";
	var MEETINGS				= "Meetings";
	var PEOPLE					= "People";
	var PERMISSIONS				= "Permissions";
	var PUBLISHEDLINKSSERVICE	= "PublishedLinksService";
	var SEARCH					= "Search";
	var SHAREPOINTDIAGNOSTICS	= "SharePointDiagnostics";
	var SITEDATA				= "SiteData";
	var SITES					= "Sites";
	var SOCIALDATASERVICE		= "SocialDataService";
	var SPELLCHECK				= "SpellCheck";
    var TAXONOMYSERVICE			= "TaxonomyClientService";
	var USERGROUP				= "usergroup";
	var USERPROFILESERVICE		= "UserProfileService";
	var VERSIONS				= "Versions";
	var VIEWS					= "Views";
	var WEBPARTPAGES			= "WebPartPages";
	var WEBS					= "Webs";
	var WORKFLOW				= "Workflow";

	// Global variables
	var thisSite = "";		// The current site
	var thisList = "";		// The current list when in a list context
	var i = 0;				// Generic loop counter
	var t = "";				// Temporary string variable

	// Array to store Web Service information
	//	WSops.OpName = [WebService, needs_SOAPAction];
	//		OpName				The name of the Web Service operation -> These names are unique
	//		WebService			The name of the WebService this operation belongs to
	//		needs_SOAPAction	Boolean indicating whether the operatio needs to have the SOAPAction passed in the setRequestHeaderfunction.
	//							true if the operation does a write, else false

	var WSops = [];

	WSops.GetAlerts									= [ALERTS, false];
	WSops.DeleteAlerts								= [ALERTS, true];

	WSops.Mode										= [AUTHENTICATION, false];
	WSops.Login										= [AUTHENTICATION, false];

	WSops.CopyIntoItems								= [COPY, true];
	WSops.CopyIntoItemsLocal						= [COPY, true];
	WSops.GetItem									= [COPY, false];

	WSops.GetForm									= [FORMS, false];
	WSops.GetFormCollection							= [FORMS, false];

	WSops.AddAttachment								= [LISTS, true];
	WSops.AddDiscussionBoardItem					= [LISTS, true];
	WSops.AddList									= [LISTS, true];
	WSops.AddListFromFeature						= [LISTS, true];
	WSops.ApplyContentTypeToList					= [LISTS, true];
	WSops.CheckInFile								= [LISTS, true];
	WSops.CheckOutFile								= [LISTS, true];
	WSops.CreateContentType							= [LISTS, true];
	WSops.DeleteAttachment							= [LISTS, true];
	WSops.DeleteContentType							= [LISTS, true];
	WSops.DeleteContentTypeXmlDocument				= [LISTS, true];
	WSops.DeleteList								= [LISTS, true];
	WSops.GetAttachmentCollection					= [LISTS, false];
	WSops.GetList									= [LISTS, false];
	WSops.GetListAndView							= [LISTS, false];
	WSops.GetListCollection							= [LISTS, false];
	WSops.GetListContentType						= [LISTS, false];
	WSops.GetListContentTypes						= [LISTS, false];
	WSops.GetListItemChanges						= [LISTS, false];
	WSops.GetListItemChangesSinceToken				= [LISTS, false];
	WSops.GetListItems								= [LISTS, false];
	WSops.GetVersionCollection						= [LISTS, false];
	WSops.UndoCheckOut								= [LISTS, true];
	WSops.UpdateContentType							= [LISTS, true];
	WSops.UpdateContentTypesXmlDocument				= [LISTS, true];
	WSops.UpdateContentTypeXmlDocument				= [LISTS, true];
	WSops.UpdateList								= [LISTS, true];
	WSops.UpdateListItems							= [LISTS, true];

	WSops.AddMeeting								= [MEETINGS, true];
	WSops.CreateWorkspace							= [MEETINGS, true];
	WSops.RemoveMeeting								= [MEETINGS, true];
	WSops.SetWorkSpaceTitle							= [MEETINGS, true];

	WSops.ResolvePrincipals							= [PEOPLE, false];
	WSops.SearchPrincipals							= [PEOPLE, false];

	WSops.AddPermission								= [PERMISSIONS, true];
	WSops.AddPermissionCollection					= [PERMISSIONS, true];
	WSops.GetPermissionCollection					= [PERMISSIONS, true];
	WSops.RemovePermission							= [PERMISSIONS, true];
	WSops.RemovePermissionCollection				= [PERMISSIONS, true];
	WSops.UpdatePermission							= [PERMISSIONS, true];

	WSops.GetLinks									= [PUBLISHEDLINKSSERVICE, true];

	WSops.GetPortalSearchInfo						= [SEARCH, false];
	WSops.GetQuerySuggestions						= [SEARCH, false];
	WSops.GetSearchMetadata							= [SEARCH, false];
	WSops.Query										= [SEARCH, false];
	WSops.QueryEx									= [SEARCH, false];
	WSops.Registration								= [SEARCH, false];
	WSops.Status									= [SEARCH, false];

	WSops.SendClientScriptErrorReport				= [SHAREPOINTDIAGNOSTICS,true];

	WSops.GetAttachments							= [SITEDATA, false];
	WSops.EnumerateFolder							= [SITEDATA, false];
	WSops.SiteDataGetList							= [SITEDATA, false];
	WSops.SiteDataGetListCollection					= [SITEDATA, false];
	WSops.SiteDataGetSite							= [SITEDATA, false];
	WSops.SiteDataGetSiteUrl						= [SITEDATA, false];
	WSops.SiteDataGetWeb							= [SITEDATA, false];

	WSops.CreateWeb									= [SITES, true];
	WSops.DeleteWeb									= [SITES, false];
	WSops.GetSite									= [SITES, false];
	WSops.GetSiteTemplates							= [SITES, false];

	WSops.AddComment								= [SOCIALDATASERVICE, true];
	WSops.AddTag									= [SOCIALDATASERVICE, true];
	WSops.AddTagByKeyword							= [SOCIALDATASERVICE, true];
	WSops.CountCommentsOfUser						= [SOCIALDATASERVICE, false];
	WSops.CountCommentsOfUserOnUrl					= [SOCIALDATASERVICE, false];
	WSops.CountCommentsOnUrl						= [SOCIALDATASERVICE, false];
	WSops.CountRatingsOnUrl							= [SOCIALDATASERVICE, false];
	WSops.CountTagsOfUser							= [SOCIALDATASERVICE, false];
	WSops.DeleteComment								= [SOCIALDATASERVICE, true];
	WSops.DeleteRating								= [SOCIALDATASERVICE, true];
	WSops.DeleteTag									= [SOCIALDATASERVICE, true];
	WSops.DeleteTagByKeyword						= [SOCIALDATASERVICE, true];
	WSops.DeleteTags								= [SOCIALDATASERVICE, true];
	WSops.GetAllTagTerms							= [SOCIALDATASERVICE, false];
	WSops.GetAllTagTermsForUrlFolder				= [SOCIALDATASERVICE, false];
	WSops.GetAllTagUrls								= [SOCIALDATASERVICE, false];
	WSops.GetAllTagUrlsByKeyword					= [SOCIALDATASERVICE, false];
	WSops.GetCommentsOfUser							= [SOCIALDATASERVICE, false];
	WSops.GetCommentsOfUserOnUrl					= [SOCIALDATASERVICE, false];
	WSops.GetCommentsOnUrl							= [SOCIALDATASERVICE, false];
	WSops.GetRatingAverageOnUrl						= [SOCIALDATASERVICE, false];
	WSops.GetRatingOfUserOnUrl						= [SOCIALDATASERVICE, false];
	WSops.GetRatingOnUrl							= [SOCIALDATASERVICE, false];
	WSops.GetRatingsOfUser							= [SOCIALDATASERVICE, false];
	WSops.GetRatingsOnUrl							= [SOCIALDATASERVICE, false];
	WSops.GetSocialDataForFullReplication			= [SOCIALDATASERVICE, false];
	WSops.GetTags									= [SOCIALDATASERVICE, true];
	WSops.GetTagsOfUser								= [SOCIALDATASERVICE, true];
	WSops.GetTagTerms								= [SOCIALDATASERVICE, true];
	WSops.GetTagTermsOfUser							= [SOCIALDATASERVICE, true];
	WSops.GetTagTermsOnUrl							= [SOCIALDATASERVICE, true];
	WSops.GetTagUrlsOfUser							= [SOCIALDATASERVICE, true];
	WSops.GetTagUrlsOfUserByKeyword					= [SOCIALDATASERVICE, true];
	WSops.GetTagUrls								= [SOCIALDATASERVICE, true];
	WSops.GetTagUrlsByKeyword						= [SOCIALDATASERVICE, true];
	WSops.SetRating									= [SOCIALDATASERVICE, true];
	WSops.UpdateComment								= [SOCIALDATASERVICE, true];

	WSops.SpellCheck								= [SPELLCHECK, false];

    // Taxonomy Service Calls
    // Updated 2011.01.27 by Thomas McMillan
    WSops.AddTerms									= [TAXONOMYSERVICE, true];
    WSops.GetChildTermsInTerm						= [TAXONOMYSERVICE, false];
    WSops.GetChildTermsInTermSet					= [TAXONOMYSERVICE, false];
    WSops.GetKeywordTermsByGuids					= [TAXONOMYSERVICE, false];
    WSops.GetTermsByLabel							= [TAXONOMYSERVICE, false];
    WSops.GetTermSets								= [TAXONOMYSERVICE, false];

	WSops.AddGroup									= [USERGROUP, true];
	WSops.AddGroupToRole							= [USERGROUP, true];
	WSops.AddRole									= [USERGROUP, true];
	WSops.AddRoleDef								= [USERGROUP, true];
	WSops.AddUserCollectionToGroup					= [USERGROUP, true];
	WSops.AddUserCollectionToRole					= [USERGROUP, true];
	WSops.AddUserToGroup							= [USERGROUP, true];
	WSops.AddUserToRole								= [USERGROUP, true];
	WSops.GetAllUserCollectionFromWeb				= [USERGROUP, false];
	WSops.GetGroupCollection						= [USERGROUP, false];
	WSops.GetGroupCollectionFromRole				= [USERGROUP, false];
	WSops.GetGroupCollectionFromSite				= [USERGROUP, false];
	WSops.GetGroupCollectionFromUser				= [USERGROUP, false];
	WSops.GetGroupCollectionFromWeb					= [USERGROUP, false];
	WSops.GetGroupInfo								= [USERGROUP, false];
	WSops.GetRoleCollection							= [USERGROUP, false];
	WSops.GetRoleCollectionFromGroup				= [USERGROUP, false];
	WSops.GetRoleCollectionFromUser					= [USERGROUP, false];
	WSops.GetRoleCollectionFromWeb					= [USERGROUP, false];
	WSops.GetRoleInfo								= [USERGROUP, false];
	WSops.GetRolesAndPermissionsForCurrentUser		= [USERGROUP, false];
	WSops.GetRolesAndPermissionsForSite				= [USERGROUP, false];
	WSops.GetUserCollection							= [USERGROUP, false];
	WSops.GetUserCollectionFromGroup				= [USERGROUP, false];
	WSops.GetUserCollectionFromRole					= [USERGROUP, false];
	WSops.GetUserCollectionFromSite					= [USERGROUP, false];
	WSops.GetUserCollectionFromWeb					= [USERGROUP, false];
	WSops.GetUserInfo								= [USERGROUP, false];
	WSops.GetUserLoginFromEmail						= [USERGROUP, false];
	WSops.RemoveGroup								= [USERGROUP, true];
	WSops.RemoveGroupFromRole						= [USERGROUP, true];
	WSops.RemoveRole								= [USERGROUP, true];
	WSops.RemoveUserCollectionFromGroup				= [USERGROUP, true];
	WSops.RemoveUserCollectionFromRole				= [USERGROUP, true];
	WSops.RemoveUserCollectionFromSite				= [USERGROUP, true];
	WSops.RemoveUserFromGroup						= [USERGROUP, true];
	WSops.RemoveUserFromRole						= [USERGROUP, true];
	WSops.RemoveUserFromSite						= [USERGROUP, true];
	WSops.RemoveUserFromWeb							= [USERGROUP, true];
	WSops.UpdateGroupInfo							= [USERGROUP, true];
	WSops.UpdateRoleDefInfo							= [USERGROUP, true];
	WSops.UpdateRoleInfo							= [USERGROUP, true];
	WSops.UpdateUserInfo							= [USERGROUP, true];

	WSops.AddColleague								= [USERPROFILESERVICE, true]; 
	WSops.AddLink									= [USERPROFILESERVICE, true];
	WSops.AddMembership								= [USERPROFILESERVICE, true]; 
	WSops.AddPinnedLink								= [USERPROFILESERVICE, true];
	WSops.CreateMemberGroup							= [USERPROFILESERVICE, true]; 
	WSops.CreateUserProfileByAccountName			= [USERPROFILESERVICE, true];
	WSops.GetCommonColleagues						= [USERPROFILESERVICE, false];
	WSops.GetCommonManager							= [USERPROFILESERVICE, false];
	WSops.GetCommonMemberships						= [USERPROFILESERVICE, false];
	WSops.GetInCommon								= [USERPROFILESERVICE, false];
	WSops.GetPropertyChoiceList						= [USERPROFILESERVICE, false];
	WSops.GetUserColleagues							= [USERPROFILESERVICE, false];
	WSops.GetUserLinks								= [USERPROFILESERVICE, false];
	WSops.GetUserMemberships						= [USERPROFILESERVICE, false];
	WSops.GetUserPinnedLinks						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileByGuid						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileByIndex						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileByName						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileCount						= [USERPROFILESERVICE, false];
	WSops.GetUserProfileSchema						= [USERPROFILESERVICE, false];
	WSops.ModifyUserPropertyByAccountName			= [USERPROFILESERVICE, true];
	WSops.RemoveAllColleagues						= [USERPROFILESERVICE, true];
	WSops.RemoveAllLinks							= [USERPROFILESERVICE, true];
	WSops.RemoveAllMemberships						= [USERPROFILESERVICE, true];
	WSops.RemoveAllPinnedLinks						= [USERPROFILESERVICE, true];
	WSops.RemoveColleague							= [USERPROFILESERVICE, true];
	WSops.RemoveLink								= [USERPROFILESERVICE, true];
	WSops.RemoveMembership							= [USERPROFILESERVICE, true];
	WSops.RemovePinnedLink							= [USERPROFILESERVICE, true]; 
	WSops.UpdateColleaguePrivacy					= [USERPROFILESERVICE, true];
	WSops.UpdateLink								= [USERPROFILESERVICE, true];
	WSops.UpdateMembershipPrivacy					= [USERPROFILESERVICE, true];
	WSops.UpdatePinnedLink							= [USERPROFILESERVICE, true];

	WSops.DeleteAllVersions							= [VERSIONS, true];
	WSops.DeleteVersion								= [VERSIONS, true];
	WSops.GetVersions								= [VERSIONS, false];
	WSops.RestoreVersion							= [VERSIONS, true];

	WSops.AddView									= [VIEWS, true];
	WSops.DeleteView								= [VIEWS, true];
	WSops.GetView									= [VIEWS, false];
	WSops.GetViewHtml								= [VIEWS, false];
	WSops.GetViewCollection							= [VIEWS, false];
	WSops.UpdateView								= [VIEWS, true];
	WSops.UpdateViewHtml							= [VIEWS, true];

	WSops.AddWebPart								= [WEBPARTPAGES, true];
	WSops.AddWebPartToZone							= [WEBPARTPAGES, true];
	WSops.GetWebPart2								= [WEBPARTPAGES, false];
	WSops.GetWebPartPage							= [WEBPARTPAGES, false];
	WSops.GetWebPartProperties						= [WEBPARTPAGES, false];
	WSops.GetWebPartProperties2						= [WEBPARTPAGES, false];

	WSops.CreateContentType							= [WEBS, true];
	WSops.GetColumns								= [WEBS, false];
	WSops.GetContentType							= [WEBS, false];
	WSops.GetContentTypes							= [WEBS, false];
	WSops.GetCustomizedPageStatus					= [WEBS, false];
	WSops.GetListTemplates							= [WEBS, false];
	WSops.GetObjectIdFromUrl						= [WEBS, false]; // 2010
	WSops.GetWeb									= [WEBS, false];
	WSops.GetWebCollection							= [WEBS, false];
	WSops.GetAllSubWebCollection					= [WEBS, false];
	WSops.UpdateColumns								= [WEBS, true];
	WSops.UpdateContentType							= [WEBS, true];
	WSops.WebUrlFromPageUrl							= [WEBS, false];

	WSops.AlterToDo									= [WORKFLOW, true];
	WSops.GetTemplatesForItem						= [WORKFLOW, false];
	WSops.GetToDosForItem							= [WORKFLOW, false];
	WSops.GetWorkflowDataForItem					= [WORKFLOW, false];
	WSops.GetWorkflowTaskData						= [WORKFLOW, false];
	WSops.StartWorkflow								= [WORKFLOW, true];

	// Set up SOAP envelope
	var SOAPEnvelope = {};
	SOAPEnvelope.header = "<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";
	SOAPEnvelope.footer = "</soap:Body></soap:Envelope>";
	SOAPEnvelope.payload = "";
	var SOAPAction;


	// Main function, which calls SharePoint's Web Services directly.
	$.fn.SPServices = function(options) {

		// If there are no options passed in, use the defaults.  Extend replaces each default with the passed option.
		var opt = $.extend({}, $.fn.SPServices.defaults, options);

		// Put together operation header and SOAPAction for the SOAP call based on which Web Service we're calling
		SOAPEnvelope.opheader = "<" + opt.operation + " ";
		switch(WSops[opt.operation][0]) {
			case ALERTS:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/2002/1/alerts/' >";
				SOAPAction = SCHEMASharePoint + "/soap/2002/1/alerts/";
				break;
			case MEETINGS:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/meetings/' >";
				SOAPAction = SCHEMASharePoint + "/soap/meetings/";
				break;
			case PERMISSIONS:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/directory/' >";
				SOAPAction = SCHEMASharePoint + "/soap/directory/";
				break;
			case PUBLISHEDLINKSSERVICE:
				SOAPEnvelope.opheader += "xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";
				SOAPAction = "http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";
				break;
			case SEARCH:
				SOAPEnvelope.opheader += "xmlns='urn:Microsoft.Search' >";
				SOAPAction = "urn:Microsoft.Search/";
				break;
			case SHAREPOINTDIAGNOSTICS:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/diagnostics/' >";
				SOAPAction = "http://schemas.microsoft.com/sharepoint/diagnostics/";
				break;
			case SOCIALDATASERVICE:
				SOAPEnvelope.opheader += "xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >";
				SOAPAction = "http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";
				break;
			case SPELLCHECK:
				SOAPEnvelope.opheader += "xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/'";
				SOAPAction = "http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";
				break;
            case TAXONOMYSERVICE:
                SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/taxonomy/soap/' >";
                SOAPAction = SCHEMASharePoint + "/taxonomy/soap/";
                break;
			case USERGROUP:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/directory/' >";
				SOAPAction = SCHEMASharePoint + "/soap/directory/";
				break;
			case USERPROFILESERVICE:
				SOAPEnvelope.opheader += "xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";
				SOAPAction = "http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";
				break;
			case WEBPARTPAGES:
				SOAPEnvelope.opheader += "xmlns='http://microsoft.com/sharepoint/webpartpages' >";
				SOAPAction = "http://microsoft.com/sharepoint/webpartpages/";
				break;
			case WORKFLOW:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/workflow/' >";
				SOAPAction = SCHEMASharePoint + "/soap/workflow/";
				break;
			default:
				SOAPEnvelope.opheader += "xmlns='" + SCHEMASharePoint + "/soap/'>";
				SOAPAction = SCHEMASharePoint + "/soap/";
				break;
		}
		
		// Add the operation to the SOAPAction and opfooter
		SOAPAction += opt.operation;
		SOAPEnvelope.opfooter = "</" + opt.operation + ">";

		// Build the URL for the Ajax call based on which operation we're calling
		// If the webURL has been provided, then use it, else use the current site
		var ajaxURL = "_vti_bin/" + WSops[opt.operation][0] + ".asmx";
		if(opt.webURL.charAt(opt.webURL.length - 1) === SLASH) {
			ajaxURL = opt.webURL + ajaxURL;
		} else if(opt.webURL.length > 0) {
			ajaxURL = opt.webURL + SLASH + ajaxURL;
		} else {
			ajaxURL = $().SPServices.SPGetCurrentSite() + SLASH + ajaxURL;
		}

		SOAPEnvelope.payload = "";
		// Each operation requires a different set of values.  This switch statement sets them up in the SOAPEnvelope.payload.
		switch(opt.operation) {
			// ALERT OPERATIONS
			case "GetAlerts":
				break;
			case "DeleteAlerts":
				SOAPEnvelope.payload += "<IDs>";
				for (i=0; i < opt.IDs.length; i++) {
					SOAPEnvelope.payload += wrapNode("string", opt.IDs[i]);
				}
				SOAPEnvelope.payload += "</IDs>";
				break;

			// AUTHENTICATION OPERATIONS
			case "Mode":
				break;
			case "Login":
				addToPayload(opt, ["username", "password"]);
				break;

			// COPY OPERATIONS
			case "CopyIntoItems":
				addToPayload(opt, ["SourceUrl"]);
				SOAPEnvelope.payload += "<DestinationUrls>";
				for (i=0; i < opt.DestinationUrls.length; i++) {
					SOAPEnvelope.payload += wrapNode("string", opt.DestinationUrls[i]);
				}
				SOAPEnvelope.payload += "</DestinationUrls>";
				addToPayload(opt, ["Fields", "Stream", "Results"]);
				break;
			case "CopyIntoItemsLocal":
				addToPayload(opt, ["SourceUrl"]);
				SOAPEnvelope.payload += "<DestinationUrls>";
				for (i=0; i < opt.DestinationUrls.length; i++) {
					SOAPEnvelope.payload += wrapNode("string", opt.DestinationUrls[i]);
				}
				SOAPEnvelope.payload += "</DestinationUrls>";
				break;
			case "GetItem":
				addToPayload(opt, ["Url", "Fields", "Stream"]);
				break;

			// FORM OPERATIONS
			case "GetForm":
				addToPayload(opt, ["listName", "formUrl"]);
				break;
			case "GetFormCollection":
				addToPayload(opt, ["listName"]);
				break;

			// LIST OPERATIONS
			case "AddAttachment":
				addToPayload(opt, ["listName", "listItemID", "fileName", "attachment"]);
				break;
			case "AddDiscussionBoardItem":
				addToPayload(opt, ["listName", "message"]);
				break;
			case "AddList":
				addToPayload(opt, ["listName", "description", "templateID"]);
				break;
			case "AddListFromFeature":
				addToPayload(opt, ["listName", "description", "featureID", "templateID"]);
				break;
			case "ApplyContentTypeToList":
				addToPayload(opt, ["webUrl", "contentTypeId", "listName"]);
				break;
			case "CheckInFile":
				addToPayload(opt, ["pageUrl", "comment", "CheckinType"]);
				break;
			case "CheckOutFile":
				addToPayload(opt, ["pageUrl", "checkoutToLocal", "lastmodified"]);
				break;
			case "CreateContentType":
				addToPayload(opt, ["listName", "displayName", "parentType", "fields", "contentTypeProperties", "addToView"]);
				break;
			case "DeleteAttachment":
				addToPayload(opt, ["listName", "listItemID", "url"]);
				break;
			case "DeleteContentType":
				addToPayload(opt, ["listName", "contentTypeId"]);
				break;
			case "DeleteContentTypeXmlDocument":
				addToPayload(opt, ["listName", "contentTypeId", "documentUri"]);
				break;
			case "DeleteList":
				addToPayload(opt, ["listName"]);
				break;
			case "GetAttachmentCollection":
				addToPayload(opt, ["listName", ["listItemID", "ID"]]);
				break;
			case "GetList":
				addToPayload(opt, ["listName"]);
				break;
			case "GetListAndView":
				addToPayload(opt, ["listName", "viewName"]);
				break;
			case "GetListCollection":
				break;
			case "GetListContentType":
				addToPayload(opt, ["listName", "contentTypeId"]);
				break;
			case "GetListContentTypes":
				addToPayload(opt, ["listName"]);
				break;
			case "GetListItems":
				addToPayload(opt, ["listName", "viewName", ["query", "CAMLQuery"], ["viewFields", "CAMLViewFields"], ["rowLimit", "CAMLRowLimit"], ["queryOptions", "CAMLQueryOptions"]]);
				break;
			case "GetListItemChanges":
				addToPayload(opt, ["listName", "viewFields", "since", "contains"]);
				break;
			case "GetListItemChangesSinceToken":
				addToPayload(opt, ["listName", "viewName", "query", "viewFields", "rowLimit", "queryOptions", "changeToken", "contains"]);
				break;
			case "GetVersionCollection":
				addToPayload(opt, ["strlistID", "strlistItemID", "strFieldName"]);
				break;
			case "UndoCheckOut":
				addToPayload(opt, ["pageUrl"]);
				break;
			case "UpdateContentType":
				addToPayload(opt, ["listName", "contentTypeId", "contentTypeProperties", "newFields", "updateFields", "deleteFields", "addToView"]);
				break;
			case "UpdateContentTypesXmlDocument":
				addToPayload(opt, ["listName", "newDocument"]);
				break;
			case "UpdateContentTypeXmlDocument":
				addToPayload(opt, ["listName", "contentTypeId", "newDocument"]);
				break;
			case "UpdateList":
				addToPayload(opt, ["listName", "listProperties", "newFields", "updateFields", "deleteFields", "listVersion"]);
				break;
			case "UpdateListItems":
				addToPayload(opt, ["listName"]);
				if(opt.updates !== undefined && opt.updates.length > 0) {
					addToPayload(opt, ["updates"]);
				} else {
					SOAPEnvelope.payload += "<updates><Batch OnError='Continue'><Method ID='1' Cmd='" + opt.batchCmd + "'>";
					for (i=0; i < opt.valuepairs.length; i++) { 
						SOAPEnvelope.payload += "<Field Name='" + opt.valuepairs[i][0] + "'>" + escapeColumnValue(opt.valuepairs[i][1]) + "</Field>";
					}
					if(opt.batchCmd !== "New") {
						SOAPEnvelope.payload += "<Field Name='ID'>" + opt.ID + "</Field>";
					}
					SOAPEnvelope.payload += "</Method></Batch></updates>";
				}
				break;

			// MEETINGS OPERATIONS
			case "AddMeeting":
				addToPayload(opt, ["organizerEmail", "uid", "sequence", "utcDateStamp", "title", "location", "utcDateStart", "utcDateEnd", "nonGregorian"]);
				break;
			case "CreateWorkspace":
				addToPayload(opt, ["title", "templateName", "lcid", "timeZoneInformation"]);
				break;
			case "RemoveMeeting":
				addToPayload(opt, ["recurrenceId", "uid", "sequence", "utcDateStamp", "cancelMeeting"]);
				break;
			case "SetWorkspaceTitle":
				addToPayload(opt, ["title"]);
				break;

			// PEOPLE OPERATIONS
			case "ResolvePrincipals":
				addToPayload(opt, ["principalKeys", "principalType", "addToUserInfoList"]);
				break;
			case "SearchPrincipals":
				addToPayload(opt, ["searchText", "maxResults", "principalType"]);
				break;

			// PERMISSION OPERATIONS
			case "AddPermission":
				addToPayload(opt, ["objectName", "objectType", "permissionIdentifier", "permissionType", "permissionMask"]);
				break;
			case "AddPermissionCollection":
				addToPayload(opt, ["objectName", "objectType", "permissionsInfoXml"]);
				break;
			case "GetPermissionCollection":
				addToPayload(opt, ["objectName", "objectType"]);
				break;
			case "RemovePermission":
				addToPayload(opt, ["objectName", "objectType", "permissionIdentifier", "permissionType"]);
				break;
			case "RemovePermissionCollection":
				addToPayload(opt, ["objectName", "objectType", "memberIdsXml"]);
				break;
			case "UpdatePermission":
				addToPayload(opt, ["objectName", "objectType", "permissionIdentifier", "permissionType", "permissionMask"]);
				break;

			// PUBLISHEDLINKSSERVICE OPERATIONS
			case "GetLinks":
				break;

			// SEARCH OPERATIONS
			case "GetPortalSearchInfo":
				SOAPEnvelope.opheader = "<" + opt.operation + " xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";
				SOAPAction = "http://microsoft.com/webservices/OfficeServer/QueryService/" + opt.operation;
				break;
			case "GetQuerySuggestions":
				SOAPEnvelope.opheader = "<" + opt.operation + " xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";
				SOAPAction = "http://microsoft.com/webservices/OfficeServer/QueryService/" + opt.operation;
				SOAPEnvelope.payload += wrapNode("queryXml", escapeHTML(opt.queryXml));
				break;
			case "GetSearchMetadata":
				SOAPEnvelope.opheader = "<" + opt.operation + " xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";
				SOAPAction = "http://microsoft.com/webservices/OfficeServer/QueryService/" + opt.operation;
				break;
			case "Query":
				SOAPEnvelope.payload += wrapNode("queryXml", escapeHTML(opt.queryXml));
				break;
			case "QueryEx":
				SOAPEnvelope.opheader = "<" + opt.operation + " xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";
				SOAPAction = "http://microsoft.com/webservices/OfficeServer/QueryService/" + opt.operation;
				SOAPEnvelope.payload += wrapNode("queryXml", escapeHTML(opt.queryXml));
				break;
			case "Registration":
				SOAPEnvelope.payload += wrapNode("registrationXml", escapeHTML(opt.registrationXml));
				break;
			case "Status":
				break;

			// SHAREPOINTDIAGNOSTICS OPERATIONS
			case "SendClientScriptErrorReport":
				addToPayload(opt, ["message", "file", "line", "client", "stack", "team", "originalFile"]);
				break;

			// SITEDATA OPERATIONS
			case "EnumerateFolder":
				addToPayload(opt, ["strFolderUrl"]);
				break;
			case "GetAttachments":
				addToPayload(opt, ["strListName", "strItemId"]);
				break;
			case "SiteDataGetList":
				addToPayload(opt, ["strListName"]);
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;
			case "SiteDataGetListCollection":
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;
			case "SiteDataGetSite":
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;
			case "SiteDataGetSiteUrl":
				addToPayload(opt, ["Url"]);
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;
			case "SiteDataGetWeb":
				// Because this operation has a name which duplicates the Lists WS, need to handle
				SOAPEnvelope = siteDataFixSOAPEnvelope(SOAPEnvelope, opt.operation);
				break;

			// SITES OPERATIONS
			case "CreateWeb":
				addToPayload(opt, ["urlType", "titleType", "descriptionType", "templateNameType", "languageType", "languageSpecifiedType",
					"localeType", "localeSpecifiedType", "collationLocaleType", "collationLocaleSpecifiedType", "uniquePermissionsType",
					"uniquePermissionsSpecifiedType", "anonymousType", "anonymousSpecifiedType", "presenceType", "presenceSpecifiedType"]);
				break;
			case "DeleteWeb":
				addToPayload(opt, ["url"]);
				break;
			case "GetSite":
				addToPayload(opt, ["SiteUrl"]);
				break;
			case "GetSiteTemplates":
				addToPayload(opt, ["LCID", "TemplateList"]);
				break;

			// SOCIALDATASERVICE OPERATIONS
			case "AddComment":
				addToPayload(opt, ["url", "comment", "isHighPriority", "title"]);
				break;
			case "AddTag":
				addToPayload(opt, ["url", "termID", "title", "isPrivate"]);
				break;
			case "AddTagByKeyword":
				addToPayload(opt, ["url", "keyword", "title", "isPrivate"]);
				break;
			case "CountCommentsOfUser":
				addToPayload(opt, ["userAccountName"]);
				break;
			case "CountCommentsOfUserOnUrl":
				addToPayload(opt, ["userAccountName", "url"]);
				break;
			case "CountCommentsOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "CountRatingsOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "CountTagsOfUser":
				addToPayload(opt, ["userAccountName"]);
				break;
			case "DeleteComment":
				addToPayload(opt, ["url", "lastModifiedTime"]);
				break;
			case "DeleteRating":
				addToPayload(opt, ["url"]);
				break;
			case "DeleteTag":
				addToPayload(opt, ["url", "termID"]);
				break;
			case "DeleteTagByKeyword":
				addToPayload(opt, ["url", "keyword"]);
				break;
			case "DeleteTags":
				addToPayload(opt, ["url"]);
				break;
			case "GetAllTagTerms":
				addToPayload(opt, ["maximumItemsToReturn"]);
				break;
			case "GetAllTagTermsForUrlFolder":
				addToPayload(opt, ["urlFolder", "maximumItemsToReturn"]);
				break;
			case "GetAllTagUrls":
				addToPayload(opt, ["termID"]);
				break;
			case "GetAllTagUrlsByKeyword":
				addToPayload(opt, ["keyword"]);
				break;
			case "GetCommentsOfUser":
				addToPayload(opt, ["userAccountName", "maximumItemsToReturn", "startIndex"]);
				break;
			case "GetCommentsOfUserOnUrl":
				addToPayload(opt, ["userAccountName", "url"]);
				break;
			case "GetCommentsOnUrl":
				addToPayload(opt, ["url", "maximumItemsToReturn", "startIndex"]);
				if(opt.excludeItemsTime !== undefined && opt.excludeItemsTime.length > 0) {
					SOAPEnvelope.payload += wrapNode("excludeItemsTime", opt.excludeItemsTime);
				}
				break;
			case "GetRatingAverageOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "GetRatingOfUserOnUrl":
				addToPayload(opt, ["userAccountName", "url"]);
				break;
			case "GetRatingOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "GetRatingsOfUser":
				addToPayload(opt, ["userAccountName"]);
				break;
			case "GetRatingsOnUrl":
				addToPayload(opt, ["url"]);
				break;
			case "GetSocialDataForFullReplication":
				addToPayload(opt, ["userAccountName"]);
				break;
			case "GetTags":
				addToPayload(opt, ["url"]);
				break;
			case "GetTagsOfUser":
				addToPayload(opt, ["userAccountName", "maximumItemsToReturn", "startIndex"]);
				break;
			case "GetTagTerms":
				addToPayload(opt, ["maximumItemsToReturn"]);
				break;
			case "GetTagTermsOfUser":
				addToPayload(opt, ["userAccountName", "maximumItemsToReturn"]);
				break;
			case "GetTagTermsOnUrl":
				addToPayload(opt, ["url", "maximumItemsToReturn"]);
				break;
			case "GetTagUrls":
				addToPayload(opt, ["termID"]);
				break;
			case "GetTagUrlsByKeyword":
				addToPayload(opt, ["keyword"]);
				break;
			case "GetTagUrlsOfUser":
				addToPayload(opt, ["termID", "userAccountName"]);
				break;
			case "GetTagUrlsOfUserByKeyword":
				addToPayload(opt, ["keyword", "userAccountName"]);
				break;
			case "SetRating":
				addToPayload(opt, ["url", "rating", "title", "analysisDataEntry"]);
				break;
			case "UpdateComment":
				addToPayload(opt, ["url", "lastModifiedTime", "comment", "isHighPriority"]);
				break;

			// SPELLCHECK OPERATIONS 
            case "SpellCheck":
				addToPayload(opt, ["chunksToSpell", "declaredLanguage", "useLad"]);
                break;

           // TAXONOMY OPERATIONS 
            case "AddTerms":
				addToPayload(opt, ["sharedServiceId", "termSetId", "lcid", "newTerms"]);
                break;
            case "GetChildTermsInTerm":
				addToPayload(opt, ["sspId", "lcid", "termId", "termSetId"]);
                break;
            case "GetChildTermsInTermSet":
				addToPayload(opt, ["sspId", "lcid", "termSetId"]);
                break;
            case "GetKeywordTermsByGuids":
				addToPayload(opt, ["termIds", "lcid"]);
                break;
            case "GetTermsByLabel":
				addToPayload(opt, ["label", "lcid", "matchOption", "resultCollectionSize", "termIds", "addIfNotFound"]);
                break;
            case "GetTermSets":
				addToPayload(opt, ["sharedServiceId", "termSetId", "lcid", "clientTimeStamps", "clientVersions"]);
                break;

			// USERS AND GROUPS OPERATIONS
			case "AddGroup":
				addToPayload(opt, ["groupName", "ownerIdentifier", "ownerType", "defaultUserLoginName", "description"]);
				break;
			case "AddGroupToRole":
				addToPayload(opt, ["groupName", "roleName"]);
				break;
			case "AddRole":
				addToPayload(opt, ["roleName", "description", "permissionMask"]);
				break;
			case "AddRoleDef":
				addToPayload(opt, ["roleName", "description", "permissionMask"]);
				break;
			case "AddUserCollectionToGroup":
				addToPayload(opt, ["groupName", "usersInfoXml"]);
				break;
			case "AddUserCollectionToRole":
				addToPayload(opt, ["roleName", "usersInfoXml"]);
				break;
			case "AddUserToGroup":
				addToPayload(opt, ["groupName", "userName", "userLoginName", "userEmail", "userNotes"]);
				break;
			case "AddUserToRole":
				addToPayload(opt, ["roleName", "userName", "userLoginName", "userEmail", "userNotes"]);
				break;
			case "GetAllUserCollectionFromWeb":
				break;
			case "GetGroupCollection":
				addToPayload(opt, ["groupNamesXml"]);
				break;
			case "GetGroupCollectionFromRole":
				addToPayload(opt, ["roleName"]);
				break;
			case "GetGroupCollectionFromSite":
				break;
			case "GetGroupCollectionFromUser":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "GetGroupCollectionFromWeb":
				break;
			case "GetGroupInfo":
				addToPayload(opt, ["groupName"]);
				break;
			case "GetRoleCollection":
				addToPayload(opt, ["roleNamesXml"]);
				break;
			case "GetRoleCollectionFromGroup":
				addToPayload(opt, ["groupName"]);
				break;
			case "GetRoleCollectionFromUser":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "GetRoleCollectionFromWeb":
				break;
			case "GetRoleInfo":
				addToPayload(opt, ["roleName"]);
				break;
			case "GetRolesAndPermissionsForCurrentUser":
				break;
			case "GetRolesAndPermissionsForSite":
				break;
			case "GetUserCollection":
				addToPayload(opt, ["userLoginNamesXml"]);
				break;
			case "GetUserCollectionFromGroup":
				addToPayload(opt, ["groupName"]);
				break;
			case "GetUserCollectionFromRole":
				addToPayload(opt, ["roleName"]);
				break;
			case "GetUserCollectionFromSite":
				break;
			case "GetUserCollectionFromWeb":
				break;
			case "GetUserInfo":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "GetUserLoginFromEmail":
				addToPayload(opt, ["emailXml"]);
				break;
			case "RemoveGroup":
				addToPayload(opt, ["groupName"]);
				break;
			case "RemoveGroupFromRole":
				addToPayload(opt, ["roleName", "groupName"]);
				break;
			case "RemoveRole":
				addToPayload(opt, ["roleName"]);
				break;
			case "RemoveUserCollectionFromGroup":
				addToPayload(opt, ["groupName", "userLoginNamesXml"]);
				break;
			case "RemoveUserCollectionFromRole":
				addToPayload(opt, ["roleName", "userLoginNamesXml"]);
				break;
			case "RemoveUserCollectionFromSite":
				addToPayload(opt, ["userLoginNamesXml"]);
				break;
			case "RemoveUserFromGroup":
				addToPayload(opt, ["groupName", "userLoginName"]);
				break;
			case "RemoveUserFromRole":
				addToPayload(opt, ["roleName", "userLoginName"]);
				break;
			case "RemoveUserFromSite":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "RemoveUserFromWeb":
				addToPayload(opt, ["userLoginName"]);
				break;
			case "UpdateGroupInfo":
				addToPayload(opt, ["oldGroupName", "groupName", "ownerIdentifier", "ownerType", "description"]);
				break;
			case "UpdateRoleDefInfo":
				addToPayload(opt, ["oldRoleName", "roleName", "description", "permissionMask"]);
				break;
			case "UpdateRoleInfo":
				addToPayload(opt, ["oldRoleName", "roleName", "description", "permissionMask"]);
				break;
			case "UpdateUserInfo":
				addToPayload(opt, ["userLoginName", "userName", "userEmail", "userNotes"]);
				break;

			// USERPROFILESERVICE OPERATIONS
			case "AddColleague":
				addToPayload(opt, ["accountName", "colleagueAccountName", "group", "privacy", "isInWorkGroup"]);
				break;																			
			case "AddLink":
				addToPayload(opt, ["accountName", "name", "url", "group", "privacy"]);
				break;																						
			case "AddMembership":
				addToPayload(opt, ["accountName", "membershipInfo", "group", "privacy"]);
				break;															
			case "AddPinnedLink":
				addToPayload(opt, ["accountName", "name", "url"]);
				break;
			case "CreateMemberGroup":
				addToPayload(opt, ["membershipInfo"]);
				break;
			case "CreateUserProfileByAccountName":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetCommonColleagues":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetCommonManager":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetCommonMemberships":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetInCommon":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetPropertyChoiceList":
				addToPayload(opt, ["propertyName"]);
				break;
			case "GetUserColleagues":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetUserLinks":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetUserMemberships":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetUserPinnedLinks":
				addToPayload(opt, ["accountName"]);
				break;
			case "GetUserProfileByGuid":
				addToPayload(opt, ["guid"]);
				break;
			case "GetUserProfileByIndex":
				addToPayload(opt, ["index"]);
				break;
			case "GetUserProfileByName":
				// Note that this operation is inconsistent with the others, using AccountName rather than accountName
				if(opt.accountName !== undefined && opt.accountName.length > 0) {
					addToPayload(opt, [["AccountName", "accountName"]]);
				} else {
					addToPayload(opt, ["AccountName"]);
				}
				break;
			case "GetUserProfileCount":
				break;
			case "GetUserProfileSchema":
				break;
			case "ModifyUserPropertyByAccountName":
				addToPayload(opt, ["accountName", "newData"]);
				break;
			case "RemoveAllColleagues":
				addToPayload(opt, ["accountName"]);
				break;
			case "RemoveAllLinks":
				addToPayload(opt, ["accountName"]);
				break;
			case "RemoveAllMemberships":
				addToPayload(opt, ["accountName"]);
				break;
			case "RemoveAllPinnedLinks":
				addToPayload(opt, ["accountName"]);
				break;	
			case "RemoveColleague":
				addToPayload(opt, ["accountName", "colleagueAccountName"]);
				break;	
			case "RemoveLink":
				addToPayload(opt, ["accountName", "id"]);
				break;
			case "RemoveMembership":
				addToPayload(opt, ["accountName", "sourceInternal", "sourceReference"]);
				break;
			case "RemovePinnedLink":
				addToPayload(opt, ["accountName", "id"]);
				break;																							
			case "UpdateColleaguePrivacy":
				addToPayload(opt, ["accountName", "colleagueAccountName", "newPrivacy"]);
				break;
			case "UpdateLink":
				addToPayload(opt, ["accountName", "data"]);
				break;			
			case "UpdateMembershipPrivacy":  
				addToPayload(opt, ["accountName", "sourceInternal", "sourceReference", "newPrivacy"]);
				break;
			case "UpdatePinnedLink ":
				addToPayload(opt, ["accountName", "data"]);
				break;

			// VERSIONS OPERATIONS
			case "DeleteAllVersions":
				addToPayload(opt, ["fileName"]);
				break;
			case "DeleteVersion":
				addToPayload(opt, ["fileName", "fileVersion"]);
				break;
			case "GetVersions":
				addToPayload(opt, ["fileName"]);
				break;
			case "RestoreVersion":
				addToPayload(opt, ["fileName", "fileVersion"]);
				break;

			// VIEW OPERATIONS
			case "AddView":
				addToPayload(opt, ["listName", "viewName", "viewFields", "query", "rowLimit", "rowLimit", "type", "makeViewDefault"]);
				break;
			case "DeleteView":
				addToPayload(opt, ["listName", "viewName"]);
				break;
			case "GetView":
				addToPayload(opt, ["listName", "viewName"]);
				break;
			case "GetViewCollection":
				addToPayload(opt, ["listName"]);
				break;
			case "GetViewHtml":
				addToPayload(opt, ["listName", "viewName"]);
				break;
			case "UpdateView":
				addToPayload(opt, ["listName", "viewName", "viewProperties", "query", "viewFields", "aggregations", "formats", "rowLimit"]);
				break;
			case "UpdateViewHtml":
				addToPayload(opt, ["listName", "viewName", "viewProperties", "toolbar", "viewHeader", "viewBody", "viewFooter", "viewEmpty", "rowLimitExceeded",
					"query", "viewFields", "aggregations", "formats", "rowLimit"]);
				break;

			// WEBPARTPAGES OPERATIONS
			case "AddWebPart":
				addToPayload(opt, ["pageUrl", "webPartXml", "storage"]);
				break;
			case "AddWebPartToZone":
				addToPayload(opt, ["pageUrl", "webPartXml", "storage", "zoneId", "zoneIndex"]);
				break;
			case "GetWebPart2":
				addToPayload(opt, ["pageUrl", "storageKey", "storage", "behavior"]);
				break;
			case "GetWebPartPage":
				addToPayload(opt, ["documentName", "behavior"]);
				break;
			case "GetWebPartProperties":
				addToPayload(opt, ["pageUrl", "storage"]);
				break;
			case "GetWebPartProperties2":
				addToPayload(opt, ["pageUrl", "storage", "behavior"]);
				break;

			// WEBS OPERATIONS
			case "Webs.CreateContentType":
				addToPayload(opt, ["displayName", "parentType", "newFields", "contentTypeProperties"]);
				break;
			case "GetColumns":
				addToPayload(opt, ["webUrl"]);
				break;
			case "GetContentType":
				addToPayload(opt, ["contentTypeId"]);
				break;
			case "GetContentTypes":
				break;
			case "GetCustomizedPageStatus":
				addToPayload(opt, ["fileUrl"]);
				break;
			case "GetListTemplates":
				break;
			case "GetObjectIdFromUrl":
				addToPayload(opt, ["objectUrl"]);
				break;
			case "GetWeb":
				addToPayload(opt, [["webUrl", "webURL"]]);
				break;
			case "GetWebCollection":
				break;
			case "GetAllSubWebCollection":
				break;
			case "UpdateColumns":
				addToPayload(opt, ["newFields", "updateFields", "deleteFields"]);
				break;				
			case "Webs.UpdateContentType":
				addToPayload(opt, ["contentTypeId", "contentTypeProperties", "newFields", "updateFields", "deleteFields"]);
				break;				
			case "WebUrlFromPageUrl":
				addToPayload(opt, [["pageUrl", "pageURL"]]);
				break;

			// WORKFLOW OPERATIONS
			case "AlterToDo":
				addToPayload(opt, ["item", "todoId", "todoListId", "taskData"]);
				break;
			case "GetTemplatesForItem":
				addToPayload(opt, ["item"]);
				break;
			case "GetToDosForItem":
				addToPayload(opt, ["item"]);
				break;
			case "GetWorkflowDataForItem":
				addToPayload(opt, ["item"]);
				break;
			case "GetWorkflowTaskData":
				addToPayload(opt, ["item", "listId", "taskId"]);
				break;
			case "StartWorkflow":
				addToPayload(opt, ["item", "templateId", "workflowParameters"]);
				break;

			default:
				break;
		}

		// Glue together the pieces of the SOAP message
		var msg = SOAPEnvelope.header +
			SOAPEnvelope.opheader +
			SOAPEnvelope.payload +
			SOAPEnvelope.opfooter +
			SOAPEnvelope.footer;

		var cachedXML;
		var status = null;

		if(opt.cacheXML) {
			cachedXML = $("body").data(msg);
		}
		
		if(cachedXML === undefined) {
			// Make the Ajax call
			$.ajax({
				url: ajaxURL,											// The relative URL for the AJAX call
				async: opt.async,										// By default, the AJAX calls are asynchronous.  You can specify false to require a synchronous call.
				beforeSend: function (xhr) {							// Before sending the msg, need to send the request header
					// If we need to pass the SOAPAction, do so
					if(WSops[opt.operation][1]) {
						xhr.setRequestHeader("SOAPAction", SOAPAction);
					}
				},
				type: "POST",											// This is a POST
				data: msg,												// Here is the SOAP request we've built above
				dataType: "xml",										// We're getting XML; tell jQuery so that it doesn't need to do a best guess
				contentType: "text/xml;charset='utf-8'",				// and this is its content type
				complete: function(xData, Status) {
					if(opt.cacheXML) {
						$("body").data(msg, xData);				// Cache the results
					}
					cachedXML = xData;
					status = Status;
					opt.completefunc(cachedXML, status);				// When the call is complete, do this
				}
			});

		} else {
			opt.completefunc(cachedXML, status);						// Call the completefunc
		}

	}; // End $.fn.SPServices

	// Defaults added as a function in our library means that the caller can override the defaults
	// for their session by calling this function.  Each operation requires a different set of options;
	// we allow for all in a standardized way.
	$.fn.SPServices.defaults = {

		cacheXML: false,				// If true, we'll cache the XML results with jQuery's .data() function
		operation: "",				// The Web Service operation
		webURL: "",					// URL of the target Web
		makeViewDefault: false,		// true to make the view the default view for the list

		// For operations requiring CAML, these options will override any abstractions
		CAMLViewName: "",			// View name in CAML format.
		CAMLQuery: "",				// Query in CAML format
		CAMLViewFields: "",			// View fields in CAML format
		CAMLRowLimit: 0,			// Row limit as a string representation of an integer
		CAMLQueryOptions: "<QueryOptions></QueryOptions>",		// Query options in CAML format

		// Abstractions for CAML syntax
		batchCmd: "Update",			// Method Cmd for UpdateListItems
		valuepairs: [],				// Fieldname / Fieldvalue pairs for UpdateListItems

		// As of v0.7.1, removed all options which were assigned an empty string ("")
		DestinationUrls: [],		// Array of destination URLs for copy operations
		behavior: "Version3",		// An SPWebServiceBehavior indicating whether the client supports Windows SharePoint Services 2.0 or Windows SharePoint Services 3.0: {Version2 | Version3 }
		storage: "Shared",			// A Storage value indicating how the Web Part is stored: {None | Personal | Shared}
		objectType: "List",			// objectType for operations which require it
		cancelMeeting: true,		// true to delete a meeting;false to remove its association with a Meeting Workspace site
		nonGregorian: false,		// true if the calendar is set to a format other than Gregorian;otherwise, false.
		fClaim: false,				// Specifies if the action is a claim or a release. Specifies true for a claim and false for a release.
		recurrenceId: 0,			// The recurrence ID for the meeting that needs its association removed. This parameter can be set to 0 for single-instance meetings.
		sequence: 0,				// An integer that is used to determine the ordering of updates in case they arrive out of sequence. Updates with a lower-than-current sequence are discarded. If the sequence is equal to the current sequence, the latest update are applied.
		maximumItemsToReturn: 0,	// SocialDataService maximumItemsToReturn
		startIndex: 0,				// SocialDataService startIndex
		isHighPriority: false,		// SocialDataService isHighPriority
		isPrivate: false,			// SocialDataService isPrivate
		rating: 1,					// SocialDataService rating
		maxResults: 10,				// Unless otherwise specified, the maximum number of principals that can be returned from a provider is 10.
		principalType: "User",		// Specifies user scope and other information: [None | User | DistributionList | SecurityGroup | SharePointGroup | All]

		async: true,				// Allow the user to force async
		completefunc: null			// Function to call on completion

	}; // End $.fn.SPServices.defaults

	// Function to determine the current Web's URL.  We need this for successful Ajax calls.
	// The function is also available as a public function.
	$.fn.SPServices.SPGetCurrentSite = function() {

		// Do we already know the current site?
		if(thisSite.length > 0) {
			return thisSite;
		}

		// SharePoint 2010 provides the current context, so if available, let's use it
//		thisSite = (typeof SP !== "undefined") ? SP.ClientContext.get_current().get_url() : undefined;
//		if(thisSite !== undefined) return thisSite = location.protocol + "//" + location.hostname + thisSite;
		
		var msg = SOAPEnvelope.header +
				"<WebUrlFromPageUrl xmlns='" + SCHEMASharePoint + "/soap/' ><pageUrl>" +
				((location.href.indexOf("?") > 0) ? location.href.substr(0, location.href.indexOf("?")) : location.href) +
				"</pageUrl></WebUrlFromPageUrl>" +
				SOAPEnvelope.footer;
		$.ajax({
			async: false, // Need this to be synchronous so we're assured of a valid value
			url: "/_vti_bin/Webs.asmx",
			type: "POST",
			data: msg,
			dataType: "xml",
			contentType: "text/xml;charset=\"utf-8\"",
			complete: function (xData, Status) {
				thisSite = $(xData.responseXML).find("WebUrlFromPageUrlResult").text();
			}
		});
		return thisSite; // Return the URL
	}; // End $.fn.SPServices.SPGetCurrentSite

	// Function to set up cascading dropdowns on a SharePoint form
	// (Newform.aspx, EditForm.aspx, or any other customized form.)
	$.fn.SPServices.SPCascadeDropdowns = function(options) {

		var opt = $.extend({}, {
			relationshipWebURL: "",				// [Optional] The name of the Web (site) which contains the relationships list
			relationshipList: "",				// The name of the list which contains the parent/child relationships
			relationshipListParentColumn: "",	// The internal name of the parent column in the relationship list
			relationshipListChildColumn: "",	// The internal name of the child column in the relationship list
			relationshipListSortColumn: "",		// [Optional] If specified, sort the options in the dropdown by this column,
												// otherwise the options are sorted by relationshipListChildColumn
			parentColumn: "",					// The display name of the parent column in the form
			childColumn: "",					// The display name of the child column in the form
			listName: $().SPServices.SPListNameFromUrl(),		// The list the form is working with. This is useful if the form is not in the list context.
			CAMLQuery: "",						// [Optional] For power users, this CAML fragment will be Anded with the default query on the relationshipList
			promptText: "",						// [DEPRECATED] Text to use as prompt. If included, {0} will be replaced with the value of childColumn. IOrignal value "Choose {0}..."
			noneText: "(None)",					// [Optional] Text to use for the (None) selection. Provided for non-English language support.
			simpleChild: false,					// [Optional] If set to true and childColumn is a complex dropdown, convert it to a simple dropdown
			selectSingleOption: false,			// [Optional] If set to true and there is only a single child option, select it
			matchOnId: false,					// By default, we match on the lookup's text value. If matchOnId is true, we'll match on the lookup id instead.
			completefunc: null,					// Function to call on completion of rendering the change.
			debug: false						// If true, show error messages;if false, run silent
		}, options);


		var thisParentSetUp = false;
		var thisFunction = "SPServices.SPCascadeDropdowns";

		// Find the parent column's select (dropdown)
		var parentSelect = new DropdownCtl(opt.parentColumn);
		if(parentSelect.Obj.html() === null && opt.debug) {errBox(thisFunction, "parentColumn: " + opt.parentColumn , TXTColumnNotFound);return;}

		// Find the child column's select (dropdown)
		var childSelect = new DropdownCtl(opt.childColumn);
		if(childSelect.Obj.html() === null && opt.debug) {errBox(thisFunction, "childColumn: " + opt.childColumn, TXTColumnNotFound);return;}

		// If requested and the childColumn is a complex dropdown, convert to a simple dropdown
		if(opt.simpleChild === true && childSelect.Type === "C") {
			$().SPServices.SPComplexToSimpleDropdown({
				columnName: opt.childColumn
			});
			// Set the childSelect to reference the new simple dropdown
			childSelect = new DropdownCtl(opt.childColumn);
		}

		// Get information about the childColumn from the current list
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			listName: opt.listName,
			completefunc: function(xData, Status) {
				$(xData.responseXML).find("Fields").each(function() {
					$(this).find("Field[DisplayName='" + opt.childColumn + "']").each(function() {
						// Determine whether childColumn is Required
						childColumnRequired = ($(this).attr("Required") === "TRUE") ? true : false;
						childColumnStatic = $(this).attr("StaticName");
						// Stop looking; we're done
						return false;
					});
				});
			}
		});

		// Save data about each child column on the parent
		var childColumn = {opt: opt, childSelect: childSelect, childColumnStatic: childColumnStatic, childColumnRequired: childColumnRequired};
		var childColumns = parentSelect.Obj.data("SPCascadeDropdownsChildColumns");

		// If this is the first child for this parent, then create the data object to hold the settings
		if(childColumns === undefined) {
			parentSelect.Obj.data("SPCascadeDropdownsChildColumns", [childColumn]);
		// If we already have a data object for this parent, then add the setting for this child to it
		} else {
			childColumns.push(childColumn);
			parentSelect.Obj.data("SPCascadeDropdownsChildColumns", childColumns);
			thisParentSetUp = true;
		}

		// We only need to bind to the event(s) if we haven't already done so
		if(!thisParentSetUp) {
			switch(parentSelect.Type) {
				// Plain old select
				case "S":
					parentSelect.Obj.bind("change", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
					});
					break;
				// Input / Select hybrid
				case "C":
					// Bind to any change on the hidden input element
					$("input[id='"+ parentSelect.Obj.attr("optHid") + "']").bind("propertychange", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
					});
					break;
				// Multi-select hybrid
				case "M":
					// Handle the dblclick on the candidate select
					parentSelect.Obj.bind("dblclick", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
					});
					// Handle the dblclick on the selected values
					parentSelections = parentSelect.Obj.closest("span").find("select[id$='SelectResult']");
					parentSelections.bind("dblclick", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
					});
					// Handle a button click
					parentSelect.Obj.closest("span").find("button").each(function() {
						$(this).bind("click", function() {
						cascadeDropdown(opt.parentColumn, parentSelect);
						});
					});
					break;
				default:
					break;
			}
		}
		// Fire the change to set the initially allowable values
		cascadeDropdown(opt.parentColumn, parentSelect);

	}; // End $.fn.SPServices.SPCascadeDropdowns

	function cascadeDropdown(parentColumn, parentSelect) {
		var choices = "";
		var parentSelectSelected;
		var childSelectSelected = null;
		var master;
		var MultiLookupPickerdata;
		var newMultiLookupPickerdata;
		var numChildOptions;
		var firstChildOptionId;
		var firstChildOptionValue;

		// Filter each child column
		var childColumns = parentSelect.Obj.data("SPCascadeDropdownsChildColumns");
		$(childColumns).each(function() {

			// Break out the data objects for this child column
			var opt = this.opt;
			var childSelect = this.childSelect;
			var childColumnStatic = this.childColumnStatic;
			var childColumnRequired = this.childColumnRequired;

			// Get the parent column selection(s)
			parentSelectSelected = getDropdownSelected(parentSelect, opt.matchOnId);

			// If the selection hasn't changed, then there's nothing to do right now.  This is useful to reduce
			// the number of Web Service calls when the parentSelect.Type = "C" or "M", as there are multiple propertychanges
			// which don't require any action.  The attribute will be unique per child column in case there are
			// multiple children for a given parent.
			var allParentSelections = parentSelectSelected.join(";#");
			if(parentSelect.Obj.data("SPCascadeDropdown_Selected_" + childColumnStatic) === allParentSelections) {
				return;
			}
			parentSelect.Obj.data("SPCascadeDropdown_Selected_" + childColumnStatic, allParentSelections);

			// Get the current child column selection(s)
			childSelectSelected = getDropdownSelected(childSelect, true);

			// Find the important bits of the multi-select
			if(childSelect.Type === "M") {
				MultiLookupPickerdata = childSelect.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");
				master = window[childSelect.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,'MultiLookupPicker_m')];
				currentSelection = childSelect.Obj.closest("span").find("select[ID$='SelectResult']");
			}

			// When the parent column's selected option changes, get the matching items from the relationship list
			// Get the list items which match the current selection
			var sortColumn = (opt.relationshipListSortColumn.length > 0) ? opt.relationshipListSortColumn : opt.relationshipListChildColumn;
			var camlQuery = "<Query><OrderBy><FieldRef Name='" + sortColumn + "'/></OrderBy><Where><And>";
			if(opt.CAMLQuery.length > 0) {
				camlQuery += "<And>";
			}

			// Build up the criteria for inclusion
			if(parentSelectSelected.length === 0) {
				// Handle the case where no values are selected in multi-selects
				camlQuery += "<Eq><FieldRef Name='" + opt.relationshipListParentColumn + "'/><Value Type='Text'></Value></Eq>";
			} else if(parentSelectSelected.length === 1) {
				// Only one value is selected
				camlQuery += "<Eq><FieldRef Name='" + opt.relationshipListParentColumn +
					(opt.matchOnId ? "' LookupId='True'/><Value Type='Integer'>" : "'/><Value Type='Text'>") +
					escapeColumnValue(parentSelectSelected[0]) + "</Value></Eq>";
			} else {
				var compound = (parentSelectSelected.length > 2) ? true : false;
				for(i=0; i < (parentSelectSelected.length - 1); i++) {
					camlQuery += "<Or>";
				}
				for(i=0; i < parentSelectSelected.length; i++) {
					camlQuery += "<Eq><FieldRef Name='" + opt.relationshipListParentColumn +
						(opt.matchOnId ? "' LookupId='True'/><Value Type='Integer'>" : "'/><Value Type='Text'>") +
						escapeColumnValue(parentSelectSelected[i]) + "</Value></Eq>";
					if(i>0 && (i < (parentSelectSelected.length - 1)) && compound) {
						camlQuery += "</Or>";
					}
				}
				camlQuery += "</Or>";
			}

			if(opt.CAMLQuery.length > 0) {
				camlQuery += opt.CAMLQuery + "</And>";
			}

			// Make sure we don't get any items which don't have the child value
			camlQuery += "<IsNotNull><FieldRef Name='" + opt.relationshipListChildColumn + "' /></IsNotNull>";

			camlQuery += "</And></Where></Query>";
		
			$().SPServices({
				operation: "GetListItems",
				// Force sync so that we have the right values for the child column onchange trigger
				async: false,
				webURL: opt.relationshipWebURL,
				listName: opt.relationshipList,
				// Filter based on the currently selected parent column's value
				CAMLQuery: camlQuery,
				// Only get the parent and child columns
				CAMLViewFields: "<ViewFields><FieldRef Name='" + opt.relationshipListParentColumn + "' /><FieldRef Name='" + opt.relationshipListChildColumn + "' /></ViewFields>",
				// Override the default view rowlimit and get all appropriate rows
				CAMLRowLimit: 0,
				// Even though setting IncludeMandatoryColumns to FALSE doesn't work as the docs describe, it fixes a bug in GetListItems with mandatory multi-selects
				CAMLQueryOptions: "<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",
				completefunc: function(xData, Status) {

					// Handle errors
					$(xData.responseXML).find("errorstring").each(function() {
						var thisFunction = "SPServices.SPCascadeDropdowns";
						var errorText = $(this).text();
						if(opt.debug && errorText === "One or more field types are not installed properly. Go to the list settings page to delete these fields.") {
							errBox(thisFunction,
								"relationshipListParentColumn: " + opt.relationshipListParentColumn + " or " +
								"relationshipListChildColumn: " + opt.relationshipListChildColumn,
								"Not found in relationshipList " + opt.relationshipList);
						} else if (opt.debug && errorText === "Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).") {
							errBox(thisFunction,
								"relationshipList: " + opt.relationshipList,
								"List not found");
						}
						return;
					});

					// Add an explanatory prompt
					switch(childSelect.Type) {
						case "S":
							// Remove all of the existing options
							$(childSelect.Obj).find("option").remove();
							// If the column is required or the promptText option is empty, don't add the prompt text
							if(!childColumnRequired && (opt.promptText.length > 0)) {
								childSelect.Obj.append("<option value='0'>" + opt.promptText.replace(/\{0\}/g, opt.childColumn) + "</option>");
							} else if(!childColumnRequired){
								childSelect.Obj.append("<option value='0'>" + opt.noneText + "</option>");
							}
							break;
						case "C":
							// If the column is required, don't add the "(None)" option
							choices = childColumnRequired ? "" : opt.noneText + "|0";
							childSelect.Obj.attr("value", "");
							break;
						case "M":
							// Remove all of the existing options
							$(childSelect.Obj).find("option").remove();
							newMultiLookupPickerdata = "";
							break;
						default:
							break;
					}
					// Get the count of items returned and save it so that we can select if it's a single option 
					// The item count is stored thus: <rs:data ItemCount="1">
					numChildOptions = parseFloat($(xData.responseXML).SPFilterNode("rs:data").attr("ItemCount"));

					// Add an option for each child item
					$(xData.responseXML).SPFilterNode("z:row").each(function() {

						var thisOptionId, thisOptionValue;

						// If relationshipListChildColumn is a Lookup column, then the ID should be for the Lookup value,
						// else the ID of the relationshipList item
						var thisValue = $(this).attr("ows_" + opt.relationshipListChildColumn);
						
						if(thisValue !== undefined && thisValue.indexOf(";#") > 0) {
							var splitValue = thisValue.split(";#");
							thisOptionId = splitValue[0];
							thisOptionValue = splitValue[1];
						} else {
							thisOptionId = $(this).attr("ows_ID");
							thisOptionValue = thisValue;						
						}

						// If the relationshipListChildColumn is a calculated column, then the value isn't preceded by the ID,
						// but by the datatype.  In this case, thisOptionId should be the ID of the relationshipList item.   
						// e.g., float;#12345.67
						if(isNaN(thisOptionId)) {
							thisOptionId = $(this).attr("ows_ID");
						}
					
						// Save the id and value for the first child option in case we need to select it (selectSingleOption option is true)
						firstChildOptionId = thisOptionId;
						firstChildOptionValue = thisOptionValue;
					
						switch(childSelect.Type) {
							case "S":
								var selected = ($(this).attr("ows_ID") === childSelectSelected[0]) ? " selected='selected'" : "";
								childSelect.Obj.append("<option" + selected + " value='" + thisOptionId + "'>" + thisOptionValue + "</option>");
								break;
							case "C":
								if(thisOptionId === childSelectSelected[0]) {
									childSelect.Obj.attr("value", thisOptionValue);
								}
								choices = choices + ((choices.length > 0) ? "|" : "") + thisOptionValue + "|" + thisOptionId;
								break;
							case "M":
								childSelect.Obj.append("<option value='" + thisOptionId + "'>" + thisOptionValue + "</option>");
								newMultiLookupPickerdata += thisOptionId + "|t" + thisOptionValue + "|t |t |t";
								break;
							default:
								break;
						}
					});

					switch(childSelect.Type) {
						case "S":
							childSelect.Obj.trigger("change");
							// If there is only one option and the selectSingleOption option is true, then select it
							if(numChildOptions === 1 && opt.selectSingleOption === true) {
								$(childSelect.Obj).find("option[value!='0']:first").attr("selected", "selected");
							}
							break;
						case "C":
							// Set the allowable choices
							childSelect.Obj.attr("choices", choices);
							// If there is only one option and the selectSingleOption option is true, then select it
							if(numChildOptions === 1 && opt.selectSingleOption === true) {
								// Set the input element value
								$(childSelect.Obj).attr("value", firstChildOptionValue);
								// Set the value of the optHid input element
								$("input[id='" + childSelect.Obj.attr("optHid") + "']").val(firstChildOptionId);
							}
							// If there's no selection, then remove the value in the associated hidden input element (optHid)
							if(childSelect.Obj.val() === "") {
								$("input[id='" + childSelect.Obj.attr("optHid") + "']").val("");
							}
							break;
						case "M":
							// Clear the master
							master.data = "";
							MultiLookupPickerdata.attr("value", newMultiLookupPickerdata);

							// Clear any prior selections that are no longer valid or aren't selected
							$(currentSelection).find("option").each(function() {
								var thisSelected = $(this);
								var thisValue = $(this).html();
								$(this).attr("selected", "selected");
								$(childSelect.Obj).find("option").filter(function() {
									return $(this).text() == thisValue.replace(/&amp;/, "&");	
								}).each(function() {
									if($(this).html() === thisValue) {
										thisSelected.removeAttr("selected");
									}
								});
							});
							GipRemoveSelectedItems(master);

							// Hide any options in the candidate list which are already selected
							$(childSelect.Obj).find("option").each(function() {
								var thisSelected = $(this);
								$(currentSelection).find("option").each(function() {
									if($(this).html() === thisSelected.html()) {
										thisSelected.remove();
									}
								});
							});
							GipAddSelectedItems(master);

							// Set master.data to the newly allowable values
							master.data = GipGetGroupData(newMultiLookupPickerdata);

							// Trigger a dblclick so that the child will be cascaded if it is a multiselect.
							childSelect.Obj.trigger("dblclick");

							break;
						default:
							break;
					}
				}
			});
			// If present, call completefunc when all else is done
			if(opt.completefunc !== null) {
				opt.completefunc();
			}
		}); // $(childColumns).each(function()

	} // End cascadeDropdown


	// function to convert complex dropdowns to simple dropdowns
	$.fn.SPServices.SPComplexToSimpleDropdown = function(options) {

		var opt = $.extend({}, {
			columnName: "",						// The display name of the column in the form
			completefunc: null,					// Function to call on completion of rendering the change.
			debug: false						// If true, show error messages;if false, run silent
		}, options);

		// Find the column's select (dropdown)
		var columnSelect = new DropdownCtl(opt.columnName);
		if(columnSelect.Obj.html() === null && opt.debug) {errBox("SPServices.SPComplexToSimpleDropdown", "columnName: " + opt.columnName, TXTColumnNotFound); return;	}

		// If we don't have a complex dropdown, then there is nothing to do
		if(columnSelect.Type !== "C") { return; }
		
		// The available options are stored in the choices attribute of the complex dropdowns's input element...
		var choices = $(columnSelect.Obj).attr("choices").split("|");
		// The optHid attribute contains the id of a hidden input element which stores the selected value for the commit
		var columnOptHid = $(columnSelect.Obj).attr("optHid");
		var columnOptHidInput = $("input[id='" + columnOptHid + "']");
		// We need to know which option is selected already, if any
		var complexSelectSelectedId = $("input[id='" + columnOptHid + "']").val();

		// Build up the simple dropdown, giving it an easy to select id
		var simpleSelectId = genContainerId("SPComplexToSimpleDropdown", opt.columnName);

		var simpleSelect = "<select id='" + simpleSelectId + "' title='" + opt.columnName + "'>";		
		for(i=0; i < choices.length; i=i+2) {
			var simpleSelectSelected = (choices[i+1] === complexSelectSelectedId) ? " selected='selected' " : " ";
			simpleSelect += "<option" + simpleSelectSelected + "value='" + choices[i+1] + "'>" + choices[i] + "</option>";
		}
		simpleSelect += "</select>";
		
		// Append the new simple select to the form
		$(columnSelect.Obj).closest("td").prepend(simpleSelect);

		// Remove the complex dropdown functionality since we don't need it anymore...
		$(columnSelect.Obj).closest("span").find("img").remove();
		// ...and hide the input element
		$(columnSelect.Obj).closest("span").find("input").hide();

		// When the simple select changes...
		$("#" + simpleSelectId).change(function() {
			var thisVal = $(this).val();
			// ...set the optHid input element's value to the valus of the selected option...
			columnOptHidInput.val(thisVal);
			// ...and save the selected value as the hidden input's value only if the value is not equal to "0" (None)
			$(columnSelect.Obj).val($(this).find("option[value='" + (thisVal !== "0" ? thisVal : "") + "']").html());
		});
		// Trigger a change to ensure that the selected value registers in the complex dropdown
		$("#" + simpleSelectId).trigger("change");

		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}

	}; // End $.fn.SPServices.SPConvertToSimpleDropdown


	// Function to display related information when an option is selected on a form.
	$.fn.SPServices.SPDisplayRelatedInfo = function(options) {

		var opt = $.extend({}, {
			columnName: "",						// The display name of the column in the form
			relatedWebURL: "",					// [Optional] The name of the Web (site) which contains the related list
			relatedList: "",					// The name of the list which contains the additional information
			relatedListColumn: "",				// The internal name of the related column in the related list
			relatedColumns: [],					// An array of related columns to display
			displayFormat: "table",				// The format to use in displaying the related information.  Possible values are: [table, list]
			headerCSSClass: "ms-vh2",			// CSS class for the table headers
			rowCSSClass: "ms-vb",				// CSS class for the table rows
			CAMLQuery: "",						// [Optional] For power users, this CAML fragment will be <And>ed with the default query on the relatedList
			numChars: 0,						// If used on an input column (not a dropdown), no matching will occur until at least this number of characters has been entered
			matchType: "Eq",					// If used on an input column (not a dropdown), type of match. Can be any valid CAML comparison operator, most often "Eq" or "BeginsWith"
			matchOnId: false,					// By default, we match on the lookup's text value. If matchOnId is true, we'll match on the lookup id instead.
			completefunc: null,					// Function to call on completion of rendering the change.
			debug: false						// If true, show error messages;if false, run silent
		}, options);

		var divId;
		var relatedColumnsXML = [];
		var relatedListXML;
		var thisFunction = "SPServices.SPDisplayRelatedInfo";

		// Find the column's select (dropdown)
		var columnSelect = new DropdownCtl(opt.columnName);
		if(columnSelect.Obj.html() === null && opt.debug) {errBox(thisFunction, "columnName: " + opt.columnName, TXTColumnNotFound); return; }

		// Generate a unique id for the container
		divId = genContainerId("SPDisplayRelatedInfo", opt.columnName);

		// Get information about the related list and its columns
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			webURL: opt.relatedWebURL,
			listName: opt.relatedList,
			completefunc: function(xData, Status) {
				// If debug is on, notify about an error
				$(xData.responseXML).find("faultcode").each(function() {
					if(opt.debug) {errBox(thisFunction, "relatedList: " + opt.relatedList, "List not found"); return; }
				});
				// Get info about the related list
				relatedListXML = $(xData.responseXML).find("List");
				// Save the information about each column requested
				for (i=0; i < opt.relatedColumns.length; i++) {
					relatedColumnsXML[i] = $(xData.responseXML).find("Fields > Field[Name='" + opt.relatedColumns[i] + "']");
				}
			}
		});

		switch(columnSelect.Type) {
			// Plain old select
			case "S":
				columnSelect.Obj.bind("change", function() {
					showRelated(opt, divId, relatedListXML, relatedColumnsXML);
				});
				break;
			// Input / Select hybrid
			case "C":
				// Bind to any change on the hidden input element
                $("input[id='" + columnSelect.Obj.attr("optHid") + "']").bind("propertychange", function() {
					showRelated(opt, divId, relatedListXML, relatedColumnsXML);
				});
				break;
			// Multi-select hybrid
			case "M":
				if(opt.debug) {errBox(thisFunction, "columnName: " + opt.columnName, "Multi-select columns not supported by this function"); }
				break;
			default:
				break;
		}
		// Fire the change to set the initially allowable values
		showRelated(opt, divId, relatedListXML, relatedColumnsXML);

	}; // End $.fn.SPServices.SPDisplayRelatedInfo

	function showRelated(opt, divId, relatedListXML, relatedColumnsXML) {

		var columnSelectSelected = null;
		var thisFunction = "SPServices.SPDisplayRelatedInfo";

		// Find the column's select (dropdown)
		var columnSelect = new DropdownCtl(opt.columnName);

		// Get the current column selection(s)
		columnSelectSelected = getDropdownSelected(columnSelect, opt.matchOnId);
		if(columnSelect.Type === "C" && opt.numChars > 0 && columnSelectSelected[0].length < opt.numChars) {
			return;
		}

		// If the selection hasn't changed, then there's nothing to do right now.  This is useful to reduce
		// the number of Web Service calls when the parentSelect.Type = "C", as there are multiple propertychanges
		// which don't require any action.
		if(columnSelect.Obj.attr("showRelatedSelected") === columnSelectSelected[0]) {
			return;
		}
		columnSelect.Obj.attr("showRelatedSelected", columnSelectSelected[0]);

		// Remove the old container...
		$("#" + divId).remove();
		// ...and append a new, empty one
		columnSelect.Obj.parent().append("<div id=" + divId + "></div>");

		// Get the list items which match the current selection
		var camlQuery = "<Query><Where>";
		if(opt.CAMLQuery.length > 0) {
			camlQuery += "<And>";
		}

		camlQuery += "<Eq><FieldRef Name='" + opt.relatedListColumn +
			(opt.matchOnId ? "' LookupId='True'/><Value Type='Integer'>" : "'/><Value Type='Text'>") +
			escapeColumnValue(columnSelectSelected[0]) + "</Value></Eq>";

		if(opt.CAMLQuery.length > 0) {
			camlQuery += opt.CAMLQuery + "</And>";
		}
		camlQuery += "</Where></Query>";

		var viewFields = " ";
		for (i=0; i < opt.relatedColumns.length; i++) {
			viewFields += "<FieldRef Name='" + opt.relatedColumns[i] + "' />";
		}

		$().SPServices({
			operation: "GetListItems",
			async: false,
			webURL: opt.relatedWebURL,
			listName: opt.relatedList,
			// Filter based on the column's currently selected value
			CAMLQuery: camlQuery,
			CAMLViewFields: "<ViewFields>" + viewFields +  "</ViewFields>",
			// Override the default view rowlimit and get all appropriate rows
			CAMLRowLimit: 0,
			completefunc: function(xData, Status) {

				// Handle errors
				$(xData.responseXML).find("errorstring").each(function() {
					var errorText = $(this).text();
					if(opt.debug && errorText === "One or more field types are not installed properly. Go to the list settings page to delete these fields.") {
						errBox(thisFunction,
							"relatedListColumn: " + opt.relatedListColumn,
							"Column not found in relatedList " + opt.relatedList);
					} else if (opt.debug && errorText === "Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).") {
						errBox(thisFunction,
							"relatedList: " + opt.relatedList,
							"List not found");
					}
					return;
				});

				var outString;
				// Output each row
				switch(opt.displayFormat) {
					// Only implementing the table format in the first iteration (v0.2.9)
					case "table":
						outString = "<table>";
						outString += "<tr>";
						for (i=0; i < opt.relatedColumns.length; i++) {
							if(typeof relatedColumnsXML[i] === 'undefined' && opt.debug) {errBox(thisFunction, "columnName: " + opt.relatedColumns[i], "Column not found in relatedList"); return; }
							outString += "<th class='" + opt.headerCSSClass + "'>" + relatedColumnsXML[i].attr("DisplayName") + "</th>";
						}
						outString += "</tr>";
						// Add an option for each child item
						$(xData.responseXML).SPFilterNode("z:row").each(function() {
							outString += "<tr>";
							for (i=0; i < opt.relatedColumns.length; i++) {
								outString += "<td class='" + opt.rowCSSClass + "'>" + showColumn(relatedListXML, relatedColumnsXML[i], $(this).attr("ows_" + opt.relatedColumns[i]), opt) + "</td>";
							}
							outString += "</tr>";
						});
						outString += "</table>";
						break;
					// list format implemented in v0.5.0. Still table-based, but vertical orientation.
					case "list":
						outString = "<table>";
						$(xData.responseXML).SPFilterNode("z:row").each(function() {
							for (i=0; i < opt.relatedColumns.length; i++) {
								if(typeof relatedColumnsXML[i] === 'undefined' && opt.debug) {errBox(thisFunction, "columnName: " + opt.relatedColumns[i], "Column not found in relatedList"); return; }
								outString += "<tr>";
								outString += "<th class='" + opt.headerCSSClass + "'>" + relatedColumnsXML[i].attr("DisplayName") + "</th>";
								outString += "<td class='" + opt.rowCSSClass + "'>" + showColumn(relatedListXML, relatedColumnsXML[i], $(this).attr("ows_" + opt.relatedColumns[i]), opt) + "</td>";
								outString += "</tr>";
							}
						});
						outString += "</table>";
						break;
					default:
						break;
				}
				// Write out the results
				$("#" + divId).html(outString);
			}
		});
		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}
	} // End showRelated

	// Function to filter a lookup based dropdown 
	$.fn.SPServices.SPFilterDropdown = function(options) {
		var opt = $.extend({}, {
			relationshipWebURL: "",				// [Optional] The name of the Web (site) which contains the relationshipList
			relationshipList: "",				// The name of the list which contains the lookup values
			relationshipListColumn: "",			// The internal name of the column in the relationship list
			relationshipListSortColumn: "",		// [Optional] If specified, sort the options in the dropdown by this column,
												// otherwise the options are sorted by relationshipListColumn
			columnName: "",						// The display name of the column in the form
			listName: $().SPServices.SPListNameFromUrl(),		// The list the form is working with. This is useful if the form is not in the list context.
			promptText: "",						// [DEPRECATED] Text to use as prompt. If included, {0} will be replaced with the value of columnName. IOrignal value "Choose {0}..."
			noneText: "(None)",					// [Optional] Text to use for the (None) selection. Provided for non-English language support.
			CAMLQuery: "",						// This CAML fragment will be applied to the relationshipList
			CAMLQueryOptions: "<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>", // Need this to mirror SharePoint's behavior, but it can be overridden
			completefunc: null,					// Function to call on completion of rendering the change.
			debug: false						// If true, show error messages; if false, run silent
		}, options);
	
		var choices = "";
		var columnSelectSelected = null;
		var master;
		var MultiLookupPickerdata;
		var newMultiLookupPickerdata;
		var columnColumnRequired;
		var thisFunction = "SPServices.SPFilterDropdown";
	
		// Find the column's select (dropdown)
		var columnSelect = new DropdownCtl(opt.columnName);
		if(columnSelect.Obj.html() === null && opt.debug) {errBox(thisFunction, "columnName: " + opt.columnName, TXTColumnNotFound); return;}
	
		// Get the current column selection(s)
		columnSelectSelected = getDropdownSelected(columnSelect, true);

		// Get the relationshipList items which match the current selection
		var sortColumn = (opt.relationshipListSortColumn.length > 0) ? opt.relationshipListSortColumn : opt.relationshipListColumn;
		var camlQuery = "<Query><OrderBy><FieldRef Name='" + sortColumn + "'/></OrderBy><Where>";
		if(opt.CAMLQuery.length > 0) {
			camlQuery += opt.CAMLQuery;
		}
		camlQuery += "</Where></Query>";
	
		// Get information about columnName from the current list
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			listName: opt.listName,
			completefunc: function(xData, Status) {
				$(xData.responseXML).find("Fields").each(function() {
					$(this).find("Field[DisplayName='" + opt.columnName + "']").each(function() {
						// Determine whether columnName is Required
						columnColumnRequired = ($(this).attr("Required") === "TRUE") ? true : false;
						// Stop looking; we're done
						return false;
					});
				});
			}
		});
		
		$().SPServices({
			operation: "GetListItems",
			// Force sync so that we have the right values for the column onchange trigger
			async: false,
			webURL: opt.relationshipWebURL,
			listName: opt.relationshipList,
			// Filter based on the specified CAML
			CAMLQuery: camlQuery,
			// Only get the columnName's data (plus columns we can't prevent)
			CAMLViewFields: "<ViewFields><FieldRef Name='" + opt.relationshipListColumn + "' /></ViewFields>",
			// Override the default view rowlimit and get all appropriate rows
			CAMLRowLimit: 0,
			// Even though setting IncludeMandatoryColumns to FALSE doesn't work as the docs describe, it fixes a bug in GetListItems with mandatory multi-selects
			CAMLQueryOptions: opt.CAMLQueryOptions,
			completefunc: function(xData, Status) {

				// Handle errors
				$(xData.responseXML).find("errorstring").each(function() {
					var errorText = $(this).text();
					if(opt.debug && errorText === "One or more field types are not installed properly. Go to the list settings page to delete these fields.") {
						errBox(thisFunction,
							"relationshipListColumn: " + opt.relationshipListColumn,
							"Not found in relationshipList " + opt.relationshipList);
					} else if (opt.debug && errorText === "Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).") {
						errBox(thisFunction,
							"relationshipList: " + opt.relationshipList,
							"List not found");
					}
					return;
				});

				// Add an explanatory prompt
				switch(columnSelect.Type) {
					case "S":
						// Remove all of the existing options
						$(columnSelect.Obj).find("option").remove();
						// If the column is required or the promptText option is empty, don't add the prompt text
						if(!columnColumnRequired && (opt.promptText.length > 0)) {
							columnSelect.Obj.append("<option value='0'>" + opt.promptText.replace(/\{0\}/g, opt.columnName) + "</option>");
						} else if(!columnColumnRequired){
							columnSelect.Obj.append("<option value='0'>" + opt.noneText + "</option>");
						}
						break;
					case "C":
						// If the column is required, don't add the "(None)" option
						choices = columnColumnRequired ? "" : opt.noneText + "|0";
						columnSelect.Obj.attr("value", "");
						break;
					case "M":
						// Remove all of the existing options
						$(columnSelect.Obj).find("option").remove();
						newMultiLookupPickerdata = "";
						break;
					default:
						break;
				}

				// Add an option for each item
				$(xData.responseXML).SPFilterNode("z:row").each(function() {
					
					var thisOptionId, thisOptionValue;

					// If relationshipListColumn is a Lookup column, then the ID should be for the Lookup value,
					// else the ID of the relationshipList item
					var thisValue = $(this).attr("ows_" + opt.relationshipListColumn);
					
					if(thisValue !== undefined && thisValue.indexOf(";#") > 0) {
						var splitValue = thisValue.split(";#");
						thisOptionId = splitValue[0];
						thisOptionValue = splitValue[1];
					} else {
						thisOptionId = $(this).attr("ows_ID");
						thisOptionValue = thisValue;						
					}

					// If the relationshipListColumn is a calculated column, then the value isn't preceded by the ID,
					// but by the datatype.  In this case, thisOptionId should be the ID of the relationshipList item.
					// e.g., float;#12345.67
					if(isNaN(thisOptionId)) {
						thisOptionId = $(this).attr("ows_ID");
					}
					
					switch(columnSelect.Type) {
						case "S":
							var selected = ($(this).attr("ows_ID") === columnSelectSelected[0]) ? " selected='selected'" : "";
							columnSelect.Obj.append("<option" + selected + " value='" + thisOptionId + "'>" + thisOptionValue + "</option>");
							break;
						case "C":
							if(thisOptionId === columnSelectSelected[0]) {
								columnSelect.Obj.attr("value", thisOptionValue);
							}
							choices = choices + ((choices.length > 0) ? "|" : "") + thisOptionValue + "|" + thisOptionId;
							break;
						case "M":
							columnSelect.Obj.append("<option value='" + thisOptionId + "'>" + thisOptionValue + "</option>");
							newMultiLookupPickerdata += thisOptionId + "|t" + thisOptionValue + "|t |t |t";
							break;
						default:
							break;
					}
				});
	
				switch(columnSelect.Type) {
					case "S":
						columnSelect.Obj.trigger("change");
						break;
					case "C":
						columnSelect.Obj.attr("choices", choices);
						columnSelect.Obj.trigger("propertychange");
						break;
					case "M":
						// Find the important bits of the multi-select
						MultiLookupPickerdata = columnSelect.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");
						master = window[columnSelect.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,'MultiLookupPicker_m')];
						currentSelection = columnSelect.Obj.closest("span").find("select[ID$='SelectResult']");
						// Clear the master
						master.data = "";

						MultiLookupPickerdata.attr("value", newMultiLookupPickerdata);
						// Clear any prior selections that are no longer valid
						$(currentSelection).find("option").each(function() {
							var thisSelected = $(this);
							$(this).attr("selected", "selected");
							$(columnSelect.Obj).find("option").each(function() {
								if($(this).html() === thisSelected.html()) {
									thisSelected.removeAttr("selected");
								}
							});
						});
						GipRemoveSelectedItems(master);
						// Hide any options in the candidate list which are already selected
						$(columnSelect.Obj).find("option").each(function() {
							var thisSelected = $(this);
							$(currentSelection).find("option").each(function() {
								if($(this).html() === thisSelected.html()) {
									thisSelected.remove();
								}
							});
						});
						GipAddSelectedItems(master);
						// Set master.data to the newly allowable values
						master.data = GipGetGroupData(newMultiLookupPickerdata);

						// Trigger a dblclick so that the child will be cascaded if it is a multiselect.
						columnSelect.Obj.trigger("dblclick");

						break;
					default:
						break;
				}
			}
		});
		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}
	}; // End $.fn.SPServices.SPFilterDropdown


	// Utility function to show the results of a Web Service call formatted well in the browser.
	$.fn.SPServices.SPDebugXMLHttpResult = function(options) {

		var opt = $.extend({}, {
			node: null,							// An XMLHttpResult object from an ajax call
			indent: 0							// Number of indents
		}, options);

		var i;
		var NODE_TEXT = 3;
		var NODE_CDATA_SECTION = 4;

		var outString = "";
		// For each new subnode, begin rendering a new TABLE
		outString += "<table class='ms-vb' style='margin-left:" + opt.indent * 3 + "px;' width='100%'>";
		// DisplayPatterns are a bit unique, so let's handle them differently
		if(opt.node.nodeName === "DisplayPattern") {
			outString += "<tr><td width='100px' style='font-weight:bold;'>" + opt.node.nodeName +
				"</td><td><textarea readonly='readonly' rows='5' cols='50'>" + opt.node.xml + "</textarea></td></tr>";
		// A node which has no children
		} else if (!opt.node.hasChildNodes()) {
			outString += "<tr><td width='100px' style='font-weight:bold;'>" + opt.node.nodeName +
				"</td><td>" + ((opt.node.nodeValue !== null) ? checkLink(opt.node.nodeValue) : "&nbsp;") + "</td></tr>";
			if (opt.node.attributes) {
				outString += "<tr><td colspan='99'>" + showAttrs(opt.node, opt) + "</td></tr>";
			}
		// A CDATA_SECTION node
		} else if (opt.node.hasChildNodes() && opt.node.firstChild.nodeType === NODE_CDATA_SECTION) {
			outString += "<tr><td width='100px' style='font-weight:bold;'>" + opt.node.nodeName +
				"</td><td><textarea readonly='readonly' rows='5' cols='50'>" + opt.node.parentNode.text + "</textarea></td></tr>";
		// A TEXT node
		} else if (opt.node.hasChildNodes() && opt.node.firstChild.nodeType === NODE_TEXT) {
			outString += "<tr><td width='100px' style='font-weight:bold;'>" + opt.node.nodeName +
				"</td><td>" + checkLink(opt.node.firstChild.nodeValue) + "</td></tr>";
		// Handle child nodes
		} else {
			outString += "<tr><td width='100px' style='font-weight:bold;' colspan='99'>" + opt.node.nodeName + "</td></tr>";
			if (opt.node.attributes) {
				outString += "<tr><td colspan='99'>" + showAttrs(opt.node, opt) + "</td></tr>";
			}
			// Since the node has child nodes, recurse
			outString += "<tr><td>";
			for (i = 0;i < opt.node.childNodes.length; i++) {
				outString += $().SPServices.SPDebugXMLHttpResult({
					node: opt.node.childNodes.item(i),
					indent: opt.indent + 1
				});
			}
			outString += "</td></tr>";
		}
		outString += "</table>";
		// Return the HTML which we have built up
		return outString;
	}; // End $.fn.SPServices.SPDebugXMLHttpResult

	// Function which returns the account name for the current user in DOMAIN\username format
	$.fn.SPServices.SPGetCurrentUser = function(options) {

		var opt = $.extend({}, {
			fieldName: "Name",				// Specifies which field to return from the userdisp.aspx page
			fieldNames: {},					// Specifies which fields to return from the userdisp.aspx page - added in v0.7.2 to allow multiple columns
			debug: false					// If true, show error messages; if false, run silent
		}, options);

		// The current user's ID is reliably available in an existing JavaScript variable
		if(opt.fieldName === "ID" && _spUserId != undefined) {
			return _spUserId;
		}

		var thisField = "";
		var theseFields = {};
		var fieldCount = opt.fieldNames.length > 0 ? opt.fieldNames.length : 1;
		var thisUserDisp;

		// Get the UserDisp.aspx page using AJAX
		$.ajax({
			// Need this to be synchronous so we're assured of a valid value
			async: false,
			// Force parameter forces redirection to a page that displays the information as stored in the UserInfo table rather than My Site.
			// Adding the extra Query String parameter with the current date/time forces the server to view this as a new request.
			url: $().SPServices.SPGetCurrentSite() + "/_layouts/userdisp.aspx?Force=True&" + new Date().getTime(),
			complete: function (xData, Status) {
				thisUserDisp = xData;
			}
		});

		for(i=0; i < fieldCount; i++) {

			// The current user's ID is reliably available in an existing JavaScript variable
			if(opt.fieldNames[i] === "ID") {
				thisField = _spUserId;
			} else {
				var thisTextValue;
				if(fieldCount > 1) {
					thisTextValue = RegExp("FieldInternalName=\"" + opt.fieldNames[i] + "\"", "gi");
				} else {
					thisTextValue = RegExp("FieldInternalName=\"" + opt.fieldName + "\"", "gi");
				}
				$(thisUserDisp.responseText).find("table.ms-formtable td[id^='SPField']").each(function() {
					if(thisTextValue.test($(this).html())) {
						// Each fieldtype contains a different data type, as indicated by the id
						switch($(this).attr("id")) {
							case "SPFieldText":
								thisField = $(this).text();
								break;
							case "SPFieldNote":
								thisField = $(this).find("div").html();
								break;
							case "SPFieldURL":
								thisField = $(this).find("img").attr("src");
								break;
							// Just in case
							default:
								thisField = $(this).text();
								break;						
						}
						// Stop looking; we're done
						return false;
					}
				});
			}
			if(opt.fieldNames[i] !== "ID") {
				thisField = (thisField !== undefined) ? thisField.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g, '') : null;
			}
			if(fieldCount > 1) {
				theseFields[opt.fieldNames[i]] = thisField;
			}
		}

		return (fieldCount > 1) ? theseFields : thisField;

	}; // End $.fn.SPServices.SPGetCurrentUser


	// Function which provides a link on a Lookup column for the user to follow
	// which allows them to add a new value to the Lookup list.
	// Based on http://blog.mastykarz.nl/extending-lookup-fields-add-new-item-option/
	// by Waldek Mastykarz
	$.fn.SPServices.SPLookupAddNew = function(options) {

		var opt = $.extend({}, {
			lookupColumn: "",				// The display name of the Lookup column
			promptText: "Add new {0}",		// Text to use as prompt + column name
			newWindow: false,				// If true, the link will open in a new window *without* passing the Source.
			ContentTypeID: "",				// [Optional] Pass the ContentTypeID if you'd like to specify it
			completefunc: null,				// Function to call on completion of rendering the change.
			debug: false					// If true, show error messages;if false, run silent
		}, options);

		var thisFunction = "SPServices.SPLookupAddNew";

		// Find the lookup column's select (dropdown)
		var lookupSelect = new DropdownCtl(opt.lookupColumn);
		if(lookupSelect.Obj.html() === null && opt.debug) { errBox(thisFunction, "lookupColumn: " + opt.lookupColumn, TXTColumnNotFound);return;}

		var newUrl = "";
		var lookupListUrl = "";
		var lookupColumnStaticName = "";
		// Use GetList for the current list to determine the details for the Lookup column
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			listName: $().SPServices.SPListNameFromUrl(),
			completefunc: function (xData, Status) {
				$(xData.responseXML).find("Field[DisplayName='" + opt.lookupColumn + "']").each(function() {
					lookupColumnStaticName = $(this).attr("StaticName");
					// Use GetList for the Lookup column's list to determine the list's URL
					$().SPServices({
						operation: "GetList",
						async: false,
						cacheXML: true,
						listName: $(this).attr("List"),
						completefunc: function (xData, Status) {
							$(xData.responseXML).find("List").each(function() {
								lookupListUrl = $(this).attr("WebFullUrl");
								// Need to handle when list is in the root site
								lookupListUrl = lookupListUrl !== SLASH ? lookupListUrl + SLASH : lookupListUrl;
							});
						}
					});
					// Get the NewItem form for the Lookup column's list
					newUrl = getListFormUrl($(this).attr("List"), "NewForm");
					// Stop looking;we're done
					return false;
				});
			}
		});

		if(lookupListUrl.length === 0 && opt.debug) {
			errBox(thisFunction, "lookupColumn: " + opt.lookupColumn, "This column does not appear to be a lookup column");
			return;
		}
		if(newUrl.length > 0) {
			// Build the link to the Lookup column's list enclosed in a div with the id="SPLookupAddNew_" + lookupColumnStaticName
			var newHref = lookupListUrl + newUrl;
			// If requested, open the link in a new window and if requested, pass the ContentTypeID
			newHref += opt.newWindow ?
					((opt.ContentTypeID.length > 0) ? "?ContentTypeID=" + opt.ContentTypeID : "") + "' target='_blank'" :
					"?" + ((opt.ContentTypeID.length > 0) ? "ContentTypeID=" + opt.ContentTypeID + "&" : "") + "Source=" + escapeUrl(location.href) + "'";
			newLink = "<div id='SPLookupAddNew_" + lookupColumnStaticName + "'>" + "<a href='" + newHref + ">" + opt.promptText.replace(/\{0\}/g, opt.lookupColumn) + "</a></div>";
			// Append the link to the Lookup columns's formbody table cell
			$(lookupSelect.Obj).parents("td.ms-formbody").append(newLink);
		} else if(opt.debug) {
			errBox(thisFunction, "lookupColumn: " + opt.lookupColumn, "NewForm cannot be found");
			return;
		}
		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}
	}; // End $.fn.SPServices.SPLookupAddNew

	// Function to return the ID of the last item created on a list by a specific user. Useful for maintaining parent/child relationships
	// between list forms
	$.fn.SPServices.SPGetLastItemId = function(options) {

		var opt = $.extend({}, {
			webURL: "",				// URL of the target Web.  If not specified, the current Web is used.
			listName: "",			// The name or GUID of the list
			userAccount: "",		// The account for the user in DOMAIN\username format. If not specified, the current user is used.
			CAMLQuery: ""			// [Optional] For power users, this CAML fragment will be Anded with the default query on the relatedList
		}, options);

		var userId;
		var lastId = 0;
		$().SPServices({
			operation: "GetUserInfo",
			webURL: opt.webURL,
			async: false,
			userLoginName: (opt.userAccount !== "") ? opt.userAccount : $().SPServices.SPGetCurrentUser(),
			completefunc: function (xData, Status) {
				$(xData.responseXML).find("User").each(function() {
					userId = $(this).attr("ID");
				});
			}
		});

		// Get the list items for the user, sorted by Created, descending. If the CAMLQuery option has been specified, And it with
		// the existing Where clause
		var camlQuery = "<Query><Where>";
		if(opt.CAMLQuery.length > 0) {
			camlQuery += "<And>";
		}
		camlQuery += "<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>" + userId + "</Value></Eq>";
		if(opt.CAMLQuery.length > 0) {
			camlQuery += opt.CAMLQuery + "</And>";
		}
		camlQuery += "</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";

		$().SPServices({
			operation: "GetListItems",
			async: false,
			webURL: opt.webURL,
			listName: opt.listName,
			CAMLQuery: camlQuery,
			CAMLViewFields: "<ViewFields><FieldRef Name='ID'/></ViewFields>",
			CAMLRowLimit: 1,
			CAMLQueryOptions: "<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",
			completefunc: function(xData, Status) {
				$(xData.responseXML).SPFilterNode("z:row").each(function() {
					lastId = $(this).attr("ows_ID");
				});
			}
		});
		return lastId;
	}; // End $.fn.SPServices.SPGetLastItemId
	
	// Function which checks to see if the value for a column on the form is unique in the list.
	$.fn.SPServices.SPRequireUnique = function (options) {

		var opt = $.extend({}, {
			columnStaticName: "Title",					// Name of the column
			duplicateAction: 0,							// 0 = warn, 1 = prevent
			ignoreCase: false,							// If set to true, the function ignores case, if false it looks for an exact match
			initMsg: "This value must be unique.",		// Initial message to display after setup
			initMsgCSSClass: "ms-vb",					// CSS class for initial message
			errMsg: "This value is not unique.",		// Error message to display if not unique
			errMsgCSSClass: "ms-formvalidation",		// CSS class for error message
			showDupes: false,							// If true, show links to the duplicate item(s) after the error message
			completefunc: null							// Function to call on completion of rendering the change.
		}, options);

		// Get the current item's ID from the Query String
		var queryStringVals = $().SPServices.SPGetQueryString();
		var thisID = queryStringVals.ID;
		var thisList = $().SPServices.SPListNameFromUrl();

		// Set the messages based on the options provided
		var msg = "<span id='SPRequireUnique" + opt.columnStaticName + "' class='{0}'>{1}</span><br/>";
		var firstMsg = msg.replace(/\{0\}/g, opt.initMsgCSSClass).replace(/\{1\}/g, opt.initMsg);
		
		// We need the DisplayName
		var columnDisplayName = $().SPServices.SPGetDisplayFromStatic({
			listName: thisList,
			columnStaticName: opt.columnStaticName
		});
		var columnObj = $("input[Title='" + columnDisplayName + "']");
		$(columnObj).parent().append(firstMsg);

		$(columnObj).blur(function () {
			var columnValueIDs = [];
			// Get the columnDisplayName's value
			var columnValue = $(this).attr("value");
			if(columnValue.length === 0) { return false; }

			// Call the Lists Web Service (GetListItems) to see if the value already exists
			$().SPServices({
				operation: "GetListItems",
				async: false,
				listName: thisList,
				// Make sure we get all the items, ignoring any filters on the default view.
				CAMLQuery: "<Query><Where><IsNotNull><FieldRef Name='" + opt.columnStaticName + "'/></IsNotNull></Where></Query>",
				// Filter based on columnStaticName's value
				CAMLViewFields: "<ViewFields><FieldRef Name='ID' /><FieldRef Name='" + opt.columnStaticName + "' /></ViewFields>",
				// Override the default view rowlimit and get all appropriate rows
				CAMLRowLimit: 0,
				completefunc: function(xData, Status) {
					var testValue = opt.ignoreCase ? columnValue.toUpperCase() : columnValue;
					$(xData.responseXML).SPFilterNode("z:row").each(function() {
						var thisValue = opt.ignoreCase ? $(this).attr("ows_" + opt.columnStaticName).toUpperCase() : $(this).attr("ows_" + opt.columnStaticName);
						// If this value already exists in columnStaticName and it's not the current item, then save the ID in the array
						if((testValue === thisValue) && ($(this).attr("ows_ID") !== thisID)) {
							columnValueIDs.push([$(this).attr("ows_ID"), $(this).attr("ows_" + opt.columnStaticName)]);
						}
					});
				}
			});
			var newMsg = opt.initMsg;
			$("span#SPRequireUnique" + opt.columnStaticName).html(newMsg).attr("class", opt.initMsgCSSClass);

			$("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled");
			if(columnValueIDs.length > 0) {
				newMsg = opt.errMsg;
				$("span#SPRequireUnique" + opt.columnStaticName).html(newMsg).attr("class", opt.errMsgCSSClass);
				if(opt.duplicateAction === 1) {
					$("input[Title='" + opt.columnDisplayName + "']").focus();
					$("input[value='OK'], input[value='Save']").attr("disabled", "disabled");
				}
				if(opt.showDupes) {
					var out = " " + columnValueIDs.length + " duplicate item" + (columnValueIDs.length > 1 ? "s" : "") + ": ";
					for (i=0;i < columnValueIDs.length; i++) {
						out += "<a href='DispForm.aspx?ID=" + columnValueIDs[i][0] + "&Source=" + location.href + "'>" + columnValueIDs[i][1] + "</a> ";
					}
					$("span#SPRequireUnique" + opt.columnStaticName).append(out);
				}
			}

		});
		// If present, call completefunc when all else is done
		if(opt.completefunc !== null) {
			opt.completefunc();
		}
	}; // End $.fn.SPServices.SPRequireUnique

	// This function returns the DisplayName for a column based on the StaticName.
	$.fn.SPServices.SPGetDisplayFromStatic = function (options) {

		var opt = $.extend({}, {
			webURL: "",						// URL of the target Web.  If not specified, the current Web is used.
			listName: "",					// The name or GUID of the list
			columnStaticName: "",			// StaticName of the column
			columnStaticNames: {}			// StaticName of the columns - added in v0.7.2 to allow multiple columns
		}, options);

		var displayName = "";
		var displayNames = {};
		var nameCount = opt.columnStaticNames.length > 0 ? opt.columnStaticNames.length : 1;

		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			webURL: opt.webURL,
			listName: opt.listName,
			completefunc: function(xData, Status) {
				if(nameCount > 1) {
					for(i=0; i < nameCount; i++) {
						displayNames[opt.columnStaticNames[i]] = $(xData.responseXML).find("Field[StaticName='" + opt.columnStaticNames[i] + "']").attr("DisplayName");
					}
				} else {
					displayName = $(xData.responseXML).find("Field[StaticName='" + opt.columnStaticName + "']").attr("DisplayName");
				}
			}
		});

		return (nameCount > 1) ? displayNames : displayName;

	}; // End $.fn.SPServices.SPGetDisplayFromStatic

	// This function returns the StaticName for a column based on the DisplayName.
	$.fn.SPServices.SPGetStaticFromDisplay = function (options) {

		var opt = $.extend({}, {
			webURL: "",						// URL of the target Web.  If not specified, the current Web is used.
			listName: "",					// The name or GUID of the list
			columnDisplayName: "",			// DisplayName of the column
			columnDisplayNames: {}			// DisplayNames of the columns - added in v0.7.2 to allow multiple columns
		}, options);

		var staticName = "";
		var staticNames = {};
		var nameCount = opt.columnDisplayNames.length > 0 ? opt.columnDisplayNames.length : 1;

		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			webURL: opt.webURL,
			listName: opt.listName,
			completefunc: function(xData, Status) {
				if(nameCount > 1) {
					for(i=0; i < nameCount; i++) {
						staticNames[opt.columnDisplayNames[i]] = $(xData.responseXML).find("Field[DisplayName='" + opt.columnDisplayNames[i] + "']").attr("StaticName");
					}
				} else {
					staticName = $(xData.responseXML).find("Field[DisplayName='" + opt.columnDisplayName + "']").attr("StaticName");
				}
			}
		});

		return (nameCount > 1) ? staticNames : staticName;

	}; // End $.fn.SPServices.SPGetStaticFromDisplay

	// This function allows you to redirect to a another page from a new item form with the new
	// item's ID. This allows chaining of forms from item creation onward.
	$.fn.SPServices.SPRedirectWithID = function (options) {

		var opt = $.extend({}, {
			redirectUrl: "",			// Page for the redirect
			qsParamName: "ID"			// In some cases, you may want to pass the newly created item's ID with a different
										// parameter name than ID. Specify that name here, if needed.
		}, options);

		var thisList = $().SPServices.SPListNameFromUrl();
		var queryStringVals = $().SPServices.SPGetQueryString();
		var lastID = queryStringVals.ID;
		var QSList = queryStringVals.List;
		var QSRootFolder = queryStringVals.RootFolder;
		var QSContentTypeId = queryStringVals.ContentTypeId;
		
		// On first load, change the form actions to redirect back to this page with the current lastID for this user and the
		// original Source.
		if(typeof queryStringVals.ID === 'undefined') {
			lastID = $().SPServices.SPGetLastItemId({
				listName: thisList
			});
			$("form[name='aspnetForm']").each(function() {
				// This page...
				var thisUrl = (location.href.indexOf("?") > 0) ? location.href.substring(0, location.href.indexOf("?")) : location.href;
				// ... plus the Source if it exists
				var thisSource = (typeof queryStringVals.Source === "string") ?
					"Source=" + queryStringVals.Source.replace(/\//g, "%2f").replace(/:/g, "%3a") : "";
				
				var newQS = [];
				if(typeof QSList !== 'undefined') {
					newQS.push("List=" + QSList);
				}
				if(typeof QSRootFolder !== 'undefined') {
					newQS.push("RootFolder=" + QSRootFolder);
				}
				if(typeof QSContentTypeId !== 'undefined') {
					newQS.push("ContentTypeId=" + QSContentTypeId);
				}

				var newAction = thisUrl +
					((newQS.length > 0) ? ("?" + newQS.join("&") + "&") : "?") +
					// Set the Source to point back to this page with the lastID this user has added
					"Source=" + thisUrl +
					"?ID=" + lastID +
					// Pass the original source as RealSource, if present
					((thisSource.length > 0) ? ("%26RealSource=" + queryStringVals.Source) : "") +
					// Pass the override RedirectURL, if present
					((typeof queryStringVals.RedirectURL === "string") ? ("%26RedirectURL=" + queryStringVals.RedirectURL) : "");
				$(this).attr("action", newAction);
			});
		// If this is the load after the item is saved, wait until the new item has been saved (commits are asynchronous),
		// then do the redirect to redirectUrl with the new lastID, passing along the original Source.
		} else {
			while(queryStringVals.ID === lastID) {
				lastID = $().SPServices.SPGetLastItemId({
					listName: thisList
				});
			}
			// If there is a RedirectURL parameter on the Query String, then redirect there instead of the value
			// specified in the options (opt.redirectUrl)
			var thisRedirectUrl = (typeof queryStringVals.RedirectURL === "string") ? queryStringVals.RedirectURL : opt.redirectUrl;
			location.href = thisRedirectUrl + "?" + opt.qsParamName + "=" + lastID +
				((typeof queryStringVals.RealSource === "string") ? ("&Source=" + queryStringVals.RealSource) : "");
		}
	}; // End $.fn.SPServices.SPRedirectWithID

	// The SPSetMultiSelectSizes function sets the sizes of the multi-select boxes for a column on a form automagically
	// based on the values they contain. The function takes into account the fontSize, fontFamily, fontWeight, etc., in its algorithm.
	$.fn.SPServices.SPSetMultiSelectSizes = function (options) {

		var opt = $.extend({}, {
			multiSelectColumn: "",
			minWidth: 0,
			maxWidth: 0,
			debug: false
		}, options);

		var thisFunction = "SPServices.SPSetMultiSelectSizes";

		// Find the multi-select column
		var thisMultiSelect = new DropdownCtl(opt.multiSelectColumn);
		if(thisMultiSelect.Obj.html() === null && opt.debug) { errBox(thisFunction, "multiSelectColumn: " + opt.multiSelectColumn, TXTColumnNotFound);return;}
		if(thisMultiSelect.Type !== "M" && opt.debug) { errBox(thisFunction, "multiSelectColumn: " + opt.multiSelectColumn, "Column is not multi-select.");return;}

		var possibleValues = thisMultiSelect.Obj;
		var selectedValues = possibleValues.closest("span").find("select[ID$='SelectResult']");

		// Create a temporary clone of the select to use to determine the appropriate width settings.
		// We'll append it to the end of the enclosing span.
		var cloneId = genContainerId("SPSetMultiSelectSizes", opt.multiSelectColumn);
		possibleValues.clone().appendTo(possibleValues.closest("span")).css({
			"width": "auto",		// We want the clone to resize its width based on the contents
			"height": 0,			// Just to keep the page clean while we are using the clone
			"visibility": "hidden"	// And let's keep it hidden
		}).attr({
			id: cloneId,			// We don't want the clone to have the same id as its source
			length: 0				// And let's start with no options
		});
		var cloneObj = $("#" + cloneId);

		// Add all the values to the cloned select.  First the left (possible values) select...
		possibleValues.find("option").each(function() {
			cloneObj.append("<option value='" + $(this).html() + "'>" + $(this).html() + "</option>");
		});
		// ...then the right (selected values) select (in case some values have already been selected)
		selectedValues.find("option").each(function() {
			cloneObj.append("<option value='" + $(this).html() + "'>" + $(this).html() + "</option>");
		});

		// We'll add 5px for a little padding on the right.
		var divWidth = $("#" + cloneId).width() + 5;
		var newDivWidth = divWidth;
		if(opt.minWidth > 0 || opt.maxWidth > 0) {
			if(divWidth < opt.minWidth) {
				divWidth = opt.minWidth;
			}
			if(newDivWidth < opt.minWidth) {
				newDivWidth = opt.minWidth;
			}
			if(newDivWidth > opt.maxWidth) {
				newDivWidth = opt.maxWidth;
			}
		}
		var selectWidth = divWidth;

		// Set the new widths
		possibleValues.css("width", selectWidth + "px").parent().css("width", newDivWidth + "px");
		selectedValues.css("width", selectWidth + "px").parent().css("width", newDivWidth + "px");

		// Remove the select's clone, since we're done with it
		$("#" + cloneId).remove();
	}; // End $.fn.SPServices.SPSetMultiSelectSizes

	// Does an audit of a site's list forms to show where script is in use.
	$.fn.SPServices.SPScriptAudit = function (options) {

		var opt = $.extend({}, {
			webURL: "",						// [Optional] The name of the Web (site) to audit
			listName: "",					// [Optional] The name of a specific list to audit. If not present, all lists in the site are audited.
			outputId: "",					// The id of the DOM object for output
			auditForms: true,				// Audit the form pages
			auditViews: true,				// Audit the view pages
			auditPages: true,				// Audit the Pages Document Library
			auditPagesListName: "Pages",	// The Pages Document Library(ies), if desired. Either a single string or an array of strings.
			showHiddenLists: false,			// Show output for hidden lists
			showNoScript: false,			// Show output for lists with no scripts (effectively "verbose")
			showSrc: true					// Show the source location for included scripts
		}, options);

		var formTypes = [["New", "NewForm.aspx", false], ["Display", "DispForm.aspx", false], ["Edit", "EditForm.aspx", false]];
		var listXml;

		// Build the table to contain the results
		$("#" + opt.outputId)
			.append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>" +
					"<tr>" +
						"<th></th>" +
						"<th>List</th>" +
						"<th>Page Class</th>" +
						"<th>Page Type</th>" +
						"<th>Page</th>" +
						(opt.showSrc ? "<th>Script References</th>" : "") +
					"</tr>" +
				"</table>");
		// Apply the CSS class to the headers
		$("#SPScriptAudit th").attr("class", "ms-vh2-nofilter");
		
		// Don't bother with the lists if the options don't require them
		if(opt.auditForms || opt.auditViews) {
			// First, get all of the lists within the site
			$().SPServices({
				operation: "GetListCollection",
				webURL: opt.webURL,
				async: false, // Need this to be synchronous so we're assured of a valid value
				completefunc: function (xData, Status) {
					$(xData.responseXML).find("List").each(function() {
						listXml = $(this);
							
						// If listName has been specified, then only return results for that list
						if((opt.listName.length === 0) || (listXml.attr("Title") === opt.listName)) {
							// Don't work with hidden lists unless we're asked to
							if((opt.showHiddenLists && listXml.attr("Hidden") === "False") || !opt.showHiddenLists) {
	
								// Audit the list's forms
								if(opt.auditForms) {
									// Get the list's Content Types, therefore the form pages
									$().SPServices({
										operation: "GetListContentTypes",
										webURL: opt.webURL,
										listName: listXml.attr("ID"),
										async: false, // Need this to be synchronous so we're assured of a valid value
										completefunc: function (xData, Status) {
											$(xData.responseXML).find("ContentType").each(function() {
												// Don't deal with folders
												if($(this).attr("ID").substring(0,6) !== "0x0120") {
													var formUrls = $(this).find("FormUrls");
													for(i=0; i < formTypes.length; i++) {
														// Look for a customized form...
														$(formUrls).find(formTypes[i][0]).each(function() {
															SPScriptAuditPage(opt, listXml, "Form", this.nodeName,
																((opt.webURL.length > 0) ? opt.webURL : $().SPServices.SPGetCurrentSite()) + SLASH + $(this).text());
															formTypes[i][2] = true;
														});
														// ...else the uncustomized form
														if(!formTypes[i][2]) {
															var defaultViewUrl = listXml.attr("DefaultViewUrl");
															SPScriptAuditPage(opt, listXml, "Form", formTypes[i][0],
																defaultViewUrl.substring(0, defaultViewUrl.lastIndexOf(SLASH)+1) + formTypes[i][1]);
														}
													}
													// Reset the form types
													for(i=0; i < formTypes.length; i++) {
														formTypes[i][2] = false;
													}
												}
											});
										}
									});
								}
	
								// Audit the list's views
								if(opt.auditViews) {
									// Get the list's Views
									$().SPServices({
										operation: "GetViewCollection",
										webURL: opt.webURL,
										listName: listXml.attr("ID"),
										async: false, // Need this to be synchronous so we're assured of a valid value
										completefunc: function (xData, Status) {
											$(xData.responseXML).find("View").each(function() {
												SPScriptAuditPage(opt, listXml, "View", $(this).attr("DisplayName"), $(this).attr("Url"));
											});
										}
									});
								}

							}
						}
					});
				}
			});
		}

		// Don't bother with auditing pages if the options don't require it
		var numLists = 0;
		var listsArray = [];
		if(typeof opt.auditPagesListName === "string") {
			numLists = 1;
			listsArray.push(opt.auditPagesListName);
		} else {
			numLists = opt.auditPagesListName.length;
			listsArray = opt.auditPagesListName;
		}
		
		if(opt.auditPages) {
			for(i=0; i < numLists; i++) {
				$().SPServices({
					operation: "GetList",
					async: false,
					cacheXML: true,
					webURL: opt.webURL,
					listName: listsArray[i],
					completefunc: function (xData, Status) {
						$(xData.responseXML).find("List").each(function() {
							listXml = $(this);
						});
					}
				});
				// Get all of the items from the Document Library
				$().SPServices({
					operation: "GetListItems",
					async: false,
					webURL: opt.webURL,
					listName: listsArray[i],
					CAMLQuery: "<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",
					CAMLViewFields: "<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",
					CAMLRowLimit: 0,
					completefunc: function(xData, Status) {
						$(xData.responseXML).SPFilterNode("z:row").each(function() {
							var thisPageUrl = $(this).attr("ows_FileRef").split(";#")[1];
							var thisPageType = (typeof $(this).attr("ows_Title") !== 'undefined') ? $(this).attr("ows_Title") : "";
							if(thisPageUrl.indexOf(".aspx") > 0) {
								SPScriptAuditPage(opt, listXml, "Page", thisPageType, SLASH + thisPageUrl);
							}
						});
					}
				});
			}
		}
		// Remove progress indicator and make the output pretty by cleaning up the ms-alternating CSS class
		$("#SPScriptAudit tr[class='ms-alternating']:even").removeAttr("class");
	}; // End $.fn.SPServices.SPScriptAudit

	// Displays the usage of scripts in a site
	function SPScriptAuditPage(opt, listXml, pageClass, pageType, pageUrl) {

		var i = 0;
		var jQueryPage = 0;
		var pageScriptSrc = {};
		pageScriptSrc.type = [];
		pageScriptSrc.src = [];
		pageScriptSrc.script = [];
		var scriptRegex = RegExp("<script[\\s\\S]*?/script>", "gi");

		// Fetch the page
		$.ajax({
			type: "GET",
			url: pageUrl,
			dataType: "text",
			async: false,
			success: function(xData) {

				while (scriptMatch = scriptRegex.exec(xData)) {
					var scriptLanguage = getScriptAttribute(scriptMatch, "language");
					var scriptType = getScriptAttribute(scriptMatch, "type");
					var scriptSrc = getScriptAttribute(scriptMatch, "src");
					if(scriptSrc !== null && scriptSrc.length > 0 && !coreScript(scriptSrc)) {
						pageScriptSrc.type.push((scriptLanguage !== null && scriptLanguage.length > 0) ? scriptLanguage : scriptType);
						pageScriptSrc.src.push(scriptSrc);
						jQueryPage++;
					}
				}

				// Only show pages without script if we've been asked to do so.
				if((!opt.showNoScript && (pageScriptSrc.type.length > 0)) || opt.showNoScript)  {
					var pagePath = pageUrl.substring(0, pageUrl.lastIndexOf(SLASH)+1);
					var out = "<tr class=ms-alternating>" +
						"<td class=ms-vb-icon><a href='" + listXml.attr("DefaultViewUrl") + "'><IMG border=0 src='" + listXml.attr("ImageUrl") + "'width=16 height=16></A></TD>" +
						"<td class=ms-vb2><a href='" + listXml.attr("DefaultViewUrl") + "'>" + listXml.attr("Title") + ((listXml.attr("Hidden") === "True") ? '(Hidden)' : '')+ "</td>" +
						"<td class=ms-vb2>" + pageClass + "</td>" +
						"<td class=ms-vb2>" + pageType + "</td>" +
						"<td class=ms-vb2><a href='" + pageUrl + "'>" + fileName(pageUrl) + "</td>";
					if(opt.showSrc) {
						var thisSrcPath; 
						out += "<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";
						for(i=0; i < pageScriptSrc.type.length; i++) {
							thisSrcPath = (pageScriptSrc.src[i].substr(0,1) !== SLASH) ? pagePath + pageScriptSrc.src[i] : pageScriptSrc.src[i];
							out += "<tr><td class=ms-vb2 width='30%'>" + pageScriptSrc.type[i] + "</td>";
							out += "<td class=ms-vb2 width='70%'><a href='" + thisSrcPath + "'>" + fileName(pageScriptSrc.src[i]) + "</td></tr>";
						}
						out += "</table></td>";
					}
					$("#SPScriptAudit").append(out);
				}
			}
		});
	} // End of function SPScriptAuditPage
	
	function getScriptAttribute(source, attribute) {
		var regex = RegExp(attribute + "=(\"([^\"]*)\")|('([^']*)')", "gi");
		if(matches = regex.exec(source)) {
			return matches[2];
		}
		return null;
	} // End of function getScriptAttribute

	// Check to see if the script reference is part of SharePoint core so that we can ignore it
	function coreScript(src) {
		var i;
		var coreScriptLocations = ["WebResource.axd", "_layouts"];
		for(i=0; i < coreScriptLocations.length; i++) {
			if(src.indexOf(coreScriptLocations[i]) > -1) {
				return true;	
			}
		}
		return false;
	} // End of function coreScript

	// Rearrange radio buttons or checkboxes in a form from vertical to horizontal display to save page real estate
	$.fn.SPServices.SPArrangeChoices = function (options) {

		var opt = $.extend({}, {
			listName: "",					// The list name for the current form
			columnName: "",					// The display name of the column in the form
			perRow: 99,						// Maximum number of choices desired per row.
			randomize: false				// If true, randomize the order of the options
		}, options);

		var columnFillInChoice = false;
		var columnOptions = [];
		var out;
		
		// Get information about columnName from the list to determine if we're allowing fill-in choices
		$().SPServices({
			operation: "GetList",
			async: false,
			cacheXML: true,
			listName: (opt.listName.length > 0) ? opt.listName : $().SPServices.SPListNameFromUrl(),
			completefunc: function(xData, Status) {
				$(xData.responseXML).find("Fields").each(function() {
					$(this).find("Field[DisplayName='" + opt.columnName + "']").each(function() {
						// Determine whether columnName allows a fill-in choice
						columnFillInChoice = ($(this).attr("FillInChoice") === "TRUE") ? true : false;
						// Stop looking;we're done
						return false;
					});
				});
			}
		});

		var thisFormField = findFormField(opt.columnName);
		
		var totalChoices = $(thisFormField).find("tr").length;
		var choiceNumber = 0;
		var fillinPrompt;
		var fillinInput;
		// Collect all of the choices
		$(thisFormField).find("tr").each(function() {
			choiceNumber++;
			// If this is the fill-in prompt, save it...
			if(columnFillInChoice && choiceNumber === (totalChoices - 1)) {
				fillinPrompt = $(this).find("td").html();
			// ...or if it is the fill-in input box, save it...
			} else if(columnFillInChoice && choiceNumber === totalChoices) {
				fillinInput = $(this).find("td").html();
			// ...else push into the columnOptions array.
			} else {
				columnOptions.push($(this).html());
			}
		});
		out = "<TR>";

		// If randomize is true, randomly sort the options
		if(opt.randomize) {
			columnOptions.sort(randOrd);
		}

		// Add all of the options to the out string
		for(i=0; i < columnOptions.length; i++) {
			out += columnOptions[i];
			// If we've already got perRow columnOptions in the row, close off the row
			if((i+1) % opt.perRow === 0) {
				out += "</TR><TR>";
			}
		}
		out += "</TR>";

		// If we are allowing a fill-in choice, add that option in a separate row at the bottom
		if(columnFillInChoice) {
			out += "<TR><TD colspan='99'>" + fillinPrompt + fillinInput + "</TD></TR>";
		}

		// Remove the existing rows...
		$(thisFormField).find("tr").remove();
		// ...and append the out string
		$(thisFormField).find("table").append(out);

	}; // End $.fn.SPServices.SPArrangeChoices

	// Provide suggested values from a list for in input column based on characters typed
	$.fn.SPServices.SPAutocomplete = function (options) {

		var opt = $.extend({}, {
			WebURL: "",							// [Optional] The name of the Web (site) which contains the sourceList
			sourceList: "",						// The name of the list which contains the values
			sourceColumn: "",					// The static name of the column which contains the values
			columnName: "",						// The display name of the column in the form
			CAMLQuery: "",						// [Optional] For power users, this CAML fragment will be Anded with the default query on the relatedList
			CAMLQueryOptions: "<QueryOptions></QueryOptions>",	// [Optional] For power users, allows specifying the CAMLQueryOptions for the GetListItems call
			CAMLRowLimit: 0,					// [Optional] Override the default view rowlimit and get all appropriate rows
			filterType: "BeginsWith",			// Type of filtering: [BeginsWith, Contains]
			numChars: 0,						// Wait until this number of characters has been typed before attempting any actions
			ignoreCase: false,					// If set to true, the function ignores case, if false it looks for an exact match
			highlightClass: "",					// If a class is supplied, highlight the matched characters in the values by applying that class to a wrapping span
			uniqueVals: false,					// If set to true, the function only adds unique values to the list (no duplicates)
			maxHeight: 99999,					// Sets the maximum number of values to display before scrolling occurs
			slideDownSpeed: "fast",				// Speed at which the div should slide down when values match (milliseconds or ["fast" | "slow"])
			processingIndicator: "_layouts/images/REFRESH.GIF",				// If present, show this while processing
			debug: false						// If true, show error messages;if false, run silent
		}, options);

		var matchNum;

		// Find the input control for the column and save some of its attributes
		var columnObj = $("input[Title='" + opt.columnName + "']");
		$("input[Title='" + opt.columnName + "']").css("position", "");
		var columnObjId = columnObj.attr("ID");
		var columnObjColor = columnObj.css("color");
		var columnObjWidth = columnObj.css("width");

		if(columnObj.html() === null && opt.debug) {
			errBox("SPServices.SPAutocomplete",
				"columnName: " + opt.columnName,
				"Column is not an input control or is not found on page");
			return;
		}

		// Remove the <br/> which isn't needed and messes up the formatting
		columnObj.closest("span").find("br").remove();
		columnObj.wrap("<div>");

		// Create a div to contain the matching values and add it to the DOM
		var containerId = genCo   ntainerId("SPAutocomplete", opt.columnName);		
		columnObj.after("<div><ul id='" + containerId + "' style='width:" + columnObjWidth + ";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");

		// Set the width to match the width of the input control
		$("#" + containerId).css("width", columnObjWidth);		

		// Handle keypresses
		$(columnObj).keyup(function () {

			// Get the column's value
			var columnValue = $(this).val();

			// Hide the container while we're working on it
			$("#" + containerId).hide();

			// Have enough characters been typed yet?
			if(columnValue.length < opt.numChars) {
				return false;
			}

			// Show the the processingIndicator as a background image in the input element
			columnObj.css({
				"background-image": "url(" + opt.processingIndicator + ")",
				"background-position": "right",
				"background-repeat": "no-repeat"
			});

			// Array to hold the matched values
			var matchArray = [];
			
			// Build the appropriate CAMLQuery
			var camlQuery = "<Query><OrderBy><FieldRef Name='" + opt.sourceColumn + "'/></OrderBy><Where>";
			if(opt.CAMLQuery.length > 0) {
				camlQuery += "<And>";
			}
			camlQuery += "<" + opt.filterType + "><FieldRef Name='" + opt.sourceColumn + "'/><Value Type='Text'>" + columnValue + "</Value></" + opt.filterType + ">";			
			if(opt.CAMLQuery.length > 0) {
				camlQuery += opt.CAMLQuery + "</And>";
			}
			camlQuery += "</Where></Query>";

			// Call GetListItems to find all of the potential values
			$().SPServices({
				operation: "GetListItems",
				async: false,
				webURL: opt.WebURL,
				listName: opt.sourceList,
				CAMLQuery: camlQuery,
				CAMLQueryOptions: opt.CAMLQueryOptions,
				CAMLViewFields: "<ViewFields><FieldRef Name='" + opt.sourceColumn + "' /></ViewFields>",
				CAMLRowLimit: opt.CAMLRowLimit,
				completefunc: function(xData, Status) {
					// Handle upper/lower case if ignoreCase = true
					var testValue = opt.ignoreCase ? columnValue.toUpperCase() : columnValue;
					// See which values match and add the ones that do to matchArray
					$(xData.responseXML).SPFilterNode("z:row").each(function() {
						var thisValue = $(this).attr("ows_" + opt.sourceColumn);
						var thisValueTest = opt.ignoreCase ? $(this).attr("ows_" + opt.sourceColumn).toUpperCase() : $(this).attr("ows_" + opt.sourceColumn);
						// Make sure we have a match...
						if(opt.filterType === "Contains") {
							var firstMatch = thisValueTest.indexOf(testValue);
							if((firstMatch >= 0) &&
								// ...and that the match is not already in the array if we want uniqueness
								(!opt.uniqueVals || ($.inArray(thisValue, matchArray) === -1))) {
								matchArray.push($(this).attr("ows_" + opt.sourceColumn));
							}
						} else {
							// Handles normal case, which is BeginsWith and and other unknown values
							if(testValue === thisValueTest.substr(0,testValue.length) &&
									// ...and that the match is not already in the array if we want uniqueness
									(!opt.uniqueVals || ($.inArray(thisValue, matchArray) === -1))) {
								matchArray.push($(this).attr("ows_" + opt.sourceColumn));
							}
						}
					});
				}
			});

			// Build out the set of list elements to contain the available values
			var out = "";
			for (i=0; i < matchArray.length; i++) {
				// If a highlightClass has been supplied, wrap a span around each match
				if(opt.highlightClass.length > 0) {
					// Set up Regex based on whether we want to ignore case
					var thisRegex = RegExp(columnValue, opt.ignoreCase ? "gi" : "g");
					// Look for all occurrences
					var matches = matchArray[i].match(thisRegex);
					var startLoc = 0;
					// Loop for each occurrence, wrapping each in a span with the highlightClass CSS class
					for (matchNum=0; matchNum < matches.length; matchNum++) {
						var thisPos = matchArray[i].indexOf(matches[matchNum], startLoc);
						var endPos = thisPos + matches[matchNum].length;
						var thisSpan = "<span class='" + opt.highlightClass + "'>" + matches[matchNum] + "</span>";
						matchArray[i] = matchArray[i].substr(0, thisPos) + thisSpan + matchArray[i].substr(endPos);
						startLoc = thisPos + thisSpan.length;
					}
				}
				// Add the value to the markup for the container
				out += "<li style='display: block;position: relative;cursor: pointer;'>" + matchArray[i] + "</li>";
			}
			
			// Add all the list elements to the containerId container
			$("#" + containerId).html(out);
			// Set up hehavior for the available values in the list element
			$("#" + containerId + " li").click(function () {
				$("#" + containerId).fadeOut(opt.slideUpSpeed);
				$("#" + columnObjId).val($(this).text());
			}).mouseover(function () {
				var mouseoverCss = {
					"cursor": "hand",
					"color": "#ffffff",
					"background": "#3399ff"
				};
				$(this).css(mouseoverCss);
			}).mouseout(function () {
				var mouseoutCss = {
					"cursor": "inherit",
					"color": columnObjColor,
					"background": "transparent"
				};
				$(this).css(mouseoutCss);
			});

			// If we've got some values to show, then show 'em!
			if(matchArray.length > 0) {
				$("#" + containerId).slideDown(opt.slideDownSpeed);
			}
			// Remove the processing indicator
			columnObj.css("background-image", "");
		});

	}; // End $.fn.SPServices.SPAutocomplete

	// Get the Query String parameters and their values and return in an array
	$.fn.SPServices.SPGetQueryString = function () {

		var i;
		var queryStringVals = {};

		var qs = location.search.substring(1, location.search.length);
		var args = qs.split("&");
		var rxQS = /^([^=]+)=(.*)/i;

		for (i=0; i < args.length; i++) {
			matches = rxQS.exec(args[i]);
			if (rxQS.test(location.href)) {
				if (matches !== null && matches.length > 2) {
					queryStringVals[matches[1]] = unescape(matches[2]).replace(/\+/g,' ');
				}
			}
		}
		return queryStringVals;

	}; // End $.fn.SPServices.SPGetQueryString

	// Get the current list's GUID (ID) from the current URL.  Use of this function only makes sense if we're in a list's context,
	// and we assume that we are calling it from an aspx page which is a form or view for the list.
	$.fn.SPServices.SPListNameFromUrl = function (options) {

		var opt = $.extend({}, {
			listName: ""		// [Optional] Pass in the name or GUID of a list if you are not in its context. e.g., on a Web Part pages in the Pages library
		}, options);

		// Has the name or GUID been passed in?
		if(opt.listName.length > 0) {
			thisList = opt.listName;
			return thisList;
		// Do we already know the current list?
		} else if(thisList.length > 0) {
			return thisList;
		}

		// Parse out the list's root URL from the current location or the passed url
		var thisPage = location.href;
		var thisPageBaseName = thisPage.substring(0, thisPage.indexOf(".aspx"));
		var listPath = decodeURIComponent(thisPageBaseName.substring(0, thisPageBaseName.lastIndexOf(SLASH) + 1)).toUpperCase();

		// Call GetListCollection and loop through the results to find a match with the list's URL to get the list's GUID
		$().SPServices({
			operation: "GetListCollection",
			async: false,
			completefunc: function(xData, Status) {
				$(xData.responseXML).find("List").each(function() {
					var defaultViewUrl = $(this).attr("DefaultViewUrl");
					var listCollList = defaultViewUrl.substring(0, defaultViewUrl.lastIndexOf(SLASH) + 1).toUpperCase();
					if(listPath.indexOf(listCollList) > 0) {
						thisList = $(this).attr("ID");
						return false;
					}
				});
			}
		});

		// Return the GUID (ID)
		return thisList;
	}; // End $.fn.SPServices.SPListNameFromUrl

	// SPUpdateMultipleListItems allows you to update multiple items in a list based upon some common characteristic or metadata criteria.
	$.fn.SPServices.SPUpdateMultipleListItems = function(options) {

		var opt = $.extend({}, {
			webURL: "",			// [Optional] URL of the target Web.  If not specified, the current Web is used.
			listName: "",		// The list to operate on.
			CAMLQuery: "",		// A CAML fragment specifying which items in the list will be selected and updated
			batchCmd: "Update",	// The operation to perform. By default, Update.
			valuepairs: [],		// Valuepairs for the update in the form [[fieldname1, fieldvalue1], [fieldname2, fieldvalue2]...]
			completefunc: null,	// Function to call on completion of rendering the change.
			debug: false		// If true, show error messages;if false, run silent
		}, options);

		var i;
		var itemsToUpdate = [];
		var documentsToUpdate = [];

		// Call GetListItems to find all of the items matching the CAMLQuery
		$().SPServices({
			operation: "GetListItems",
			async: false,
			webURL: opt.webURL,
			listName: opt.listName,
			CAMLQuery: opt.CAMLQuery,
			CAMLQueryOptions: "<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",
			completefunc: function(xData, Status) {
				$(xData.responseXML).SPFilterNode("z:row").each(function() {
					itemsToUpdate.push($(this).attr("ows_ID"));
					var fileRef = $(this).attr("ows_FileRef");
					fileRef = "/" + fileRef.substring(fileRef.indexOf(";#")+2);
					documentsToUpdate.push(fileRef);
				});
			}
		});

		var fieldNum;
		var batch = "<Batch OnError='Continue'>";
		for(i=0; i < itemsToUpdate.length; i++) {
			batch += "<Method ID='" + i + "' Cmd='" + opt.batchCmd + "'>";
			for (fieldNum=0; fieldNum < opt.valuepairs.length; fieldNum++) {
				batch += "<Field Name='" + opt.valuepairs[fieldNum][0] + "'>" + escapeColumnValue(opt.valuepairs[fieldNum][1]) + "</Field>";
			}
			batch += "<Field Name='ID'>" + itemsToUpdate[i] + "</Field>";
			if(documentsToUpdate[i].length > 0) {
				batch += "<Field Name='FileRef'>" + documentsToUpdate[i] + "</Field>";
			}
			batch += "</Method>";
		}
		batch += "</Batch>";

		// Call UpdateListItems to update all of the items matching the CAMLQuery
		$().SPServices({
			operation: "UpdateListItems",
			async: false,
			webURL: opt.webURL,
			listName: opt.listName,
			updates: batch,
			completefunc: function(xData, Status) {
				// If present, call completefunc when all else is done
				if(opt.completefunc !== null) {
					opt.completefunc(xData, Status);
				}
			}
		});

	}; // End $.fn.SPServices.SPUpdateMultipleListItems

	// This method for finding specific nodes in the returned XML was developed by Steve Workman. See his blog post
	// http://www.steveworkman.com/html5-2/javascript/2011/improving-javascript-xml-node-finding-performance-by-2000/
	// for performance details.
	$.fn.SPFilterNode = function(name) {
		return this.find('*').filter(function() {
			return this.nodeName === name;
		});
	}; // End $.fn.SPFilterNode


	// This function converts an XML node set to JSON
	// Initial implementation focuses only on GetListItems
	$.fn.SPXmlToJson = function(options) {

		var opt = $.extend({}, {
			mapping: {},			// columnName: mappedName: "mappedName", objectType: "objectType"
			includeAllAttrs: false, // If true, return all attributes, regardless whether they are in the mapping
			removeOws: true			// Specifically for GetListItems, if true, the leading ows_ will be stripped off the field name
		}, options);

		var colNum;
		var jsonObject = [];

		this.each(function() {
			var row = {};
			var colValue;
			var rowAttrs = this.attributes;

			// Bring back all mapped columns, even those with no value
			$.each(opt.mapping, function() { 
				row[this.mappedName] = ""; 
			});

			// Parse through the element's attributes
			for(attrNum = 0; attrNum < rowAttrs.length; attrNum++) {
				var thisAttrName = rowAttrs[attrNum].name;
				var thisMapping = opt.mapping[thisAttrName];
				var thisObjectName = thisMapping !== undefined ? thisMapping.mappedName : opt.removeOws ? thisAttrName.split("ows_")[1] : thisAttrName;
				var thisObjectType = thisMapping !== undefined ? thisMapping.objectType : undefined;
				if(opt.includeAllAttrs || thisMapping !== undefined) {
					row[thisObjectName] = attrToJson(rowAttrs[attrNum].value, thisObjectType);
				}
			}
			// Push this item into the JSON Object			
			jsonObject.push(row);

		});

		// Return the JSON object
		return jsonObject;

	}; // End $.fn.SPServices.SPXmlToJson


	function attrToJson(v, objectType) {

		switch (objectType) {
			case "DateTime":
			case "datetime": 							// For calculated columns, stored as datetime;#value
				// Dates have dashes instead of slashes: ows_Created="2009-08-25 14:24:48"
				colValue = dateToJsonObject(v);
				break;
			case "User":
				colValue = userToJsonObject(v);
				break;
			case "UserMulti":
				colValue = userMultiToJsonObject(v);
				break;
			case "Lookup":
				colValue = lookupToJsonObject(v);
				break;
			case "LookupMulti":
				colValue = lookupMultiToJsonObject(v);
				break;
			case "Boolean":
				colValue = booleanToJsonObject(v);
				break;
			case "Integer":
				colValue = intToJsonObject(v);
				break;
			case "Counter":
				colValue = intToJsonObject(v);
				break;
			case "MultiChoice":
				colValue = choiceMultiToJsonObject(v);
				break;
			case "Currency":
			case "float":							// For calculated columns, stored as float;#value
				colValue = floatToJsonObject(v);
				break;
			case "Calc":
				colValue = calcToJsonObject(v);
				break;
			default:
				// All other objectTypes will be simple strings
				colValue = stringToJsonObject(v);
				break;
		}
		return colValue;
	}

	function stringToJsonObject(s) {
		return s;
	}
	function intToJsonObject(s) {
		return parseInt(s, 10);
	}
	function floatToJsonObject(s) {
		return parseFloat(s);
	}
	function booleanToJsonObject(s) {
		var out = s === "0" ? false : true;
		return out;
	}
	function dateToJsonObject(s) {
		return new Date(s.replace(/-/g, "/"));
	}
   function userToJsonObject(s) {
        if (s.length === 0) {
			return null;
        } else {
            var thisUser = s.split(";#"); 
            var thisUserExpanded = thisUser[1].split(",#");
            if(thisUserExpanded.length == 1) {
                return {userId: thisUser[0], userName: thisUser[1]};
            } else {
                return {
					userId: thisUser[0], 
					userName: thisUserExpanded[0].replace( /(,,)/g, ","), 
					loginName: thisUserExpanded[1].replace( /(,,)/g, ","), 
					email: thisUserExpanded[2].replace( /(,,)/g, ","), 
					sipAddress: thisUserExpanded[3].replace( /(,,)/g, ","), 
					title: thisUserExpanded[4].replace( /(,,)/g, ",")
				};
            }
        }
    }
	function userMultiToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisUserMultiObject = [];
			var thisUserMulti = s.split(";#");
			for(i=0; i < thisUserMulti.length; i=i+2) {
				var thisUser = userToJsonObject(thisUserMulti[i] + ";#" + thisUserMulti[i+1]);
				thisUserMultiObject.push(thisUser);
			}
			return thisUserMultiObject;
		}
	}
	function lookupToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisLookup = s.split(";#");
			return {lookupId: thisLookup[0], lookupValue: thisLookup[1]};
		}
	}
	function lookupMultiToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisLookupMultiObject = [];
			var thisLookupMulti = s.split(";#");
			for(i=0; i < thisLookupMulti.length; i=i+2) {
				var thisLookup = lookupToJsonObject(thisLookupMulti[i] + ";#" + thisLookupMulti[i+1]);
				thisLookupMultiObject.push(thisLookup);
			}
			return thisLookupMultiObject;
		}
	}
	function choiceMultiToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisChoiceMultiObject = [];
			var thisChoiceMulti = s.split(";#");
			for(i=0; i < thisChoiceMulti.length; i++) {
				if(thisChoiceMulti[i].length !== 0) {
					thisChoiceMultiObject.push(thisChoiceMulti[i]);
				}
			}
			return thisChoiceMultiObject;
		}
	}
	function calcToJsonObject(s) {
		if(s.length === 0) {
			return null;
		} else {
			var thisCalc = s.split(";#");
			// The first value will be the calculated column value type, the second will be the value
			return attrToJson(thisCalc[1], thisCalc[0]);
		}
	}

	// Find a People Picker in the page
	// Returns references to:
	//   row - The TR which contains the People Picker (useful if you'd like to hide it at some point)
	//   contents - The element which contains the current value
	//   currentValue - The current value if it is set
	//   checkNames - The Check Names image (in case you'd like to click it at some point)
	$.fn.SPFindPeoplePicker = function(options) {

		var opt = $.extend({}, {
			peoplePickerDisplayName: "",	// The displayName of the People Picker on the form
			valueToSet: "",					// The value to set the People Picker to. Should be a string containing each username or groupname separated by semi-colons.
			checkNames: true				// If set to true, the Check Names image will be clicked to resolve the names
		}, options);

		var thisRow = $("nobr").filter(function() {
			// Ensures we get a match whether or not the People Picker is required (if required, the nobr contains a span also)
			return $(this).contents().eq(0).text() === opt.peoplePickerDisplayName;	
		}).closest("tr");

		var thisContents = thisRow.find("div[name='upLevelDiv']");
		var thisCheckNames = thisRow.find("img[Title='Check Names']:first");

		// If a value was provided, set the value
		if(opt.valueToSet.length > 0) {
			thisContents.html(opt.valueToSet);
		}

		// If checkName is true, click the check names icon
		if(opt.checkNames) {
			thisCheckNames.click();
		}
		var thisCurrentValue = $.trim(thisContents.text());

		// Parse the entity data
		var dictionaryEntries = [];

		// IE
		thisContents.children("span").each(function() {
		
			// Grab the entity data
			var thisData = $(this).find("div[data]").attr("data");

			var dictionaryEntry = {};

			// Entity data is only available in IE
			if(thisData != undefined) {
				var arrayOfDictionaryEntry = $.parseXML(thisData);
				$xml = $(arrayOfDictionaryEntry);

				$xml.find("DictionaryEntry").each(function() {
					var key = $(this).find("Key").text();
					var value = $(this).find("Value").text();
					dictionaryEntry[key] = value;
				});
				dictionaryEntries.push(dictionaryEntry);
			// For other browsers, we'll call GetUserInfo to get the data
			} else {
				$().SPServices({
					operation: "GetUserInfo",
					async: false,
					cacheXML: true,
					userLoginName: $(this).attr("title"),
					completefunc: function(xData, Status) {

						$(xData.responseXML).find("User").each(function() {
						
							$.each(this.attributes, function(i, attrib){ 
								var key = attrib.name; 
								var value = attrib.value; 
								dictionaryEntry[key] = value;
							});						
							dictionaryEntries.push(dictionaryEntry);
						});
					}
				});
			}	
		});
	
		return {row: thisRow, contents: thisContents, currentValue: thisCurrentValue, checkNames: thisCheckNames, dictionaryEntries: dictionaryEntries};
	};

	// Return the current version of SPServices as a string
	$.fn.SPServices.Version = function () {

		return VERSION;

	}; // End $.fn.SPServices.Version



////// PRIVATE FUNCTIONS ////////

	// Display a column (field) formatted correctly based on its definition in the list.
	// NOTE: Currently not dealing with locale differences.
	//   columnXML			The XML node for the column from a GetList operation
	//   columnValue		The text representation of the column's value
	//   opt				The current set of options
	function showColumn(listXML, columnXML, columnValue, opt) {

		if(typeof columnValue === 'undefined') {
			return "";
		}

		var i;
		var outString = "";
		var dispUrl;
		var numDecimals;
		var outArray =[];
		var webUrl = opt.relatedWebURL.length > 0 ? opt.relatedWebURL : $().SPServices.SPGetCurrentSite();

		switch(columnXML.attr("Type")) {
			case "Text":
				outString = columnValue;
				break;
			case "URL":
				switch(columnXML.attr("Format")) {
					// URL as hyperlink
					case "Hyperlink":
						outString = "<a href='" + columnValue.substring(0, columnValue.search(",")) + "'>" +
							columnValue.substring(columnValue.search(",") + 1) + "</a>";
						break;
					// URL as image
					case "Image":
						outString = "<img alt='" + columnValue.substring(columnValue.search(",") + 1) +
							"' src='" + columnValue.substring(0, columnValue.search(",")) + "'/>";
						break;
					// Just in case
					default:
						outString = columnValue;
						break;						
				}
				break;
			case "User":
			case "UserMulti":
				var userMultiValues = columnValue.split(";#");
				for(i=0; i < userMultiValues.length; i = i+2) {
					outArray.push("<a href='/_layouts/userdisp.aspx?ID=" + userMultiValues[i] +
						"&Source=" + escapeUrl(location.href) + "'>" +
						userMultiValues[i+1] +  "</a>");
				}
				outString = outArray.join(", ");
				break;
			case "Calculated":
				var calcColumn = columnValue.split(";#");
				outString = calcColumn[1];
				break;
			case "Number":
				numDecimals = columnXML.attr("Decimals");
				outString = numDecimals === undefined ?
					parseFloat(columnValue).toString() :
					parseFloat(columnValue).toFixed(numDecimals).toString();
				break;
			case "Currency":
				numDecimals = columnXML.attr("Decimals");
				outString = numDecimals === undefined ?
					parseFloat(columnValue).toFixed(2).toString() :
					parseFloat(columnValue).toFixed(numDecimals).toString();
				break;
			case "Lookup":
				switch(columnXML.attr("Name")) {
					case "FileRef":
						// Get the display form URL for the lookup source list
						dispUrl = listXML.attr("BaseType") === "1" ? listXML.attr("RootFolder") + SLASH + "Forms/DispForm.aspx" :
							listXML.attr("RootFolder") + SLASH + "DispForm.aspx";
						outString = "<a href='" + dispUrl +
							"?ID=" + columnValue.substring(0, columnValue.search(";#")) + "&RootFolder=*&Source=" + escapeUrl(location.href) + "'>" +
							columnValue.substring(columnValue.search(";#") + 2) + "</a>";
						break;
					case "FileDirRef":
						// Get the display form URL for the lookup source list
						dispUrl = SLASH + columnValue.substring(columnValue.search(";#") + 2);
						outString = "<a href='" + dispUrl + "'>" +
							columnValue.substring(columnValue.search(";#") + 2) + "</a>";
						break;
					// Any other lookup column
					default:
						// Get the display form URL for the lookup source list
						dispUrl = getListFormUrl(columnXML.attr("List"), "DisplayForm");
						outString = "<a href='" + opt.relatedWebURL + SLASH + dispUrl +
							"?ID=" + columnValue.substring(0, columnValue.search(";#")) + "&RootFolder=*&Source=" + escapeUrl(location.href) + "'>" +
							columnValue.substring(columnValue.search(";#") + 2) + "</a>";
						break;						
				}
				break;
			case "LookupMulti":
				// Get the display form URL for the lookup source list
				dispUrl = getListFormUrl(columnXML.attr("List"), "DisplayForm");
				// Show all the values as links to the items, separated by commas
				outString = "";
				if(columnValue.length > 0) {
					var lookupMultiValues = columnValue.split(";#");
					for(i=0; i < lookupMultiValues.length / 2; i++) {
						outArray.push("<a href='" + webUrl + SLASH + dispUrl +
							"?ID=" + lookupMultiValues[i * 2] + "&RootFolder=*&Source=" + escapeUrl(location.href) + "'>" +
							lookupMultiValues[(i * 2) + 1] + "</a>");
					}
				}
				outString = outArray.join(", ");
				break;
			case "File":
				fileName = columnValue.substring(columnValue.search(";#") + 2);
				outString = "<a href='" + listXML.attr("RootFolder") + SLASH + fileName + "'>" + fileName + "</a>";
				break;
			case "Counter":
				outString = columnValue;
				break;
			case "DateTime":
				outString = columnValue;
				break;
			default:
				outString = columnValue;
				break;
		}
		return outString;
	} // End of function showColumn

	// Show a single attribute of a node, enclosed in a table
	//   node				The XML node
	//   opt				The current set of options
	function showAttrs(node, opt) {
		var i;
		var out = "<table class='ms-vb' width='100%'>";
		for (i=0; i < node.attributes.length; i++) {
			out += "<tr><td width='10px' style='font-weight:bold;'>" + i + "</td><td width='100px'>" +
				node.attributes.item(i).nodeName + "</td><td>" + checkLink(node.attributes.item(i).nodeValue) + "</td></tr>";
		}
		out += "</table>";
		return out;
	} // End of function showAttrs

	// Find a dropdown (or multi-select) in the DOM. Returns the dropdown onject and its type:
	// S = Simple (select);C = Compound (input + select hybrid);M = Multi-select (select hybrid)
	function DropdownCtl(colName) {
		// Simple
		if((this.Obj = $("select[Title='" + colName + "']")).length === 1) {
			this.Type = "S";
		// Compound
		} else if((this.Obj = $("input[Title='" + colName + "']")).length === 1) {
			this.Type = "C";
		// Multi-select: This will find the multi-select column control in English and most other languages sites where the Title looks like 'Column Name possible values'
		} else if((this.Obj = $("select[ID$='SelectCandidate'][Title^='" + colName + " ']")).length === 1) {
			this.Type = "M";
		// Multi-select: This will find the multi-select column control on a Russian site (and perhaps others) where the Title looks like 'Выбранных значений: Column Name'
		} else if((this.Obj = $("select[ID$='SelectCandidate'][Title$=': " + colName + "']")).length === 1) {
			this.Type = "M";
		// Multi-select: This will find the multi-select column control on a German site (and perhaps others) where the Title looks like 'Mögliche Werte für &quot;Column name&quot;.'
		} else if((this.Obj = $("select[ID$='SelectCandidate'][Title$='\"" + colName + "\".']")).length === 1) {
			this.Type = "M";
		// Multi-select: This will find the multi-select column control on a Italian site (and perhaps others) where the Title looks like "Valori possibili Column name"
		} else if((this.Obj = $("select[ID$='SelectCandidate'][Title$=' " + colName + "']")).length === 1) {
			this.Type = "M";
		} else {
			this.Type = null;
		}
	} // End of function DropdownCtl

	// Returns the selected value(s) for a dropdown in an array. Expects a dropdown object as returned by the DropdownCtl function.
	// If matchOnId is true, returns the ids rather than the text values for the selection options(s).
	function getDropdownSelected(columnSelect, matchOnId) {

		var columnSelectSelected = [];
		
		switch(columnSelect.Type) {
			case "S":
				if(matchOnId) {
					columnSelectSelected.push(columnSelect.Obj.find("option:selected").val() || []);
				} else {
					columnSelectSelected.push(columnSelect.Obj.find("option:selected").text() || []);
				}
				break;
			case "C":
				if(matchOnId) {
					columnSelectSelected.push($("input[id='"+ columnSelect.Obj.attr("optHid") + "']").val() || []);
				} else {
					columnSelectSelected.push(columnSelect.Obj.attr("value") || []);
				}				
				break;
			case "M":
				var columnSelections = columnSelect.Obj.closest("span").find("select[ID$='SelectResult']");
				$(columnSelections).find("option").each(function() {
					columnSelectSelected.push($(this).html());
				});
				break;
			default:
				break;
		}
		return columnSelectSelected;

	} // End of function getDropdownSelected
	
	// Build an error message based on passed parameters
	function errBox(func, param, msg) {
		var errMsg = "<b>Error in function</b><br/>" + func + "<br/>" +
			"<b>Parameter</b><br/>" + param + "<br/>" +
			"<b>Message</b><br/>" + msg + "<br/><br/>" +
			"<span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";
		modalBox(errMsg);
	} // End of function errBox

	// Call this function to pop up a branded modal msgBox
	function modalBox(msg) {
		var boxCSS = "position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";
		$("#aspnetForm").parent().append("<div id='SPServices_msgBox' style=" + boxCSS + ">" + msg);
		var height = $("#SPServices_msgBox").height();
		var width = $("#SPServices_msgBox").width();
		var leftVal = ($(window).width() / 2) - (width / 2) + "px";
		var topVal = ($(window).height() / 2) - (height / 2) - 100 + "px";
		$("#SPServices_msgBox").css({border:'5px #C02000 solid', left:leftVal, top:topVal}).show().fadeTo("slow", 0.75).click(function () {
			$(this).fadeOut("3000", function () {
				$(this).remove();
			});
		});
	} // End of function modalBox

	// Generate a unique id for a containing div using the function name and the column display name
	function genContainerId(funcname, columnName) {
		return funcname + "_" + $().SPServices.SPGetStaticFromDisplay({
			listName: $().SPServices.SPListNameFromUrl(),
			columnDisplayName: columnName
		});
	} // End of function genContainerId
	
	// Get the URL for a specified form for a list
	function getListFormUrl(l, f) {

		var thisForm, u;

		$().SPServices({
			operation: "GetFormCollection",
			async: false,
			listName: l,
			completefunc: function (xData, Status) {
				u = $(xData.responseXML).find("Form[Type='" + f + "']").attr("Url");;
			}
		});
		return u;

	} // End of function getListFormUrl

	// Add the option values to the SOAPEnvelope.payload for the operation
	//	opt = options for the call
	//	paramArray = an array of option names to add to the payload
	//		"paramName" if the parameter name and the option name match
	//		["paramName", "optionName"] if the parameter name and the option name are different (this handles early "wrappings" with inconsistent naming)
	function addToPayload(opt, paramArray) {

		var i;

		for (i=0; i < paramArray.length; i++) {
			// the parameter name and the option name match
			if(typeof paramArray[i] === "string") {
				SOAPEnvelope.payload += wrapNode(paramArray[i], opt[paramArray[i]]);
			// the parameter name and the option name are different 
			} else if(paramArray[i].length === 2) {
				SOAPEnvelope.payload += wrapNode(paramArray[i][0], opt[paramArray[i][1]]);
			// something isn't right, so report it
			} else {
				errBox(opt.operation, "paramArray[" + i + "]: " + paramArray[i], "Invalid paramArray element passed to addToPayload()");
			}
		}
	} // End of function addToPayload

	// Finds the td which contains a form field in default forms using the comment which contains:
	//   <!--  FieldName="Title"
	//		 FieldInternalName="Title"
	//		 FieldType="SPFieldText"
	//	   -->
	// as the "anchor" to find it. Necessary because SharePoint doesn't give all field types ids or specific classes.
	function findFormField(columnName) {
		var thisFormBody;
		// There's no easy way to find one of these columns; we'll look for the comment with the columnName
		var searchText = RegExp("FieldName=\"" + columnName.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&") + "\"", "gi");
		// Loop through all of the ms-formbody table cells
		$("td.ms-formbody, td.ms-formbodysurvey").each(function() {
			// Check for the right comment
			if(searchText.test($(this).html())) {
				thisFormBody = $(this);
				// Found it, so we're done
				return false;
			}
		});
		return thisFormBody;
	} // End of function findFormField
	
	// The SiteData operations have the same names as other Web Service operations. To make them easy to call and unique, I'm using
	// the SiteData prefix on their names. This function replaces that name with the right name in the SOAPEnvelope.
	function siteDataFixSOAPEnvelope(SOAPEnvelope, siteDataOperation) {
		var siteDataOp = siteDataOperation.substring(8);
		SOAPEnvelope.opheader = SOAPEnvelope.opheader.replace(siteDataOperation, siteDataOp);
		SOAPEnvelope.opfooter = SOAPEnvelope.opfooter.replace(siteDataOperation, siteDataOp);
		return SOAPEnvelope;
	} // End of function siteDataFixSOAPEnvelope

	// Wrap an XML node (n) around a value (v)
	function wrapNode(n, v) {
		var thisValue = v !== undefined ? v : "";
		return "<" + n + ">" + thisValue + "</" + n + ">";
	}

	// Generate a random number for sorting arrays randomly
	function randOrd() {
		return (Math.round(Math.random())-0.5);
	}

	// If a string is a URL, format it as a link, else return the string as-is
	function checkLink(s) {
		return ((s.indexOf("http") === 0) || (s.indexOf(SLASH) === 0)) ? "<a href='" + s + "'>" + s + "</a>" : s;
	}

	// Get the filename from the full URL
	function fileName(s) {
		return s.substring(s.lastIndexOf(SLASH)+1,s.length);
	}

	// Escape string characters
	function escapeHTML(s) {
		return s.replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
	}

	// Escape column values
	function escapeColumnValue(s) {
		if(typeof s === "string") {
			return s.replace(/&(?![a-zA-Z]{1,8};)/g, "&amp;");
		} else {
			return s;
		}
	}

	// Escape Url
	function escapeUrl(u) {
		return u.replace(/&/g,'%26');
	}

})(jQuery);Ә٢  x      f      VERSION    $~      0.7.2      p      SLASH      \       TXTColumnNotFound             Column not found on page   9t      SCHEMASharePoint   s'      http://schemas.microsoft.com/sharepoint    lu      ALERTS     \F%      Alerts	     %q      AUTHENTICATION
     1      Authentication           COPY   \      Copy   m9      FORMS      Q      Forms      F
>      LISTS      ~      Lists      Jx      MEETINGS   wf      Meetings   *      PEOPLE     G      People     ͆      PERMISSIONS    Zu      Permissions    U      PUBLISHEDLINKSSERVICE      ?      PublishedLinksService      +4      SEARCH     Di      Search     pzB      SHAREPOINTDIAGNOSTICS      CG      SharePointDiagnostics      4lU      SITEDATA   V4      SiteData         SITES       G"      Sites!      (      SOCIALDATASERVICE"            SocialDataService#      
      SPELLCHECK$     V
      SpellCheck%     ީ8      TAXONOMYSERVICE&    ^      TaxonomyClientService'      uP	      USERGROUP(      ZX{	      usergroup)      i{      USERPROFILESERVICE*     f3      UserProfileService+     F      VERSIONS,   k      Versions-   WC      VIEWS.      @ˎ      Views/      Cƕ      WEBPARTPAGES0   "      WebPartPages1   l      WEBS2   9      Webs3   (      WORKFLOW4   Ͷ2o      Workflow5   $s      thisSite6   I      thisList7         WSops8      Ng,	      GetAlerts9      9]P      DeleteAlerts:         Mode;         Login<      ?/"i      CopyIntoItems=      zH      CopyIntoItemsLocal>     tR      GetItem?    *      GetForm@          GetFormCollectionA      j:      AddAttachmentB      f;      AddDiscussionBoardItemC     P
      AddListD    (      AddListFromFeatureE     7Y      ApplyContentTypeToListF      (      CheckInFileG     ~      CheckOutFileH   X~      CreateContentTypeI      &ݪ      DeleteAttachmentJ   )!Q      DeleteContentTypeK      ~"      DeleteContentTypeXmlDocumentL   
{
      DeleteListM     4      GetAttachmentCollectionN          GetListO    M+      GetListAndViewP     u      GetListCollectionQ      bƈl      GetListContentTypeR     Ƹ      GetListContentTypesS    !@      GetListItemChangesT     |      GetListItemChangesSinceTokenU   q\      GetListItemsV   p%_!      GetVersionCollectionW   P      UndoCheckOutX   't      UpdateContentTypeY      K      UpdateContentTypesXmlDocumentZ      ʱ      UpdateContentTypeXmlDocument[   y
      UpdateList\           UpdateListItems]    !ў
      AddMeeting^     L^      CreateWorkspace_    6      RemoveMeeting`      f5      SetWorkSpaceTitlea      I^=      ResolvePrincipalsb            SearchPrincipalsc   VG      AddPermissiond      1
      AddPermissionCollectione    s      GetPermissionCollectionf    ܼ      RemovePermissiong   GJl      RemovePermissionCollectionh     gt      UpdatePermissioni   9e4      GetLinksj   e      GetPortalSearchInfok    yI      GetQuerySuggestionsl    su      GetSearchMetadatam      ]<      Queryn      "8      QueryExo    4      Registrationp         Statusq     }      SendClientScriptErrorReportr    B˖      GetAttachmentss     Z      EnumerateFoldert    ,      SiteDataGetListu    R      SiteDataGetListCollectionv      k̓      SiteDataGetSitew    y      SiteDataGetSiteUrlx     b      SiteDataGetWeby     =	      CreateWebz      :U	      DeleteWeb{      Y      GetSite|    ج      GetSiteTemplates}   g
      AddComment~     QI      AddTag     z      AddTagByKeyword    Ŗc      CountCommentsOfUser    !?{      CountCommentsOfUserOnUrl         CountCommentsOnUrl     i      CountRatingsOnUrl      Ql      CountTagsOfUser    Ltk      DeleteComment      dᆄ      DeleteRating   LX1~	      DeleteTag      D>T      DeleteTagByKeyword     S9
      DeleteTags     <      GetAllTagTerms     mf      GetAllTagTermsForUrlFolder     b      GetAllTagUrls      :Z      GetAllTagUrlsByKeyword     3      GetCommentsOfUser      ٞ      GetCommentsOfUserOnUrl     (      GetCommentsOnUrl         GetRatingAverageOnUrl      q.5      GetRatingOfUserOnUrl   bN      GetRatingOnUrl     a@)I      GetRatingsOfUser   p      GetRatingsOnUrl    T      GetSocialDataForFullReplication    L      GetTags    )      GetTagsOfUser      OK      GetTagTerms          GetTagTermsOfUser      Ԇ      GetTagTermsOnUrl   )      GetTagUrlsOfUser   N      GetTagUrlsOfUserByKeyword      {
      GetTagUrls     nx      GetTagUrlsByKeyword    g	      SetRating      qf      UpdateComment      7[      AddTerms   oT      GetChildTermsInTerm          GetChildTermsInTermSet     ;      GetKeywordTermsByGuids     >B      GetTermsByLabel    R1      GetTermSets    I      AddGroup   Z$      AddGroupToRole     )dF      AddRole    %
      AddRoleDef     )      AddUserCollectionToGroup   ]      AddUserCollectionToRole    Ø      AddUserToGroup     c8      AddUserToRole      	CA      GetAllUserCollectionFromWeb    Y!      GetGroupCollection     򙶃      GetGroupCollectionFromRole     f      GetGroupCollectionFromSite     	      GetGroupCollectionFromUser           GetGroupCollectionFromWeb       r      GetGroupInfo         GetRoleCollection      rt      GetRoleCollectionFromGroup           GetRoleCollectionFromUser      Y*      GetRoleCollectionFromWeb   NhX      GetRoleInfo    H $      GetRolesAndPermissionsForCurrentUser   
      GetRolesAndPermissionsForSite      8b      GetUserCollection      &6      GetUserCollectionFromGroup     ·      GetUserCollectionFromRole      ɜ      GetUserCollectionFromSite      t      GetUserCollectionFromWeb   P      GetUserInfo          GetUserLoginFromEmail      Uf      RemoveGroup    4      RemoveGroupFromRole    U
      RemoveRole     `      RemoveUserCollectionFromGroup      '      RemoveUserCollectionFromRole   k[      RemoveUserCollectionFromSite   EM      RemoveUserFromGroup    !:      RemoveUserFromRole     Hw'      RemoveUserFromSite           RemoveUserFromWeb      "O      UpdateGroupInfo          UpdateRoleDefInfo      Q      UpdateRoleInfo     }      UpdateUserInfo     lfC      AddColleague   n      AddLink    ^      AddMembership      Ag      AddPinnedLink      .      CreateMemberGroup      ې      CreateUserProfileByAccountName     ,,      GetCommonColleagues    (Ɓp      GetCommonManager   ٫      GetCommonMemberships   w(      GetInCommon          GetPropertyChoiceList            GetUserColleagues            GetUserLinks   B3      GetUserMemberships     =^      GetUserPinnedLinks     $<>      GetUserProfileByGuid   N      GetUserProfileByIndex      L]      GetUserProfileByName   *RT      GetUserProfileCount    3      GetUserProfileSchema   {      ModifyUserPropertyByAccountName    4m      RemoveAllColleagues          RemoveAllLinks     +E+      RemoveAllMemberships   C/      RemoveAllPinnedLinks   f      RemoveColleague    
      RemoveLink     g       RemoveMembership   }h      RemovePinnedLink   -P      UpdateColleaguePrivacy     
      UpdateLink     6(      UpdateMembershipPrivacy    q      UpdatePinnedLink   4+      DeleteAllVersions      σ	      DeleteVersion      S      GetVersions    J[       RestoreVersion     +C      AddView    "
      DeleteView     HK      GetView          GetViewHtml    N:      GetViewCollection      
      UpdateView     -&V      UpdateViewHtml     !
      AddWebPart     U      AddWebPartToZone        GetWebPart2   ٫5      GetWebPartPage          GetWebPartProperties  vI      GetWebPartProperties2     On
      GetColumns          GetContentType    }      GetContentTypes   b      GetCustomizedPageStatus	   t      GetListTemplates
  a      GetObjectIdFromUrl    Qw      GetWeb    [      GetWebCollection  LZ      GetAllSubWebCollection    
E      UpdateColumns     41      WebUrlFromPageUrl     ?	      AlterToDo     7      GetTemplatesForItem   =      GetToDosForItem   %      GetWorkflowDataForItem    	\$      GetWorkflowTaskData   \)7      StartWorkflow     LW̃      SOAPEnvelope  k      header    ִ      <soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>  >      footer    I      </soap:Body></soap:Envelope>  v      payload   
      SOAPAction    _k
      SPServices     :y      options   <]FO      opt    l      extend!    {!~K      defaults"  *      opheader#  G	      operation$     ol-      xmlns='%   @3      /soap/2002/1/alerts/' >&   ~=      /soap/2002/1/alerts/'  +      /soap/meetings/' >(    5,      /soap/meetings/)   rvT      /soap/directory/' >*   c<      /soap/directory/+  taX      xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >,  N      http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/-    XW      xmlns='urn:Microsoft.Search' >.    >2      urn:Microsoft.Search//     U*      /diagnostics/' >0  2L4      http://schemas.microsoft.com/sharepoint/diagnostics/1  S      xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >2   B<J      http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/3    z7)D      xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/'4  F      http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck5    l)      /taxonomy/soap/' >6    g*      /taxonomy/soap/7   T      xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >8  jK      http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/9   O6      xmlns='http://microsoft.com/sharepoint/webpartpages' >:    B+-      http://microsoft.com/sharepoint/webpartpages/;     F_      /soap/workflow/' ><     -|      /soap/workflow/=   +I      /soap/'>>  Z      /soap/?    L`      opfooter@        </A    wR      ajaxURLB   d/	      _vti_bin/C           .asmxD     c      webURLE    v      charAtF    f      SPGetCurrentSiteG  zk      <IDs>H     aP      IDsI   jS>      wrapNodeJ  04S      </IDs>K          addToPayloadL  /%      usernameM        passwordN  @	      SourceUrlO     h:      <DestinationUrls>P     'C>      DestinationUrlsQ   a!      </DestinationUrls>R    ǃ      FieldsS    *m/      StreamT    r      ResultsU   0x      UrlV   2=      listNameW  [s      formUrlX   
      listItemIDY    C
      attachmentZ          description[   
      templateID\    ۩	      featureID]     ~-      webUrl^     H      contentTypeId_     ۮ:      pageUrl`   8      commenta   t      CheckinTypeb   ^R-U      checkoutToLocalc   H      lastmodifiedd  J4      displayNamee   *տ
      parentTypef    LN<      contentTypePropertiesg     	      addToViewh     Ρ4J      documentUrii   x      viewNamej  XN_      queryk     4	      CAMLQueryl     YXy"
      viewFieldsm    ,      CAMLViewFieldsn    bo      rowLimito  G-,      CAMLRowLimitp  ɍ.#      queryOptionsq  sM      CAMLQueryOptionsr        sinces     ϐ^      containst        changeTokenu   )d	      strlistIDv     >~      strlistItemIDw           strFieldNamex  MB	      newFieldsy     ",      updateFieldsz  0y_      deleteFields{  ͜      newDocument|   v4      listProperties}    wʑN      listVersion~   cO      updates   7      <updates><Batch OnError='Continue'><Method ID='1' Cmd='   n      batchCmd        '>    |
      valuepairs    y6 F      <Field Name='     t      escapeColumnValue     ~      </Field>  :2I      New   :j      <Field Name='ID'>           </Method></Batch></updates>   N=      organizerEmail    7      uid   \      sequence  m      utcDateStamp  E      title     0+QA      location  E$      utcDateStart  fȭ
      utcDateEnd    헊      nonGregorian        templateName  c6      lcid  R      timeZoneInformation   q      recurrenceId  !      cancelMeeting           SetWorkspaceTitle           principalKeys     Ѿ      principalType     L      addToUserInfoList     Ԛn
      searchText    k
      maxResults    ;<m
      objectName    F]h
      objectType    ^f      permissionIdentifier  F      permissionType    m      permissionMask    K	      permissionsInfoXml    e      memberIdsXml  JD       xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>  ;      http://microsoft.com/webservices/OfficeServer/QueryService/   A      queryXml  ur
      escapeHTML    Os      registrationXml   =      file  _^      client    U      team   t      originalFile  v      strFolderUrl  4$Z      strListName   O}L	      strItemId     F      siteDataFixSOAPEnvelope   +      urlType   pY`	      titleType           descriptionType   Gs      templateNameType  )_'Q      languageType   ~      languageSpecifiedType     o
      localeType    e      localeSpecifiedType   Wp      collationLocaleType   ;      collationLocaleSpecifiedType  JQ      uniquePermissionsType     [W      uniquePermissionsSpecifiedType    Db      anonymousType     A      anonymousSpecifiedType          presenceType  cdN      presenceSpecifiedType     hu      SiteUrl         LCID  n      TemplateList        isHighPriority    o      termID    D?V	      isPrivate           keyword   m      userAccountName   O@      lastModifiedTime  .u      maximumItemsToReturn  	      urlFolder     2Q
      startIndex    O5_      excludeItemsTime  <K      rating    3=      analysisDataEntry     PJ      chunksToSpell     ߹ڲ      declaredLanguage  	w      useLad    4      sharedServiceId   U	      termSetId     7N      newTerms  kX      sspId     7      termId    _)      termIds   3tL      matchOption         resultCollectionSize  <      addIfNotFound     j      clientTimeStamps  {      clientVersions    1z	      groupName           ownerIdentifier   Po	      ownerType     1R      defaultUserLoginName  _f      roleName  a      usersInfoXml  GG      userName  Ap      userLoginName     i	      userEmail     x	      userNotes     ٯ      groupNamesXml     $܊      roleNamesXml  MB      userLoginNamesXml     gK      emailXml  Q      oldGroupName  d      oldRoleName   &      accountName   [4      colleagueAccountName  C      privacy   yF      isInWorkGroup     }Ag      membershipInfo    V      propertyName  D      guid        AccountName         newData   /      sourceInternal    &+      sourceReference   zc
      newPrivacy    6(      data  MY      UpdatePinnedLink      0      fileVersion   4)      makeViewDefault   a      viewProperties    G      aggregations   y      formats   3(      toolbar   d|
      viewHeader    mQ      viewBody  mm
      viewFooter    ]z	      viewEmpty     @gd      rowLimitExceeded  *S
      webPartXml          storage	   p      zoneId
    	      zoneIndex     hH
      storageKey          behavior  ?8      documentName  n      Webs.CreateContentType     ^7      fileUrl   !|.	      objectUrl     C?      Webs.UpdateContentType    t      pageURL   ̺      item        todoId    .
      todoListId          taskData  U      listId          taskId    z
      templateId    0      workflowParameters    ?X      msg   E	      cachedXML     (      cacheXML  h;      body  dȐ      ajax   
      beforeSend!    ފ1      xhr"   f      setRequestHeader#  :      POST$  Dow      dataType%  ~s      xml&   Y      contentType'   ߨ      text/xml;charset='utf-8'(  Dȇ      complete)  t>      xData*     dOe      completefunc+  r
?<      CAMLViewName,  @Pu      <QueryOptions></QueryOptions>-     (      Update.    +!      Version3/  ͑5f      Shared0    #      List1  #       fClaim2    cA      User3  t      <WebUrlFromPageUrl xmlns='4    2      /soap/' ><pageUrl>5    `X      href6  E      indexOf7   6f      substr8    V      </pageUrl></WebUrlFromPageUrl>9    j      /_vti_bin/Webs.asmx:   iP      text/xml;charset="utf-8";   "      responseXML<   O      WebUrlFromPageUrlResult=   3      text>  m>n      SPCascadeDropdowns?          relationshipWebURL@    q>      relationshipListA  SÊ      relationshipListParentColumnB  FC      relationshipListChildColumnC   F      relationshipListSortColumnD    e      parentColumnE  J0
      childColumnF         SPListNameFromUrlG     n
      promptTextH    ,      noneTextI  :      (None)J    zPoN      simpleChildK   38      selectSingleOptionL    f	      matchOnIdM     .`      debugN     {!      thisParentSetUpO   2ј      thisFunctionP  1      SPServices.SPCascadeDropdownsQ     K      parentSelectR        DropdownCtlS   bV      ObjT   X      htmlU  C9      errBoxV    !k:      parentColumn: W    C`      childSelectX         childColumn: Y     'a      TypeZ  -م      SPComplexToSimpleDropdown[     A'P
      columnName\    [      Field[DisplayName=']   NTh      ']^          childColumnRequired_   A      attr`  <       Requireda  -]      TRUEb  @z      childColumnStaticc     &ߘ
      StaticNamed    "Gӛ      childColumnse  )      SPCascadeDropdownsChildColumnsf    u2      pushg        bindh        changei    b1      cascadeDropdownj   
      input[id='k    '>      optHidl    Wj`      propertychangem          dblclickn  A       parentSelectionso  /      closestp   4PB      spanq  兔      select[id$='SelectResult']r    U~      buttons    X      clickt     75      choicesu   S      parentSelectSelectedv  `q      childSelectSelectedw   @(      masterx    ɰ      MultiLookupPickerdatay     j      newMultiLookupPickerdataz        numChildOptions{   {W      firstChildOptionId|    d͏      firstChildOptionValue}     rjf      getDropdownSelected~         allParentSelections         ;#    [e      SPCascadeDropdown_Selected_   jYr%      input[name$='MultiLookupPicker$data']     2      window    ȃ@      button[id$='AddButton']   ,^7	      AddButton     )6      MultiLookupPicker_m   ܿ      currentSelection        select[ID$='SelectResult']    4-c
      sortColumn    z	      camlQuery     f3       <Query><OrderBy><FieldRef Name='  ֓lP      '/></OrderBy><Where><And>     ͨ      <And>     i+!      <Eq><FieldRef Name='  :D#      '/><Value Type='Text'></Value></Eq>   d t)      ' LookupId='True'/><Value Type='Integer'>     C      '/><Value Type='Text'>    ~      </Value></Eq>     B)      compound  X9      <Or>        </Or>     }      </And>          <IsNotNull><FieldRef Name='    z      ' /></IsNotNull>  oE      </And></Where></Query>    [      <ViewFields><FieldRef Name='  p      ' /><FieldRef Name='  l'      ' /></ViewFields>     JʅU      <QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>     )      errorstring   q:	      errorText     Ch      One or more field types are not installed properly. Go to the list settings page to delete these fields.  ]      relationshipListParentColumn:     =      Not found in relationshipList     fS      Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).   R`      relationshipList:     {      List not found    |`      option    *N      remove    B-      append    DqK      <option value='0'>    'V?      \{0\}     	      </option>     Uw      |0          SPFilterNode  l      rs:data   c5	      ItemCount     4~      z:row           thisOptionId  0@      thisOptionValue   GX5	      thisValue     \      ows_  ;*
      splitValue    Y?      ows_ID    .      selected  	
       selected='selected'        <option   d8       value='  9      <option value='         |t    #k      |t |t |t  !p      trigger   ',      option[value!='0']:first  &ڛ      val   l{j      thisSelected  >	      filter          &amp;     
      removeAttr    kj      GipRemoveSelectedItems    ~4      GipAddSelectedItems    H:      GipGetGroupData         columnSelect  {$      SPServices.SPComplexToSimpleDropdown        columnName:   V      columnOptHid  s      columnOptHidInput     {{      complexSelectSelectedId   M      simpleSelectId    ~b-      genContainerId    W	      simpleSelect  hc      <select id='  B<0b	      ' title='     ]%      simpleSelectSelected  ]       selected='selected'            value='   ]U	      </select>     $      prepend   e       img   v}      hide  " H      thisVal   F i      option[value='    x      SPDisplayRelatedInfo  nr      relatedWebURL     %/      relatedList   .O('      relatedListColumn     M둌      relatedColumns    |      displayFormat     d      table      U      headerCSSClass    ZӢ      ms-vh2    .Q      rowCSSClass   wh      ms-vb     G2	      numChars  v(\	      matchType     R      divId     cF      relatedColumnsXML     2f      relatedListXML    !(/      SPServices.SPDisplayRelatedInfo   i	      faultcode     
      relatedList:            Fields > Field[Name='           showRelated   FX3      Multi-select columns not supported by this function   MD>      columnSelectSelected  X8g      showRelatedSelected   2      parent    Ou      <div id=  B      ></div>   Sm       <Query><Where>    K      </Where></Query>  P      <FieldRef Name='  x      ' />  m      <ViewFields>  TR(      </ViewFields>     E'      relatedListColumn:    .<<       Column not found in relatedList    h	      outString     Zـ>      <table>   h      <tr>        Column not found in relatedList   
$      <th class='   '6        DisplayName         </th>           </tr>     yH      <td class='	   =

      showColumn
    .      </td>     ǀ      </table>        list  +      SPFilterDropdown  3      relationshipListColumn    ۣP{      <QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>   ht@      columnColumnRequired  =o      SPServices.SPFilterDropdown   ߀!      '/></OrderBy><Where>  QB      relationshipListColumn:   	      SPDebugXMLHttpResult  &`      node  yU^      indent    	      NODE_TEXT     6y      NODE_CDATA_SECTION    _k
+(      <table class='ms-vb' style='margin-left:  ]!X      px;' width='100%'>    U5_      nodeName  d_      DisplayPattern    O0      <tr><td width='100px' style='font-weight:bold;'>  M
:      </td><td><textarea readonly='readonly' rows='5' cols='50'>    \a6      </textarea></td></tr>            hasChildNodes!     H	      </td><td>"     	      nodeValue#     E@2	      checkLink$     I      &nbsp;%    
      </td></tr>&    5
      attributes'    ?k>      <tr><td colspan='99'>(     DF	      showAttrs)     ~Xߺ
      firstChild*    'J(      nodeType+  _
      parentNode,    n=      <tr><td width='100px' style='font-weight:bold;' colspan='99'>-     W      <tr><td>.  Ba
      childNodes/    #\[      SPGetCurrentUser0  W	      fieldName1     F      Name2  W
      fieldNames3    g4	      _spUserId4     kU	      thisField5     m,      theseFields6   
      fieldCount7    _      thisUserDisp8  76#      /_layouts/userdisp.aspx?Force=True&9   u.      getTime:   SW      thisTextValue;     x      FieldInternalName="<   H}#      responseText=  h`$      table.ms-formtable td[id^='SPField']>  !M      SPFieldText?   	      SPFieldNote@         divA   '
      SPFieldURLB    ț      srcC   rO      (^[\s\xA0]+|[\s\xA0]+$)D   Sh      SPLookupAddNewE          lookupColumnF  }{#      Add new {0}G   !h	      newWindowH     O,      ContentTypeIDI     >:      SPServices.SPLookupAddNewJ     O      lookupSelectK  *$      lookupColumn: L    x(      newUrlM    An      lookupListUrlN     B"      lookupColumnStaticNameO    y
      WebFullUrlP    7      getListFormUrlQ    Xt      NewFormR   G1      This column does not appear to be a lookup columnS     i`      newHrefT   5G      ?ContentTypeID=U   _Jݲ      ' target='_blank'V     r*      ContentTypeID=W    Xŷ      Source=X   	      escapeUrlY     iP      newLinkZ   >      <div id='SPLookupAddNew_[  ?	      <a href='\     C
      </a></div>]    v=      parents^   i      td.ms-formbody_    7      NewForm cannot be found`   ܌T      SPGetLastItemIda         userAccountb   j      userIdc    eJu      lastIdd    9C      <Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>e   cPW%Z      </Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>f    nZ.      <ViewFields><FieldRef Name='ID'/></ViewFields>g    s!A      <QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>h     b1      SPRequireUniquei          columnStaticNamej  fn3      Titlek           duplicateActionl   ̂I      initMsgm   z      This value must be unique.n    (      initMsgCSSClasso   m      errMsgp    xy      This value is not unique.q     zp<      errMsgCSSClassr    VɁ      ms-formvalidations      a	      showDupest     q3      queryStringValsu   r      SPGetQueryStringv  Hj      thisIDw    w      <span id='SPRequireUniquex     6J      ' class='{0}'>{1}</span><br/>y     =      firstMsgz  QN      \{1\}{     o_l      columnDisplayName|     {xU      SPGetDisplayFromStatic}    	      columnObj~     |t[      input[Title='     ĺ%      blur        columnValueIDs    n6c      columnValue   _)      <Query><Where><IsNotNull><FieldRef Name='     0      '/></IsNotNull></Where></Query>   2      <ViewFields><FieldRef Name='ID' /><FieldRef Name='    D+	      testValue     s      toUpperCase   X      newMsg    6      span#SPRequireUnique  	R8      input[value='OK']:disabled, input[value='Save']:disabled  zw      disabled  K      focus     V&      input[value='OK'], input[value='Save']    ?Mv	      out   k       duplicate item   8      :     %(O      <a href='DispForm.aspx?ID=    x      &Source=  )L^f      </a>            columnStaticNames     #      displayNames  8	      nameCount     C`      Field[StaticName='    >S      SPGetStaticFromDisplay    .%Ӛ      columnDisplayNames    v
      staticName    [      staticNames   3      SPRedirectWithID  D_      redirectUrl   M      qsParamName   9<      lastID    rџ      QSList    8-}      QSRootFolder  %>
      RootFolder    "j}      QSContentTypeId   {P`e      ContentTypeId     Z{'      form[name='aspnetForm']   Cu      thisUrl   Y	      substring     oe
      thisSource    { +      Source    -      \/    (      %2f   F-R      %3a   R      newQS            List=     =a      RootFolder=   Z\      ContentTypeId=    AN	      newAction            ?ID=  
C      %26RealSource=    (      RedirectURL   u      %26RedirectURL=   	      action    ۩      thisRedirectUrl   
      RealSource    -i      SPSetMultiSelectSizes     u;      multiSelectColumn     ;
      minWidth  ;x      maxWidth  a       SPServices.SPSetMultiSelectSizes        thisMultiSelect          multiSelectColumn:          Column is not multi-select.   p      possibleValues    N.      selectedValues          cloneId   4      clone     V      appendTo  >      css   J      width     zS      auto        height    1 
      visibility    W      hidden          cloneObj  ݞV      divWidth  .۬      newDivWidth   O      selectWidth   ]~      SPScriptAudit     ~      outputId  ;C
      auditForms    DC
      auditViews    5!
      auditPages    -      auditPagesListName    
8      Pages     Q-7      showHiddenLists   =2      showNoScript  斢      showSrc   eUw	      formTypes        e6      NewForm.aspx  F      Display   ,m      DispForm.aspx     h      Edit  ~
      EditForm.aspx     l7      listXml   NF      <th>Script References</th>    e      #SPScriptAudit th     2c      ms-vh2-nofilter   d      Hidden    ł      False     :      ContentType   L      0x0120    \      formUrls  hQ      FormUrls        SPScriptAuditPage     >o      Form  5      defaultViewUrl    2SZ      DefaultViewUrl          lastIndexOf   1M      View        numLists  :
      listsArray    fπh      <Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>  J3K      <ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>   jL      thisPageUrl   x      ows_FileRef   3!      thisPageType  	      ows_Title     UF      .aspx     Lã      Page  MQ.      #SPScriptAudit tr[class='ms-alternating']:even     /RVg	      pageClass     L      pageType  Q
      jQueryPage    )      pageScriptSrc     f(      scriptRegex   E\      <script[\s\S]*?/script>   ř
      GET   ɩ\9      success   FH      scriptMatch	   ,`      scriptLanguage
    Q<      getScriptAttribute    RY
      scriptType    f	      scriptSrc     DB
      coreScript    Ie      pagePath  ;      '><IMG border=0 src='     >^W      ImageUrl  :      True   -S      (Hidden)        thisSrcPath   gm      <td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>     CU!      <tr><td class=ms-vb2 width='30%'>     &      <td class=ms-vb2 width='70%'><a href='    3      </table></td>           #SPScriptAudit    G	      attribute     cT      regex      :a      =("([^"]*)")|('([^']*)')!  ~      matches"   [a9      coreScriptLocations#   q      WebResource.axd$          _layouts%  zqZ      SPArrangeChoices&  >      perRow'    C5	      randomize(     v      columnFillInChoice)    v      columnOptions*     =      FillInChoice+         thisFormField,     1㚮      findFormField-     .7      totalChoices.  F      choiceNumber/        fillinPrompt0  a      fillinInput1         <TR>2  }      sort3  mE      randOrd4   
H	      </TR><TR>5     o;      </TR>6     ^      <TR><TD colspan='99'>7     }
      </TD></TR>8    I      SPAutocomplete9    rg      WebURL:    i
      sourceList;    0      sourceColumn<  LI
      filterType=    g^$
      BeginsWith>          highlightClass?    fR
      uniqueVals@    ·	      maxHeightA     2n      slideDownSpeedB    5      fastC  #X      processingIndicatorD   É4      _layouts/images/REFRESH.GIFE   5      matchNumF  ȁ      positionG  ,E      columnObjIdH   m      columnObjColorI    
      colorJ     7l      columnObjWidthK    ʺ      SPServices.SPAutocompleteL     ]6      Column is not an input control or is not found on pageM    c      wrapN  S      <div>O     I      containerIdP   T      afterQ      U      <div><ul id='R     N      ' style='width:S   ׂv      ;display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>T    KH`      keyupU     S      background-imageV  &4      url(W  -      background-positionX    .      rightY     xԈ      background-repeatZ     EwY	      no-repeat[     Ċ
      matchArray\    LB      ><FieldRef Name=']     Uz
      </Value></^    L      thisValueTest_     yn      Contains`  ]DH
      firstMatcha    G      inArrayb   'Ba	      thisRegexc           startLocd  0      thisPose   a      endPosf    ^      thisSpang        <span class='h           </span>i   "?      <li style='display: block;position: relative;cursor: pointer;'>j   ն      </li>k     `;       lil   cH:      fadeOutm   &
      slideUpSpeedn  y	      mouseovero     CW      mouseoverCssp  N      cursorq     u      handr  E      #ffffffs   ,
      backgroundt    Ԗ      #3399ffu   c      mouseoutv  0*)      mouseoutCssw   D!%,      inheritx   l=      transparenty   #+Ř	      slideDownz     ٜ      args{  /      rxQS|  O0      ^([^=]+)=(.*)}     0Fh      \+~    s      thisPage  덏      thisPageBaseName  :!%      listPath  09      listCollList  q\k      SPUpdateMultipleListItems     8      itemsToUpdate     y6      documentsToUpdate            fileRef   /[P      fieldNum  >֊      batch     m      <Batch OnError='Continue'>    `8_      <Method ID='  (      ' Cmd='   F$      <Field Name='FileRef'>    _D	      </Method>     nU      </Batch>        SPXmlToJson   CW      mapping   upa      includeAllAttrs   x(	      removeOws     $76      colNum    bE
      jsonObject    %N      row   琕      colValue  dU      rowAttrs  7l
      mappedName    tu      attrNum   &      thisAttrName  TI      thisMapping   &      thisObjectName    O,.      thisObjectType    
      attrToJson    _      DateTime  ޯ	      datetime  YGd      dateToJsonObject  ]b      userToJsonObject  q	      UserMulti     #ǰl      userMultiToJsonObject     Ls      Lookup    j      lookupToJsonObject    fn0      LookupMulti   G?u      lookupMultiToJsonObject   1̚      booleanToJsonObject         Integer   ̳      intToJsonObject   ƚ      Counter   0{      MultiChoice   |      choiceMultiToJsonObject   dϩ      Currency  [      float     TwV      floatToJsonObject     C      Calc  4       calcToJsonObject  as      stringToJsonObject    Y      thisUser  9Xp      thisUserExpanded  =>e      ,#    ɴ      (,,)  	      loginName     <      email     
      sipAddress    "'t      thisUserMultiObject   =*      thisUserMulti     l
      thisLookup    r      lookupId        lookupValue   Bi      thisLookupMultiObject     &J)      thisLookupMulti   A|      thisChoiceMultiObject     x      thisChoiceMulti   үO3      thisCalc  B7      SPFindPeoplePicker    !      peoplePickerDisplayName   r
      valueToSet    \W
      checkNames    i      thisRow   ;!      nobr        contents        thisContents  \      div[name='upLevelDiv']     oU      thisCheckNames    %@      img[Title='Check Names']:first    :d      thisCurrentValue  b      trim  W+      dictionaryEntries     
}N      children  5      thisData  қ	      div[data]     	R      dictionaryEntry   rG      arrayOfDictionaryEntry    b      parseXML  ~,f      $xml  ~t/;      DictionaryEntry   B;      key   =_      Key   e	      Value     +Emk      attrib          currentValue        Version   0˱      listXML   %v	      columnXML     	      dispUrl   ϥ      numDecimals   G      outArray  ^ǡ      Text  Z1H      URL   DS      Format    hQ	      Hyperlink     Ď      </a>        Image      ?
      <img alt='    "      ' src='   5      '/>   .
      userMultiValues   YY$      <a href='/_layouts/userdisp.aspx?ID=  ^v      ,     3
      Calculated    :^
      calcColumn    	zY      Decimals  8      toFixed   l      FileRef   `      BaseType        Forms/DispForm.aspx   Ÿ      &RootFolder=*&Source=     RL
      FileDirRef    !      DisplayForm   1      lookupMultiValues           File  "      <table class='ms-vb' width='100%'>    [z/      <tr><td width='10px' style='font-weight:bold;'>    S:3u      </td><td width='100px'>   L      colName   z9      select[Title='    .&      select[ID$='SelectCandidate'][Title^='    0?(       ']   
F(      select[ID$='SelectCandidate'][Title$=':   Pu'      select[ID$='SelectCandidate'][Title$='"   Чd      ".']  D'      select[ID$='SelectCandidate'][Title$=' 	   $v      option:selected
   ݮ      columnSelections  fv      func  U      param     Tp-      <b>Error in function</b><br/>     _      modalBox  &      boxCSS    1"      position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;    B      #aspnetForm   "      <div id='SPServices_msgBox' style=    B1      #SPServices_msgBox    @y      leftVal   ;s;      topVal    p      border    ˳n      5px #C02000 solid     ]      left  $      top   HK      show   ixl      fadeTo!    b{su      slow"  N@      3000#         funcname$  OP      thisForm%  H֊      Form[Type='&   *n2
      paramArray'    &      paramArray[(   sc(      ]: )   `3      Invalid paramArray element passed to addToPayload()*   P߼      thisFormBody+  g      FieldName=",   '      [-[\]{}()*+?.,\\^$|#\s]-   {S8      \$&.   $      td.ms-formbody, td.ms-formbodysurvey/  E      siteDataOperation0     I<
      siteDataOp1    &9!      round2     '      random3    &r      http4  ~      &quot;5    a @      &lt;6        &gt;7  V      &(?![a-zA-Z]{1,8};)8   )      %269   >/      jQuery:    #&!       or relationshipListChildColumn: ;     k      '><a href='<   ꑮ      <table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>=   '      </tr></table>>     Ui{7      <tr class=ms-alternating><td class=ms-vb-icon><a href='?   l_7      'width=16 height=16></A></TD><td class=ms-vb2><a href='@   4JA      </td><td class=ms-vb2>A    f      </td><td class=ms-vb2><a href='B   PGx      <br/><b>Parameter</b><br/>C    D;      <br/><b>Message</b><br/>D  ,^      <br/><br/><span onmouseover='this.style.cursor="hand";' onmouseout='this.style.cursor="inherit";' style='width=100%;text-align:right;'>Click to continue</span></div>E     s      $.fn.SPServicesH   y       $.fn.SPServices.SPGetCurrentSiteJ  

1"      $.fn.SPServices.SPCascadeDropdownsL    lS1      $.fn.SPServices.SPCascadeDropdowns/completefunc/<M     ^:X3      $.fn.SPServices.SPCascadeDropdowns/completefunc/</<N   ח$      $.fn.SPServices.SPCascadeDropdowns/<O  &      $.fn.SPServices.SPCascadeDropdowns/</<P    ,;      cascadeDropdown/<R     5^[       cascadeDropdown/</completefunc/<S  |"      cascadeDropdown/</completefunc/</<T    y})      $.fn.SPServices.SPComplexToSimpleDropdownU     {wI7+      $.fn.SPServices.SPComplexToSimpleDropdown/<V   I2$      $.fn.SPServices.SPDisplayRelatedInfoX  j3      $.fn.SPServices.SPDisplayRelatedInfo/completefunc/<Y   ta&      $.fn.SPServices.SPDisplayRelatedInfo/<[    Y      showRelated/completefunc/<\    Ą       $.fn.SPServices.SPFilterDropdown^  CQ/      $.fn.SPServices.SPFilterDropdown/completefunc/<_   V4$1      $.fn.SPServices.SPFilterDropdown/completefunc/</<`     }p$      $.fn.SPServices.SPDebugXMLHttpResulta  N       $.fn.SPServices.SPGetCurrentUserc  g&"      $.fn.SPServices.SPGetCurrentUser/<d    !.      $.fn.SPServices.SPLookupAddNewf    u^-      $.fn.SPServices.SPLookupAddNew/completefunc/<h     D)<      $.fn.SPServices.SPLookupAddNew/completefunc/</completefunc/<i  x      $.fn.SPServices.SPGetLastItemIdk   V.      $.fn.SPServices.SPGetLastItemId/completefunc/<l          $.fn.SPServices.SPRequireUniquem   Z~!      $.fn.SPServices.SPRequireUnique/<o     /b0      $.fn.SPServices.SPRequireUnique/</completefunc/<p  W&      $.fn.SPServices.SPGetDisplayFromStaticr    ɚ&      $.fn.SPServices.SPGetStaticFromDisplayt    S8       $.fn.SPServices.SPRedirectWithIDu  BOY"      $.fn.SPServices.SPRedirectWithID/<v    E[%      $.fn.SPServices.SPSetMultiSelectSizesw     w%'      $.fn.SPServices.SPSetMultiSelectSizes/<x         $.fn.SPServices.SPScriptAuditz     z?,      $.fn.SPServices.SPScriptAudit/completefunc/<|  
;      $.fn.SPServices.SPScriptAudit/completefunc/</completefunc/<}   ?LQ=      $.fn.SPServices.SPScriptAudit/completefunc/</completefunc/</<     ȍ$       $.fn.SPServices.SPArrangeChoices  >/      $.fn.SPServices.SPArrangeChoices/completefunc/<   DĪ1      $.fn.SPServices.SPArrangeChoices/completefunc/</<     ^q"      $.fn.SPServices.SPArrangeChoices/<    6      $.fn.SPServices.SPAutocomplete    G7\       $.fn.SPServices.SPAutocomplete/<  Sf/      $.fn.SPServices.SPAutocomplete/</completefunc/<   M"      $.fn.SPServices.SPAutocomplete/</<    E       $.fn.SPServices.SPGetQueryString  ~E(!      $.fn.SPServices.SPListNameFromUrl     U[0      $.fn.SPServices.SPListNameFromUrl/completefunc/<  9U)      $.fn.SPServices.SPUpdateMultipleListItems     8      $.fn.SPServices.SPUpdateMultipleListItems/completefunc/<        $.fn.SPFilterNode     &z      $.fn.SPFilterNode/<   p:(      $.fn.SPXmlToJson  =3      $.fn.SPXmlToJson/<    F      $.fn.SPXmlToJson/</<  ~      $.fn.SPFindPeoplePicker   3@       $.fn.SPFindPeoplePicker/thisRow<  {z\      $.fn.SPFindPeoplePicker/<     s#      $.fn.SPFindPeoplePicker/</<   6t(      $.fn.SPFindPeoplePicker/</completefunc/<  db*      $.fn.SPFindPeoplePicker/</completefunc/</<    @w      $.fn.SPServices.Version         getDropdownSelected/<      =
      modalBox/<    4      modalBox/</<        findFormField/<                       d   %,                              =                                                                                                                                                              
                           "                #                 $                 %                 &                Y                 Z                 [                 \                 v                 w                 x                 y                 z                 {                 |                 }                 ~                                                                                                                            $                                                   '                 (                                                  +                                                  .                                                                                                                                                                         8                 8                                  ;                                 =                 >           	      ?           
      =                 =                 =                 =                 =                 E                                 G                                 I                 J                 I                  I           !                '      N           (      O           )      P           *      N           +      R           ,      R           -      R          .      U           /      R          0      W           1                 2                3      Z           4      Z           5                6      ]           7      ^           8      _           9      `           :                ;      b           <      c           =      b           >      e           ?                @      g          A      h          B      i           C                D      k           E                F      m           G                H      o           I                J      q           K      q           L                M      t           N      u           O      v           P      w           Q      x           R      v           S      z           T      t           U      |           V      t           W      ~           X             	   ]                 ^                 _                 `                 a                b                c                d                 e                 f                 g                 h                 i                j                 k                 l                m                 n                 o                 p                q                 r                s                t                 u                                                                                                                                            Oc            F            $ `  P P  P3  PX P	   P+   P#  P P6  P  P} P Pt     P P P  -   P PK P P  P%  P P P P  i ` P/  P P  P7  P   P5  P	 P  
 P, P P  P'  PR P   PP P  P  PU P( P  # P1    P  `i PI P)  P P P P3 P!  P P            D Q Pt Pu Pv Pw Px Py Pz P{ P| Pd 	               PW Pb ^ P~                    ) p                O                                          P P                                                    P                    	             P P P P O P  l              ) p    P                                                    	              P P  P P_ Pi ` P P P            ) 	                                  B i  "              v                s               s               s              s                s              s                s                 s               s                 s                s      	             i       ]                  i                                L  P
                                 o                                                                  # [             l  f `$ u `             ) p               & i               [ * P P                              / 0             n  v                                s               s               s               s               u                PA  P P `             !              ) p                              ) p                PN O Q PW E d              ) p                                                                                                                                     
               Pt   P                                    P P P PO P              ) p                                                                Pt P Pw Px Py P PO P P               ) p                                                 ) p                                                         P                                   P                                  i                    4 P5 6 7 P: P             ) p                                 PO J L PM PN PS              ) p                                ) p                                 b Pc P              ) p                                ) p                   	              Pt v P6  P y { }                P P                  ) p   P                                 Pd P P P             ) p                 P P P P             ) p  	              6  t P P P P P                         	           O      P                                                   P P P               ) p                                ) p                                                   ) p                                ) p                                ) p                     
              P( P) P + - P. P/ P0 P             ) p                                                                   PE P} PG PH PJ O P   	            P[ P  b ! c d e f                 ) p   P               ^ `                                   o                  v                  i  t  z {               ~   P             ) p                                   Pi   P P               ) p                                 ) p              a `                                  P  P                  P                                        P     P                                 P                   %                  ) p                               i    %                  0                       C            z        :     |    }    -                         ,    &     "     <     >     7    &     I$KE	   -      #    D V k m o q *    (     #    D V k m o *                     $        
     b         b         
                   
   V {        #    V *                    (              $ & (           # D  + k m o q   P      1             *    #             $ & (            P      ? @ A B C D E V k G H J K L * M          [         #     V *          W b ^                 [ * M            F      [        k   L * M        #     D V *            <   ? @  C [ V G H k q * M          #     V * 	   -     #    D V k m o q *            
         
                    0 2 M                              (                  E G G H * M        #     V *         #     V *                D V a k          # D     * 	   -     #    D V k m o q *         	   -    i k    l n o q s *    
     V i    #    #    V k m o *                  D V i                         #     D V *               D V {                         #     D V *            
            V         V                   M                
    0          
   2   D V                # D    *          # D V    *         # D V    *         #     D V *    (    #    D V k m o *                 V [ & '          #     V *            P    9 : ; [ k q o <     > ? @ A C M          U W Y 	   -   #    D V k q m o *         p I s       p I s                         V         #    *            #      D V k   * M    #   #    D V k q *       #    D V ~ *                                                                     #      *              &ժ!!   D      .WD                             l       v ڣ@`F P	Pt)  [at)  b"  	             1           l    4  l    9  l    7  l    %  l      l      l      l      l	      l
      l      l    8  l    	  l      l    '  l      l      l    $  l    0  l    *  l      l    /  l      l      l    ,  l      l    &  l    +  l    5  l    :  l    1  l     3  l!    <  l"      l#      $    "  %    .  &      '    (  (    2  )      *     +     ,   	  -      .     /       0    -  1      2      3     4     5    ;  6    
  7      8    )  9    6  :     ;     <      =   
  >      ?    #  ?         ?     g     !  ڼ !  g    2  h    h   K@   ڼ !  g    2  h    h   KA   ڼ !  g      h    h   KB   ڼ !  g      h    h   KC   ڼ !  g     h    h   KD   ڼ !  g     h    h   KE   ڼ !  g     h    h   KF   ڼ !  g     h    h   KG   ڼ !  g     h    h   KH   ڼ !  g   	  h    h   KI   ڼ !  g   	  h    h   KJ   ڼ !  g   	  h    h   KK   ڼ !  g   	  h    h   KL   ڼ !  g   	  h    h   KM   ڼ !  g   	  h    h   KN   ڼ !  g   	  h    h   KO   ڼ !  g   	  h    h   KP   ڼ !  g   	  h    h   KQ   ڼ !  g   	  h    h   KR   ڼ !  g   	  h    h   KS   ڼ !  g   	  h    h   KT   ڼ !  g   	  h    h   KU   ڼ !  g   	  h    h   KV   ڼ !  g   	  h    h   KW   ڼ !  g   	  h    h   KX   ڼ !  g   	  h    h   KY   ڼ !  g   	  h    h   KZ   ڼ !  g   	  h    h   K[   ڼ !  g   	  h    h   K\   ڼ !  g   	  h    h   K]   ڼ !  g   	  h    h   K^   ڼ !  g   	  h    h   K_   ڼ !  g   	  h    h   K`   ڼ !  g   	  h    h   Ka   ڼ !  g   	  h    h   Kb   ڼ !  g   	  h    h   Kc   ڼ !  g   	  h    h   Kd   ڼ !  g      h    h   Ke   ڼ !  g      h    h   Kf   ڼ !  g      h    h   Kg   ڼ !  g      h    h   Kh   ڼ !  g     h    h   Ki   ڼ !  g     h    h   Kj   ڼ !  g       h    h   Kk   ڼ !  g       h    h   Kl   ڼ !  g       h    h   Km   ڼ !  g       h    h   Kn   ڼ !  g       h    h   Ko   ڼ !  g       h    h   Kp   ڼ !  g    -  h    h   Kq   ڼ !  g      h    h   Kr   ڼ !  g      h    h   Ks   ڼ !  g      h    h   Kt   ڼ !  g      h    h   Ku   ڼ !  g      h    h   Kv   ڼ !  g      h    h   Kw   ڼ !  g      h    h   Kx   ڼ !  g      h    h   Ky   ڼ !  g     h    h   Kz   ڼ !  g     h    h   K{   ڼ !  g     h    h   K|   ڼ !  g     h    h   K}   ڼ !  g     h    h   K~   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    ;  h    h   K   ڼ !  g    
  h    h   K6   ڼ !  g      h    h   K   ڼ !  g      h    h   K   ڼ !  g      h    h   K   ڼ !  g      h    h   K   ڼ !  g      h    h   K   ڼ !  g      h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    )  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g    6  h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K   ڼ !  g     h    h   K  ڼ !  g     h    h   K  ڼ !  g     h    h   K  ڼ !  g     h    h   K  ڼ !  g     h    h   K  ڼ !  g     h    h   K  ڼ !  g      h    h   K  ڼ !  g      h    h   K  ڼ !  g      h    h   K	  ڼ !  g      h    h   K
  ڼ !  g      h    h   K  ڼ !  g      h    h   K  ڼ !  g   
  h    h   KP   ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K  ڼ !  g   
  h    h   K`   ڼ !  g   
  h    h   K  ڼ !  g      h    h   K  ڼ !  g      h    h   K  ڼ !  g      h    h   K  ڼ !  g      h    h   K  ڼ !  g      h    h   K  ڼ !  g      h    h   K  8     ڼ     K   ڼ   !  K"  ڼ   ?   K#  ڼ   I$  l%  K&  ڼ   I$  I&  8'  ;(  ?   ;)  ?   ;*  ;+  ?   ;,  ?   ;-  ?   ;.  ;/  0  ;1  2  ;3  g    ;4  g    ;5  6  ;7  8  ;9  :  ;;  ;<  ;=  ;>  ;?  ;@  ;A  ;B  ;C  ;D  ;E  
;F  G  ;H  ;I  ;J  KK  ڼ   I$  I&  lL  KM  ڼ   I$  I&  lN  KO  ڼ   I$  I&  lP  KQ  ڼ   I$  I&  lR  KS  ڼ   I$  I&  lT  KU  ڼ   I$  I&  lV  KW  ڼ   I$  I&  lX  KY  ڼ   I$  I&  lZ  K[  ڼ   I$  I&  l\  K]  ڼ   I$  I&  l^  K_  ڼ   I$  I&  l`  Ka  ڼ   I$  I&  lb  Kc  ڼ   I$  I&  ld  Ke  ڼ   I$  I&  lf  Kg  ڼ   I$  I&  lh  Ki  ڼ   I$  I&  lj  Kk  ڼ   I$  I&  ll  Km  ڼ   I$  I&  ln  Ko  ڼ   I$  I&  lp  Kq  ڼ   I$  I&  lr  Ks  ڼ   I$  lt  Ku  ڼ   I$  lv  Kw  ڼ   I$  lx  Ky  ڼ   I$  I&  lz  K{  ڣM`K`+`+`K`+`*`*`*`*`+`*`+`+`+`+`*`*`+`+`+`+`+`*`*`+`*`K%`+`+
`'
`J1`K3`
 `
@6`
 `
@9`
 `
! `
@=`
 `
!@@`
 `
$ `
 `
! `
$ `
 `
 `
! `
  `
! `
) `
 `
% `
 `
 `
! `
! `
" `
! `
) `
 `
# `
 `
! `
* `
) `
 `
@]`
 `
 `
 `
!@b`
! `
 @e`
 `
% `
% `
  `
' `
 @l`
@n`
" `
" `
! `
 `
 `
 `
@v`
(@x`
 `
 `
 `
' `
 `
! `
 `
 `
 `
 `
  `
 `
 `
 `
" `
& `
! `
! `
 `
 `
 `
 `
! `
 `
 `
' `
 `
$ `
! `
$ `
  `
$ `
# `
 `
  `
 `
+ `
 `
 `
 `
! `
  `
  `
' `
 `
" `
 `
 `
 `
 `
" `
$ `
$ `
 `
 `
 `
 `
 `
 `
& `
% `
 `
 `
( `
! `
' `
' `
' `
' `
 `
! `
' `
' `
& `
 `
/ `
* `
! `
' `
' `
' `
& `
 `
$ `
 `
" `
 `
* `
) `
) `
" `
! `
! `
! `
 `
! `
 `
 `
 `
 `
 `
 `
! `
* `
" `
  `
# `
 `
$ `
! `
 `
! `
! `
# `
$ `
# `
" `
# `
+ `
" `
 `
# `
# `
 `
 `
  `
  `
$ `
 `
% `
  `
! `
 `
 `
 `
 `
 `
 `
 `
! `
 `
 `
 `
  `
 `
 `
# `
$ `
! `
 `
 `
 `
% `
  `
! `
 `
  `
$ `
 `
! `
! `
 `
" `
 `
$ `
" `
 `+` ` ` `@ ` &** ***& * ****&&&&&&&&&&' &L `@ `@ `@ `@ `@ c`@ `@ `@ 	9`@ 	o`@ 	`@ 	`@ 
`@ 
Q`@ 
`@ ~`@ `@ `@ `@ `@ `@ `@ `@ `0 uP|Z  f<Z  QH         	              I   8     I   I   I     r    ڼ        I   %   %K	   ڼ!     I   JJܼ2        ܼ  	     ܼ   7     ܼ-  e     ܼ       ܼ       ܼ;       ܼ
       ܼ       ܼ)  +     ܼ6  Y     ܼ  u     ܼ              I	   
   (  %   %%-K	   ڼ(     %  ڗ        I	   
   (  %   %%-K	   ڼ(     %  ڗ  &     I	   
   (  %   %%-K	   ڼ(     %  ڗH  ,     I	      %-K	        ڗ  /     I	      %-K	        ڗ  2     I	   
   (  %   %%-K	        ڗ  7     I	      %-K	        ڗ  :     I	      %-K	        ڗ[  =     I	   
   (  %   %%-K	   ڼ(     %  ڗ  C     I	   
   (  %   %%-K	   ڼ(     %  ڗ   I     I	      %-K	        ڗ   L     I	      %-K	         ڗ   O     I	   
   (  %!   %%-K	   ڼ(  "   %  ڗD   U     I	   
   (  %#   %%-K	   ڼ(  $   %  ڗ   [        I   %-  ڼ  %      I   %&   %K'   (   !     I   JJ%)   %   ڼ   I*   I+   ߼   I*   I,   &r .  #   n      I*      %   ڗq   p      I*   I,   )   t      I*   .  %   %   ڗ2   w      r  I   I-   r  .  %   %   ڕ}     .   K/   ڼ   I   0        1        2        3   ~     4        5        6   G     7   r     8        9        :        ;         <   +     =   `     >        ?        @        A   *     B   U     C   v     D        E        F        G        H   %     I        J   ?     K   V     L        M   $     N        O        P        Q        R   7     S   b     T        U   E     V        W        X         Y   7     Z   b     [        \        ]        ^        _   M     `   x     a        b        c        d   D     e   t     f        g        h   2     i   +     j   ~     k        l        m        n        o        p   N     q   e     r        s   )     t   @     u   a     v        w        x         y        z   8     {   O     |   f     }   }     ~                                            %         F         ]         t                           R!        i!        !        !        !        !        !        !        ("        ?"        `"        "        "        "        "        "        &#        [#        #        #        #        $        <$        $        $        %        $%        O%        z%        %        %        %        :&        3&        J&        a&        Z&        q&        j&        &        &       &       &       &       &       &       &       &       &  	     '  
     '       &       '       -'       D'       e'       |'       '       '       '       '       (       .(       E(       (       (       (       #)       b)       )       )       *        *  !     /*  "     F*  #     ]*  $     t*  %     *  &     *  '     *  (     *  )     *  *     *  +     +  ,     ,+  -     +  .     +  /     +  0     +  1     +  2     +  3     ,  4     *,  5     K,  6     l,  7     ,  8     ,  9     ,  :     -  ;     9-  <     Z-  =     q-  >     -  ?     -  @     -  A     '.  B     H.  C     i.  D     .  E     .  F     .  G     /  H     /  I     0  J     60  K     W0  L     x0  M     0  N     0  O     0  P    1  Q    0  R    1  S    1  T    &1  U    Q1  V    J1  W    C1  X  	  n1  Y  
  1  Z    1  [    2  \    $2  ]    ;2  ^    R2  _    }2  `  2  `  2  `    I/     %-K/     ږc       I  I,   M   g    I/   5        I    Jr %-K/   ڼ  /'  ڗo    I/     %-K/   ڗ2  r  1  r        g     h      h   v ڗ1  t        g     h    v ڼ  I/     %-K/     ږy       I  I,   M   }    I/   5        I    Jr %-K/   ڼ  /'  ڗ    I/     %-K/   ڼ      g     h      h     h   v ڗ0          g     h    v ڼ  I/     %-K/     ږ       I  I,   M       I/   5        I    Jr %-K/   ڼ  /'  ڗ    I/     %-K/   ڗ/          g     h      h     h   v ڗ/          g     h       h   v ڗ/          g     h    v ڗe/          g     h    !  h   "  h   #  h   v ڗ/          g     h    $  h   v ڗ.          g     h    %  h   &  h   v ڗ.          g     h    %  h   '  h   &  h   v ڗk.          g   (  h    )  h     h   v ڗ/.          g   *  h    +  h   ,  h   v ڗ-          g   *  h    -  h   .  h   v ڗ-          g     h    /  h   0  h   1  h   2  h   3  h   v ڗ]-          g     h    !  h   4  h   v ڗ!-          g     h    )  h   v ڗ,          g     h    )  h   5  h   v ڗ,          g     h    v ڗ,          g     h    g   !  h    6  h   h   v ڗE,          g     h    v ڗ,          g     h    7  h   v ڗ+    +          g     h    )  h   v ڗ+          g     h    v ڗ+          g     h    7  h   g   8  h    9  h   h   g   :  h    ;  h   h   g   <  h    =  h   h   g   >  h    ?  h   h   v ڗ*          g     h    :  h   @  h   A  h   v ڗ*          g     h    7  h   8  h   :  h   <  h   >  h   B  h   A  h   v ڗ)*          g   C  h    D  h   E  h   v ڗ)          g   *  h    v ڗ)          g     h    )  h   2  h   F  h   G  h   H  h   3  h   v ڗa)          g     h    I  h   v ڗ/)          g     h    )  h   I  h   v ڗ(          g     h    J  h   F  h   G  h   H  h   K  h   v ڗ(          g     h    v ڼ   IL        ڼ   IL  I,     -           g   L  h    v ڗ)      I/   M     IN  %O  %%-K/     ږ       IP  I,   o       I/   Q     IP    JJ%O  %      IP    JJr %R  %%-K/   ڼ  /'  ڗ{     IN  S  3       I/   T     I6  %R  %%-K/   ڕ    I/   U  %-K/   ڕ  &          g	   V  h    W  h   X  h   Y  h   Z  h   [  h   \  h   ]  h   ^  h   v ڗv&          g   Z  h    _  h   `  h   a  h   v ڗ0&          g   b  h    W  h   X  h   Y  h   c  h   v ڗ%          g   Z  h    v ڗ%          g   d  h    e  h   f  h   v ڗ|%          g   g  h    h  h   e  h   v ڗ@%          g   i  h    j  h   k  h   l  h   m  h   v ڗ$          g   i  h    j  h   n  h   v ڗ$          g   i  h    j  h   v ڗ$           g   i  h    j  h   k  h   l  h   v ڗ<$  "        g   i  h    j  h   o  h   v ڗ $  $        g   i  h    j  h   k  h   l  h   m  h   v ڗ#  &  #  &          I   %p  %K	   q     I   %  ڗe#  ,          I   %p  %K	   q     I   %  ڼ  I/   5   r  <      Ir  r r %-K/   ڗ"  8          I   %p  %K	   q     I   %  ڗ"  >    I/   5   r  <      Ir  r r %-K/   ڗq"  D          I   %p  %K	   q     I   %  ڼ  I/   5   r  <      Ir  r r %-K/   ڗ!  P    I/   5   s  <      Is  r r %-K/   ڗ!  V  !  V        g   $  h    t  h   u  h   v  h   w  h   x  h   y  h   v ڗP!  X        g   z  h    v ڗ(!  Z        g   {  h    |  h   v ڗ   \        g   {  h    v ڼ+        I   r   ڗ   `  +        I   r   ڗ   b  +        I   r   ڗ`   d        g     h    v ڼ+        I   r   ڗ   h  +        I   r   ڗ  j        g   }  h    ~  h     h     h     h     h     h     h     h     h	     h
     h     h     h     h     h   v ڗ4  l        g   4  h    v ڗ  n        g     h    v ڗ  p        g     h      h   v ڗ  r        g   4  h    +  h     h   Z  h   v ڗl  t        g   4  h      h   Z  h     h   v ڗ&  v        g   4  h      h   Z  h     h   v ڗ  x        g     h    v ڗ  z        g     h    4  h   v ڗ  |        g   4  h    v ڗ^  ~        g   4  h    v ڗ6          g     h    v ڗ          g   4  h      h   v ڗ          g   4  h    v ڗ          g   4  h      h   v ڗ          g   4  h      h   v ڗP          g   4  h    v ڗ(          g     h    v ڗ           g     h      h   v ڗ          g     h    v ڗ          g     h    v ڗ~          g     h      h     h   v ڗB          g     h    4  h   v ڗ          g   4  h      h     h   v ڼ   I        ڼ   I  I,     5       I/   5        I  r %-K/   ڕ  m          g   4  h    v ڗE          g     h    4  h   v ڗ          g   4  h    v ڗ          g     h    v ڗ          g   4  h    v ڗ          g     h    v ڗs          g   4  h    v ڗK          g     h      h     h   v ڗ          g     h    v ڗ          g     h      h   v ڗ          g   4  h      h   v ڗ          g     h    v ڗ[          g     h    v ڗ3          g     h      h   v ڗ          g     h      h   v ڗ          g   4  h      h   Z  h     h   v ڗ          g   4  h      h   +  h     h   v ڗC          g     h      h     h   v ڗ          g     h      h   `  h     h   v ڗ          g     h    `  h     h     h   v ڗ{          g     h    `  h     h   v ڗ?          g     h    `  h   v ڗ          g     h    `  h     h     h     h     h   v ڗ          g     h      h   `  h     h     h   v ڗc          g     h      h     h     h   %  h   v ڗ          g     h      h   v ڗ          g     h    %  h   m  h   v ڗ          g     h    %  h   m  h   v ڗi          g     h      h   v ڗ7          g     h      h   v ڗ          g     h      h     h     h     h   v ڗ          g     h      h     h     h     h   v ڗe    [          g     h    v ڗ3          g     h    v ڗ              g     h    v ڗ              g     h    v ڗ          g     h    v ڗ          g     h    v ڗW          g     h    v ڗ/    %          g     h    v ڗ                  g     h    v ڗ          g     h    v ڗ          g     h    v ڗq    g    ]          g     h    v ڗ5          g     h    v ڗ           g     h    v ڗ          g     h      h   v ڗ          g     h    v ڗ          g     h      h   v ڗY          g     h      h   v ڗ'  
        g     h    v ڗ          g     h      h   v ڗ          g     h      h   v ڗ          g     h    v ڗs          g     h    v ڗK          g     h      h     h     h   %  h   v ڗ          g     h      h   %  h   m  h   v ڗ          g     h      h   %  h   m  h   v ڗo          g     h      h     h     h   v ڗ)          g     h      h     h     h     h   v ڗ          g     h      h   4  h     h     h   v ڗ           g     h      h     h     h   v ڗC  "        g     h      h   4  h   v ڗ  $        g     h    v ڗ  &        g     h    v ڗ  (        g     h    v ڗ  *        g     h    v ڗg  ,        g     h    v ڗ?  .        g     h    v ڗ  0        g     h    v ڗ  2        g     h    v ڗ  4        g     h    v ڗ  6        g     h    v ڗw  8        g     h    v ڗO  :        g     h    v ڗ'  <        g     h    v ڗ
  >     I      A  ڼ   I  I,   D  A   E        g   g     h      h   h    v ڗ(   H        g     h    v ڕJ  _
  J  U
  J  K
  J        g     h      h   v ڗ
  L        g     h    v ڗ	  N        g     h    v ڗ	  P        g     h    v ڗ	  R        g     h    v ڗy	  T        g     h      h   v ڗG	  V        g     h      h   v ڗ	  X        g     h      h     h   v ڗ  Z        g     h      h   v ڗ  \        g     h      h     h   v ڗk  ^        g     h      h   v ڗ9  `        g     h      h     h     h   v ڗ  b        g     h      h   v ڗ  d        g   "  h    v ڗ  f        g   "  h      h   v ڗg  h        g   "  h    v ڗ?  j        g   "  h      h   v ڗ  l        g     h    7  h   :  h   8  h   <  h   <  h     h     h   v ڗ  n        g     h    7  h   v ڗm  p        g     h    7  h   v ڗ;  r        g     h    v ڗ  t        g     h    7  h   v ڗ  v        g     h    7  h     h   8  h   :  h     h     h   <  h   v ڗs  x        g     h    7  h     h     h     h     h     h     h     h   8  h	   :  h
     h     h   <  h   v ڗ  z        g   *  h      h     h   v ڗ  |        g   *  h      h     h     h     h   v ڗ=  ~        g   *  h      h     h     h   v ڗ          g     h      h   v ڗ          g   *  h      h   v ڗ          g   *  h      h     h   v ڗW          g   /  h    0  h   F  h   2  h   v ڗ          g   (  h    v ڗ          g   )  h    v ڗ              g     h    v ڗ              g     h    v ڗ]          g   g   (  h    *   h   h    v ڗ!                  g   F  h    G  h   H  h   v ڗ          g   )  h    2  h   F  h   G  h   H  h   v ڗ          g   g   *  h      h   h    v ڗE          g     h      h     h     h   v ڗ           g     h    v ڗ           g     h    v ڗ           g     h    v ڗ           g     h      h     h   v ڗK           g     h      h     h   v ڗ            I    I	   %  I/   %  I'   %  I  %      ڼ   I  -          r I  ߼   r    ڕ      x       I  8     ;4     I  ;  l  ;    ;     ;    ;    ;  l  ;  v ڗ$        I  ߼      v ڕ  @`	 PI`
 
`000000 0$0(0,0004080 ` % ` ` ` % ` ` ` % ` ` ` `+` ` `+` ` % `+` ` `+` ` `+` ` % ` ` ` % ` ` ` `+` ` `+` ` % ` ` ` % ` `JC` `
@H` `  P" `
 ` `
 `
PPOQ`@S
`0U ` ` 
`f ` + PKY#`@\` `:` ` ` P$`:g `P$` 
`f ` + PKj/`@m` ` P$` `P$` 
`f ` + PKs/`@v` ` ` P$`:} ` P$` `P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` `P$` ` P$` `P$` ` P$` ` ` P$` `P$` `   "  P$` ` P$` ` P$` ` P$` `P$` ` P$` ` P$` ` P$` ` P$` `P$`
 `P ` T `f ` *  P@  +` 	` ` . ` ` ` P$` ` P$` ` P$` `P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` `
 `M ` `
 `M ` -
PP+` `
 `M ` ` -
PP+` `
 `M ` -
PP+` ` 4
PP+` ` ` P$` `P$` ` P$` `P `'
P)` `'
P)` `'
P)` `P `'
P)` `'
P)` `@ TP ` `P$` `P$` ` P$` ` P$` ` P$` ` P$` `P$` ` P$` `P$` `P$` `P$` ` P$` `P$` ` P$` ` P$` `P$` `P$` ` P$` `P$` `P$` ` P$` ` P$` ` P$`
 ` 5
P ` `P$` ` P$` `P$` `P$` `P$` `P$` `P$` ` P$` `P$` ` P$` ` P$` `P$` `P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` `P$` `P$` ` `P$` ` `P$` `P$` `P$` `P$` ` `P$` ` ` `P$` `P$` `P$` ` ` `P$` `P$` `P$` ` P$` `P$` ` P$` ` P$` `P$` ` P$` ` P$` `P$` `P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` `P$` `P$` `P$` `P$` `P$` `P$` `P$` `P$` `P$` `P$` `P$` `P$` `P$` `
 ` P `P ` ` ` ` P$` `P$` `P$` `P$` `P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` `P$` ` P$` `P$` ` P$` ` P$` ` P$` ` P$` `P$` ` P$` ` P$` `@ P ` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` ` P$` `P$` `P$` ` `P$` ` `P$` ` P$` ` ` ` P$` ` P$` ` P$` ` P$` `P$` `P$` `P$` ` P$` ` P$` ` `*+++ ` ` `P
P ` `%)/J b****J YP> p `P P|Z           h            h            h          G     p   p   :                         !     I   JJ"        I        v ڕ   @	` `#PIP   f,   g                            I   +            r I   ߼     v ڕ        ڷ    ڼ   I   ߼      v ڣ 	` `P
PI`)`)`P$P  t                  %         #  I          #        I      % (  %   %   I   I      r =         I   I	      I   I      r r          I      %
   %   I   %   ڼ   I   8   ;      ;      ;      ;      ;      ;   l   ;   v ڼ #  @` `EF`*$  P , PP& `%&**)**JPD`%Qh   '{h   1                               I   r I      r I   r   #  ڣ `PP
 P)P  O                           I   8   8      ;      ;      ;      ;      ;	      ;
      ;      r  I   I   r  ;      ;      ;      ;   ;   ;   ;   ;   ;     r            ڼ*     I
         ڼ   I   I   r        ڼ   I       /   !   /           I
   %  v  $   *     I        ڹ  I   I   r     +   ڼ   I   ,   /   -   /           I   %  v  0      I      3   ڹ  I      5   S   6      r  I   I   8       I   ;!   v ڼ*     I        ڕ?      r  I   8"   #   ;$   ;%   ;&      I   ;   l'   ;   v 8(      ;)     ;*   +   ;+   ,   ;,     ڼ   I   I-   .   r   ڹ   7   U      I   I-   .   g     h    v ڗA   Y     I/   ߹  v ڼ   I   I-   .     v    ڕ^      z  _      I   0   1   a      I   b   1      c   )  c      I   I2   3   l4   v ڗ
  f      5      I   I6   7   r %8   %r I2   9   l:   v ڗ   n      I   I2   ;   l<   v ڳ=      I   I>   ?   r I@   A   r =   ڶ=   I2   ;   lB   v ڼ   I   I>   ?   r I@   C   r ID   lE   v ڗ            4      I
      v ڣ@`	%****J	**
PP(***&&&&&CPI`&`J`)` P `PH`AuF`(` P `PE`AuF#` ` )%O$PD(`PM,` %*&&/J,PD?`

	
&/` PHC`,` 8	P>F `P$` 8P$`KM`.`0P `  PDT`:V@X` P
PNPD[`:]@_` "PDc` $PP)` "PDh` PP
PDm` `Js`
PDuPl   m/l   1                              I   r I      r I   l   v ڣ `PP
PD
P   c   D                           ڼ      r I         I   %   %r I   l   v ڣ&`P
 P
:PDP   $#   x                           ڳ         r I      r                      ڳ         r I      r    F`PP `PPI`!QL   BrL                             4      I      v ڣ `
P$PL   BrL                             4      I      v ڣ `
P$PL   BrL                             4      I      v ڣ `
P$PL   BrL                             4      I      v ڣ `
P$Pd   jad   )                           ڼ      r I      l   v ڣ&`PPDPL   ֡XL                             4      I      v ڣ `
P$P   F%   W   	                                 ڼ   I   I      r    ڼ      r I   l   v ڣ)` `@` P(`P
PD PX  8                          ڹ  I      ڹ  I      ڹ  I      ڹ  I      ڼ        I   r   ڼ  I      r   ڼ  I   I	   
      %r               I   I	   
      %  v ڼ      r   ڼ   I               I   I      r I      r   ڶ      I   I      r I      r I      r I   k      r J  ڳ      I   I      r I      r    ڕ-      I   I      1      I      2      I   3          %   %  ڼ   I    I      9     !   %-  ڕ:     I   0   =     "      I#   %$   %%-  ڗ  A     I   o   D     "      I#   %   I      H   %      H   &   H   %     Jr %'   %%-  ڗ  N     I      Q      Q   Q       ږQ       I   &,   U     (   %-  ڼ  /'  ڗX     ږX       I      [     "      I#   %   I      _   %      _   &   _   %       Jr %'   %%-  ڼ  ,   g   ڼ    I   &   k   ڹ  k      l     )   %-  ڕm     /'  ڗo     )   %-  ڕp      I    I   %   t        I    *   %%-  ڕw     +      I   %,   %%-  ڹ  -   %-  ڼ   r  I.   8/   0   ;1   ;2      I3   ;4      I5   ;6     ;    7      I#   %8   %   I   %9   %;:   ;;   <   ;=   l>   ;?   v ڼ   I?            I?   v  ڕ   F`/`/`.`O	`+
PI` P(`  P</`A  F`  PD`*PI` ` (PP)`  PP P

P*` #PPN!` `% ` `@(`@*`	& `@-`	&+ P ` 	`f `@25`@5	`f `	&+ P 	`  `@5/`@=`@@` `@E`	-@G`@I` %JL&/OPIR1 <@TFV*JIPD  ` `P PX         8  D               `  z`  s                             I   r I      r I   l   v ڼ   I      1           	   	   f     
     
         I
   r I      r I   v  ڼ         ڼ   I   I      S         I
   I         I   I   k      I   r %   %v ڗD         5          I
   I         I   %   %v ڕ&      &         '         '      I      %)     ڼ   I
   I         v ڗQ   ,         I
   r I      r I   v       ڗ   2      2            I   r I      r I      r r 	  ڼ     I   r I      r I   l   v ڼ   I      1   B         C   	     D     D      I
   I    !   v ڼ	     I   ڼ   I"   K   A   L         I
   r I   #   r I   $   $   v ڕR     R      I
   I   %     v ڼ	     W   ڼ   I"   Y   p   Z         I
   r I        v ڼ   &      I
   I   '   r %(   %r I)   ߼
  v ڕf      I
   I)   r     H   k      &      I
   I   '   r %(   %r I)      v ڕs      s        K*   ڼ  I        v ڼ   +   r I      r I   l,   v ڶ-      v ڼ      I
   r I      r I   l.   v ڶ/      v ڼ  0      r K*   ڼ   I
   I    1   v ڗ            @`PP
PD`@`
PP
PD` 	`  

P
P.`/	`  PI`@!` ` P$`@&`
PP
P$`+` `J.`PPPPI1`PP
PDa` ` PDe` 	`
PP !PIh`@k`  PDm`@o	`
P PDq	` P
P
;PIt` P 	` P
P7PIw`@z` ` $PD~`PP
PD  `P `
PP
PD  `P `P ` P ` ` P`  5`           	                       ڼ     r I   r    ڼ   I         ڹ        N      /            I   %   %   I   %	      I
   %v ڗ[         I         ڹ        -      /            I
   %   v ڕ    &`*`P
P(
` `$	# ++	#KPN` `$	E	PI`!Q  ?          
       C          ڼ     r I         I   %r   ڹ          ڹ  I      r 
   =        I      r   ڹ  J   ڹ  J  ڗ4           r I      r    ڹ    ڕ          r +           r I      r    ڕ      
  ڹ    ڼ   I	   
   1                  .               r I      r   J   "         "      "     ڼ   I   I        %   %   %   %  %   %v ڗ   +        J(   .      I   I        v ڕ1       I      4         4      4   %  %   %   %  ڗk   8      I   I         %   %  %   %v ڼ        %  %   %%-  ڗ   C      C   6@`P
	PH
` P ` 
P(`+` `PP(`N
`P-`PPM`*`J` `PP 	` P$	` ` 
` PI%	` "+	` 	` P$	`2 	` 	`J.P  )                             ڼ      r    ڼ      r I   r     ڼ      r I         v ڼ     I   r I      r I   l   r I	   l
   v ڣ&`P)`P
P)	`P P$	`
PP
PJPDPx   h5wx   9                           ڼ      r I   r     I   k      r &
`	P
P

P$	Q   _C   H                           ڼ      r I   r              I      v ڕ   &`P
P ` PI	P   Ge    G                           ڼ      r    ڼ      r I      r I   l   v ڣ&`P)	`PP
PDP   9   M                	           ڼ      r I   r     I   r           I   v  ڕ	   &`P
PP.`PI	P  &L                  e        I   8   8      ;   ;   ;     r    ڼ*     I         ڼ   I   I	   r        ڹ   I      /      /   
         I   %  v        I                      I   r I      r I      r   ڼ      I   r I      r   ڼ        %   %r    ڼ        %   %r I   r    ڼ         I   r        %   %   I   %   %    ږ/       I      2       %J     6         6      6     ڹ       %   %    %J%   %    J%   %%-  ڼ  %  ڗ[A         %-  ڼ      I   r I!   "   r I#   ߹  v ڼ      I   r I!   $   r I%   &   r I'   v  ڼ      I   r I!   $   r I%   (   r I)   v  ڼ   *     %r I+   l,   v ڼ   *     %r I-   +   v ڹ   I      c      I   v  ڕe   @`	%*&&CPH	`)` P `/
P^`A9F` `A9F`
PPPH`
PP(`PI!`P
%PH`,	PH` `f  ` `	# @ `@`@"`
PP
PD%`
PPP
PD'`
PPP
PD*`P
PD2`PPD5` `PI9P                j           	                 ڼ     r I   r     ڼ   I   ߹   v ڼ      I   r I   ߼     r I                                 %   %r I   r  v ڣ&`P
PH`PD`
P
P
 P
APP$P  "b
                  C         I   8   8      ;      ;      ;      ;   g    ;	   
   ;      ;      ;      ;   ;      ;   ;   ;   ;     r    g             ڼ*     I         ڹ   I   I   r        ڼ   I      0      /            I   %  v               I   r    ڼ   r  I   8      ;   ;    ;!      I   ;"      I   ;#   l$   ;   v ڹ   I%   &   1   0   '   H   1   (      2      2      I   I)   *   l+   v ڗ   5      ,      I   I-   .   r %/   %r I)   0   l1   v ڗV   =      I   .   ?   /            I   %2   v ڕB      B      B   9               v ڣ@`	%*********&*&&&CP9 ` `K`(` P `PD`ALF`/
PI ` %*&&//J PD4
`06 `  PD:`:<@>` P
POPDA`:C ` ` P)` `JJ`PDLPd  T                               I   r I      r I   l   v ڼ     I   r I      r      ږ
        I   I   _                I   r I   	      I     J%
   %r Mڼ  /'  ڗ   @`PP
PD`PPI
`f ` P
 PE.`@Pd         ]   z   |   G|   @                             I   0      /            I   %   v      	` ` PE`!VT   4T                             9               v ڣ `P$PT   4T                             9               v ڣ `P$P|  xEQl  `  $      
       [           ڸ    ڸ    ڸ             ڼ*     I        ڼ        I   r    ڹ  I      8      ڼ   I   !   
   ڹ   JI      I                  I   I	   
   r    J            I   I	   
      Jv ڼ         %r I   v  ڹ  I   I   r  I         %   %v      ڼ   I   I      (        %-  ڕ)           I   %   I      -         -      -   %      Jr %   %%-  ڼ   I   I   %   7        I      %%-  ڕ:        %-         ږ;        I   I   C   ?           I     J%   %%-  ڼ  /'  ڗF      r  I   8    !   ;"   ;#      I$   ;%      I&   ;'     ;   (     %)   %;*   ;+   l,   ;-   v ڼ   I-      Y      I-   v  ڕ[   @`&`K`H	`+
P(` R `AyF` P  `AyF` -PD`P
PD` P
PD`*` `@!`	&+ P@%` `@(`@*`*`f `	#@+,`@/` %*&/O5)!@8&J/PDv` `PIyP|         \  ^   L  S}#<  U                 6           I   r I      r I   l   v ڼ  I                x  	     	   	      ڼ   
   %-     ږ
       I   I             J         ڼ  I      6      /          I     J%   v             I   %   %    JI      r %   %%-   ڼ  /'  ڗ##         %-   ڼ     I   r I      r I   l   v ڼ      %-   ڗf   +   	      ڼ     I   r I      r I   l   v ڼ      %-   ڗ   2      2           %r I   ߼   v ڣ@`PP
P4@`0 `+` `f ` ;` P[`A:F`
  P@0`@`@`PP
PD%` `:( `+`PP
PD3` ` `J9`P
P$PL               D  D                            ڼ     r I   r     ڼ  I         ڹ         >      /          I   %     I   %v ڗ\        I         ڹ         .      /     	     I   %
   v ڕ    &`P
P(	` `%+%KPN` `%EPI`!Q\  nrL                            ڼ      %-     ږ       I   I                 I   %   %$         J      r I        I     J%r   r %	   %%-   ڼ  /'  ڗY      
   %-   ڣ&` `f 	`
 P
	 P&P@1`@` P\               0  \                  )            ږ        I   I   `         J         ڼ  I   	   6   
   /          I     J%   v           %-   ڼ        I	   %
   %    JI      r %   %%-   ڼ        I   %
   %$         J      r I        I     J%r   r %   %%-   ڼ      %-   ڼ  /'  ڗ)   &`f ` ;` P[`AF	` 	`
  P 	`
 P
	 P&P 	`@1`@P0            {    |m                  R         I   8   8      ;      ;      ;      ;      ;	      r  I
   I   r  ;      ;      ;      ;      ;   ;   ;     r                 	  ڼ*     I	       
  ڼ 
  I   I   r        ڼ   I      0      /    	        I	   %  v          
  r    ڼ   I   I      %      I      &      I   '            %   %  ڼ   I   I      -        I   %-  ڕ/        %-  ڼ   r  I
   8      ;   ;    ;!      I   ;   l"   ;   v ڼ   r  I
   8#   $   ;   ;       I   ;%      I   ;     ;   &      I   %'   %;(   ;)      I   ;   l*   ;   v ڼ   I      P      I   v  ڕR    `	%***J*
PP(****&&CPI`+` `K`)` P `PD`A  F`+PI!` `% ` `@&`@)` %*&&/J)PD:` %J=&/OAIC1@EFG/J:PD  ` `P Pl   l'l   1                              I   r I      r I   l   v ڣ `PP
PD	P   ĒP   D                           ڼ      r I         I   %   %r I   l   v ڣ&`P
 P
9PDP   ȓ.   L                           ڼ      r I      r                      F`PP@`!Q4  FJ4                   u            I   r I      r I   l   v ڼ 
  I      1           	   	   f  
     
       
  I
   r I      r I   v  ڼ         ڼ   I   I      S       
  I
   I         I   I   k      I   r %   %v ڗD         5        
  I
   I         I   %   %v ڕ&      &         '         '      I      %)      ڼ 
  I
   I         v ڗQ   ,       
  I
   r I      r I   v        ڗ   2      2        I   r I      r I   l   v ڼ 
  I      1   :      D   ;   	   v   <     <    
  I
   I      v ڗ  ?    
  I
   I         v ڼ 
  I
   I       v ڗ  E    
  I
   I!   "   r I   #   r    ڶ$    
  I
   I!   %   r I   &   r I   '   r I   k(   )   r J   ڳ*    
  I
   I!   "   r I   +   r *   ڼ      K,   ڼ   I         v ڼ   *   r I      r I   l-   v ڶ.       v ڼ    
  I
   r I      r I   l/   v ڶ0       v ڼ   1       r K,   ڼ 
  I
   I   2   v ڗ   u      u   @`PP
PD`@`
PP
PD
` `  

P
P.`/`  PI`@` ` P$`@$`
PP
P$`+` `J,`PP
PDX` ` P$` ` !P$` P$`@b` )PP)` !PP P

P*` $PPIf`@h` $PDj`PP
PDs`PDu`
PP
PD}`PD`P ` P ` ` PD  <D                            ڼ     r I   r     ڼ   I         ڹ         >      /    	        I   %      I   %v ڗ\         I         ڹ         .      /    	  	      I   %
   v ڕ    &`P
P(	` `%+#KPN` `%EPI`!Q  n          
       C          ڼ     r I         I   %r   ڹ          ڹ  I      r 
   =        I      r   ڹ  J   ڹ  J  ڗ4           r I      r    ڹ    ڕ          r +           r I      r    ڕ    
  I	   
   1                  .               r I      r    J   "         "      "     ڼ 
  I   I        %   %   %   %  %   %v ڗ   +         J(   .    
  I   I        v ڕ1         I      4         4      4   %  %   %   %   ڗk   8    
  I   I         %   %  %   %v ڼ         %  %   %%-   ڗ   C      C   6@`P
	PH	` P ` 
P(`+` `PP(`N	`P-`PPM` `PP ` P$` ` 	` PI!` "+` ` P$`2 ` `J*P   d   n                
           ڼ      r    ڼ      r I         v ڼ   
  I   r I      r I   l   v ڣ&`P)`P P$`
PP
PDP   *8   R                	           ڼ      r I   r     I   r           I      v ڕ	   &`P
PP.
` PIP   	5v   G                           ڼ      r    ڼ      r I      r I   l   v ڣ&`P)`PP
PDP   p3   M                	           ڼ      r I   r     I   r           I   v  ڕ	   &`P
PP.
`PIP8  Vw~(                  ~         I   8   8   ;   ;     r             ڹ        I   )%   %%-  ڹ   I   I	   
   I              I   I	   %   %   I   I   %   %%-  ڗ<        I   I   r                I   I	   %   %   I   I   &   $    1      I   I   r    '      '   %   %%-  ڹ   I   I   7   -         0      I      r %   %%-  ڕ2   Z  2      I   I   r  #   6   ڹ   I   I   I     :   N   ;           I   I	   %   %   I   I   I   %   %%-  ڗ  E      I   I   r  #   I   ڹ   I   I   I     M   W   N           I   I	   %   % 1      I   I   I   r %   %%-  ڗ5  Y           I   I	   %   %%-  ڹ   I   I   7   a         0      I      r %   %%-  ڕf        %-    ږg        I   I   I   s   l         r  I   I   8       I   I   I!   ߹  r ;      I   %;   r %-  ڹ  /'  ڗt|        %-  ڕ}     "   %-  ڹ  @`	%&&CP8 `'`G`J`	:@` `	B/D@` 
P-`	B/ )P ` `	'
	
P@` 	P 4 `	B/D@` 	P 4 `	B/
 P0" `	O ` `	'
	
P@(` 	`f `
P$% P(@*!PJ)/`@/`@1`@3`$Q8         V       ыAG           
       Q        I   8   8      ;   8   ;   ;     r    ڹ   I   	         ڶ
             
            8     ڹ   I   I            I   I              ڼ  I   8   ;      r  I   I   r     %       I   r  %;   l   ;   v   ږ&         (      I     J	      ,   
      ڗ   -     >   /             I     J%   %   r    ڗ3   5             I   %   %   r    ڕ:         I   r I      r I    l!   v ڕ@      I     J	   J   D       (   F      I"   k#      r    H   H      ڕH     $   J        I     J   MڕM     /'  ڗdO        Q        Q      Q   @`	%**&CPH	` ' `EKF`+`*`@`EFPP	=Z
P)JPD`fO!` ` ` ` P ` PN*`
PP
2PIA` ` 
P@D` `@`@I`@KQ         /    4   n4   
                               ڣ `)P  =n  V                          ڼ   I   ߼      r I   r  r $           r I      r    1   
      G         l                  r I   r     ڗ            r I	   
   r I   r     ڗg            r I	      r I      r    ڗ,            r I   r     ڗ         &	`P
PPM`PP 	`P
P)	` 	`PP
P)	` 	`PPP)	`: 	`P
P)	`J`AV  zHS           	       d         I   8   8      ;      ;   ;      ;	   ;
   ;     r          ڼ*     I        ڹ  I   I   r        ڼ   I      /      /            I   %  v                       ڼ   r  I   8      ;   ;   ;      r  I   I   r  ;   l   ;
   v ڼ   I      &   ڼ   I   '   /   (   /            I   %   v  +      I     .         %  ڹ     I   T   1      I	   I      5         I	   %   7      7      %u   8         I	   I   %   <         I	   %   %   ?      ?   %    %   !   I"   r %#   %F   %-  ڳ$   %      %&   %  %'   %   I   I(   k)      I   r %*   %$   ڼ     I   r I+   ,   r I-   ߶$   v ڗC   Z      I   /   \   /            I   %.   v  _      I
      b      I
   v  ڕd   @`	%**&*&&CPI`J`(` P  `PG`AIF`+`+ `K` %*&&
PP(JPD3` ` P$`AIF7`@9`K;` <  3 ,

P `
'. 

P@@`	PP
!P.` ` P$`AIFF` `PIIP   k   B                  	            I   r I         I   %   %r I   l   v ڣ `P
 P
;PDP$  كR$                             ڼ      r I      r    ڼ   r  I   8      ;   ;   ;         r I   	   r ;
   l   ;   v ڼ,         r I   	   r    r    &`PPI` %*&&PP(J
PD`PPPI`!Ql   7^l   1                              I   r I      r I   l   v ڣ `PP
PDP   71   c                           ڼ      r I      r    ڼ   .           .  %               ڣ&	`PPI	`"  P  H#                  9         I   8   8      ;      ;      ;      ;     r       ڼ   r  I	   8
      ;      I   ;   ;      I               I   "         r  I	   I   r     ;   l   ;   v      ڹ   I   I              %-  ڕ           %   %%-  ڹ   I   I   $   &        I      %%-  ڕ)        %-  ڼ   r  I	   8      ;   ;      I   ;      I   ;     ;      ;   ;      ;   l    ;   v ڼ   @`	%****CP8	 `'` %*.& <PP-JPD`*` `@`	U ` `@!`@#` %*&..)*&*J#PD2`%Ql   
1l   1                              I   r I      r I   l   v ڣ `PP
PDP\   j.\   )                           ڼ      r I      r    ڣ&`PP)Pl   l   1                              I   r I      r I   l   v ڣ `PP
PDP\   *h\   )                           ڼ      r I      r    ڣ&`PP)P  F           
       7         I   8   8      ;   ;   ;      ;	   
   ;      ;      ;   ;   ;     r    ڼ   r  I   I   r     ڹ   I      ڼ   r  I   I   r           I   %   %  ڹ  I   k      I   r I   k      I	   r   ڼ   r  I   I   8      ;      I   ;   r   ڼ        %   %r   ڼ     r I    r  I!   ߹  v ڼ     r I"   l#   v ڼ   I      5      I   v  ڕ7   @`	%*&&****&&CPI` P(`/` PI` `

P
/

PH` &%*O*PH`P(`P
P
PD`P
PDQ` `PITPD  hޑ4                 ]         g       ڼ     r I      r    ڼ   I               r  I   8      ;   ;     ;	   
     I   %   %;        I   %   %;   ;   l   ;   v ڼ  I      ڼ        I   %r I   ߹   r I        I   v ڼ      r I      v ڼ   I     '     I      ڼ        I   %r I   ߹   r I        I   v ڼ  I   W   3           I    %!   %r I"   v  ڼ   #   r I         v ڕ<     I$   
  >   %      I   %&   %   I      D   '      D   (   D   %)   %    ږF        I   e   I     *        JJ%+   %,   I-   %.   %     JJ%/   %%-  ڼ  /'  ڗX           I   %r I0   ߹  v ڕ]   &`K`PP)` `A0F` %*&J9@G@&JPD`/`P
5P
PD`P=P$` `/`P
5P
P$` ` P
1P$`P +PI'` ` - `f `	& $ @)*`@,`P
7PI0PD         q  {      iѥ   n                  
         I           I   r                ڼ     I   r I      r I   l   v ڣ ` P `PP
PD	P   C  4        	                  ڼ  I   @           r I        I   %r I   r  1   	        r I        I   %r       ڼ      -      ڼ     r I      r      l        I   g        r I      r h         r I        I   %r h   v ڕ    &` P
	P
$P P
	PM` PP `PPP
	PPIP  .;M:  #                          I   8   8      ;      ;      ;   8   ;	     r          8
      ڼ   I	   I            I	   I               ڼ   r  I   8      ;   ;   ;      I   ;      I   ;   l   ;   v ڼ                        @`	%****CPI	`+`+`@` %*&&//JPD`@ Q  p                                     ږ        y            I     J     I   r I         I     J%   %r I      r Mڼ  /'  ڗ{   P           I   r I         I   %   %r I      r    ڕ    ` 
`f ` +P
 P=PE`0 `P
 P9PNP                 =  #                          I   8   8      ;      ;      ;   8   ;	     r          8
      ڼ   I	   I            I	   I               ڼ   r  I   8      ;   ;   ;      I   ;      I   ;   l   ;   v ڼ                        @`	%****CPI	`+`+`@` %*&&//JPD`@ Q  exbup                                     ږ        y            I     J     I   r I         I     J%   %r I      r Mڼ  /'  ڗ{   P           I   r I         I   %   %r I      r    ڕ    ` 
`f ` +P
 P?PE`0 `P
 P;PNP                 S  (                <        I   8   8      ;      ;     r    ڼ   r  I   I	   r    ڼ   r  I   I
   r     ڼ   I      ڼ   I      ڼ   I      ڼ   I      ڼ   I      Y         r  I   I   8     ;   r    ڼ      r I   l   v ڗ           I      ;   "      r  I   I   8     ;   r    ڗ(      I         ,      I      -      I   .     ڶ        %   I   %   %   %   I         8         I   %   :      :   %K   ڕ<   @`	%*JCPH` P(` P)` ` ` `@` `	P%IPI`P
!P>4 
f
 `	P%I6P@<` `( & @@@P           Q   T  ]ǽT                 I          ڶ   I   I      r =         I   I      I   I      r r          I         ڼ   I      G            I   I	   k
      r I	   k      r %              g      ڼ      $        I         %v ڕ!         $   $     I         %v ڕ'         $   *     I         %v ڕ-        I   .   0        I      r %   %   4      4   %   %   %   %   %  I      <         I   %   >      >   %   I         C         I   %   E      E   %  ڼ     r I        v ڣF` P / PP@`  
P

P@`*` `
PI` `PI` `PI`$  P@+L -@ H `PP$P<  sl<        	          i         I   8   8      ;   ;   ;   ;     r    	     ڼ*     I        ڹ  I
   I   r        ڹ   I      .      /           I   %  v       I            ڹ   I      .      /           I   %   v       I
     ڹ  I      r I      r   ڼ         I   r   ڹ  I   r  I   ߹  I      r r I   8      ;   ;      ;   r I   8     ;    ;!   v ڼ   "     %r    ڹ  I   #   r I$   l%   v ڹ  I   #   r I$   l&   v ڼ   "     %r I   r  %  ڹ    ڹ   I      F   ڹ   I   H      I        I      L      I     ڕM        I      P      I     ڕQ        I      T      I     ڕU       ڹ  I        '   %r I(   r  I        '   %v ڹ  I        '   %r I(   r  I        '   %v ڼ   "     %r I)   v  ڣ@`	%*&&&CPH	`J`(` P  `
PQ`A?F` -`P]`A?F`.` PPH`(	P(`P
 PP
-%*&JCPJ%)FPD`PI!` P
PD%` P
PD*`P
P+`)` ` `@0` `@3` `@7`I:` 
P
!P
P$` 
P
!P
PD>`P
P$P   &Aä   X                           ڼ   I            r I   r  %   %      r I   r  %   %v ڣ&`P
P
P
P
P$P   &Aä   X                           ڼ   I            r I   r  %   %      r I   r  %   %v ڣ&`P
P
P
P
P$P  [Lʐ                  Y        I   8   8      ;      ;      ;   ;   ;	   ;
      ;   ;   ;   ;     r    g   g      h       h   h   h    g      h       h   h   h   g      h       h   h   h      ڼ         I   %r I         I                        %   %v ڼ      r I         v ڼ   I          ڼ   I	   !   L   "      r  I   8    !   ;"      I   ;   ;#   l$   ;%   v ڕ+      g      ڼ   I   &   .   0      ڹ  I'   ߼   I   v ڗ-   3      I   I(      ڼ   I     ڕ6      I
      8     ږ8           :      r  I   8)   *   ;"   ;#   ;+      I   ;       J;   l,   ;%   v ڼ   r  I   8-   .   ;"   ;#      I   ;       J;   /   ;0   1   ;2   ;3   l4   ;%   v ڼ  /'  ڗV      5   r I6      v ڣ@`	%***&&&*&&&CPI`   %@`P*EFPD`P PD"`@$` %*/&J$PIn`&`*` `&`
P ` `@x` `f/` %*&&//Jz	PD  ` %*&//**&J  	PDy`@  `P3P$P         q     l   l   1                              I   r I      r I   l   v ڣ `PP
PDAP(  i(                 /           ڼ      r    ڼ   I   I   *      ڼ   I      r    I   	   F  
      I   %      ڼ   I      r             ڼ   I               I   e         r  I	   8
      ;      I   ;      I      r ;   ;   l   ;   v ڕ!      I   e   #      r  I	   8      ;      I   ;      I      r ;   ;   l   ;   v ڕ/   &`PI` 'P@` P @	`@
` %*/ P(&JPI.`@0
` %*/ P(&J0PI?Pl   Y{]l   1                              I   r I      r I   l   v ڣ `PP
PDP  =d                 -         ڼ     r I      r I   r    t          r I      r      ږ
        I               r I   ߼     JJr I   l	   v ڼ     JJ{         I   
   r   ڼ7                 JJ  I     I   ߼.  r %r      JJ%v ڕ$     /'  ڗ&     ږ&        I   ,   )        JMڼ  /'  ڗ-   F`PPP `PP(`f@`P
P
PD` %` P(`
-PP4N!PI-`@`f `@-`@P         g             g  B      hTy#                              ڼ7               I      I   I            I   "         r  I   I   r  
   .  %      r I   r  %v ڼ     JMڣ&`
) &PPP
PD!PD` Pl   z l   1                              I   r I      r I   l   v ڣ `PP
PDP    )   X         
                  ڼ7                  r I      r       r I      r v ڣ&`
PPPPP$Pl   t$
l   1                              I   r I      r I   l   v ڣ `PP
PDPL   L                              ڼ      r    ڣ&`P)Pl   W4|l   1                              I   r I      r I   l   v ڣ `PP
PDPT  @MT                            ڼ     r I      r I      r J   ڼ     r I      r    +           r I      r               ڹ   I   	   r 1      7         
     .     %v ڕ   &`PPP*`	PP 'PP ` P/	`
PIP,  F
,     -                          ڸ    ڸ    ڸ    ڸ          8    	  ڼ 	  g    K   ڼ 	  g    K   ڼ 	  g    K   ڶ          r  
  ڼ  I   8	   
   ;      ;      ;   ;   l   ;   v ڣ@`'`'`+` ` ` ` PI`%***&JPD4PP  :0                  q              
  I   ߷  r         %         r    ڼ%         r   ڼ%         r   ڹ  /      ڹ  I         ڼ     r           	  I   I   ߹         ڹ   I                          v ڼ 	  I   I   ߹  v ڼ   /'   ڕ           I      #   ڼ 	  I   I   &      '   ڼ   I   (     )      I	      I
   ߼.  r %r         I      r %   %   I      r %   %   I      r %   %   I      r %   I      r       A         A      A   %   %   %   %   %   %   %   %3      r %   %  ڼ   I   4  N        %-     ږO       	  I   I      S    	  I      JI   r .  $   Y      	  I      J%   \    	  I      J^     ڹ      	  I      J%   %%-  ڹ       %   %3    	  I      Jr %   %%-  ڼ   /'   ڗm         %-  ڕn      !   r I"   ߹  v ڕq   Af P `
P(`
P(`
P(	` .P `  P$` P$`@	` `PP(`%* P
3 P*& P
  P P ,,&	P/	` ` `f ` $P  `	- `	2	 P@/`@`@ `P
PI"PP            ?                 +    R                 
               %   r    ڳ      I   ߷  r             J
    `P(` P `HF`!Q   Ϣx                          g      h       h        ږ        I   D        I   ߹     Jr    	   	      /'   ڗ    ` `f `
	P `A	F,`@`!Q          $   X     ǰ                  G        I   8   8      ;      ;   c;   ;     r       g       ڼ   r  I	   8
      ;   ;   ;      I   I            I   "         r  I	   I   r     ;   l   ;   v ڼ&      I   r   ڼ     r I      r I         ڼ     r I      r I   l   v       ڼ   I      (      I   ߼:  v ڕ*     ږ*        I   e   -           J%-   ڼ  %   I   +   4         %-   ڕ5     /'  ڗ7         %-   ڼ   ,   9            %   %   %%-   ڕ=        r I      r I   v  ڼ     r I      r I   ߹   v ڣ@`	%**'&CPI	`'`@` %*&& 5PP-JPD`
PH!`PP.`@&`PP
PD3`J6` `PI;`f `@>` `@;&`@B`@E`/`	!@J`PP
PDL`PP
PDNP           {   l   l'l   1                              I   r I      r I   l   v ڣ `PP
PD	P   ĒP   D                           ڼ      r I         I   %   %r I   l   v ڣ&`P
 P
9PDP   &U   L                           ڼ      r I      r                      F`PP@`!Qx  Fx                            ڼ   /'   ڼ         ڼ      &   ;            r I      r I   r     ڗ               ڼ         ;            r I      r I   r     ڗ1         I   ߼      r I   r  v ڕ   &`M` ( `PP
P@` ' `PP
P0	 `P
PPIP  A                  D         I   8   8      ;      ;      ;      ;      ;	   
   ;   ;      ;   ;   ;      ;   ;   	;      ;      ;   ;     r    ڼ         I   %   %r    ڼ         I   %   %r I         v ڼ   I      r    ڼ   I      r    ڼ   I       r    ڼ   I!   r     (   ڼ   I   )   0   *   /   "   #      I   %$   v  -      I%   &   r I'   (   r I)   v  ڼ   I*   +   v ڼ   ,      I   r    ڼ   I-   .      %/   %   %0   %v ڼ   1      %r I          v ڼ      r I2   l3   v ڣ@`	%******&*&&*&)**&CP9@` P)` P *P$` 
P)` 
P)` 
PH`
P `+E
PD"`A  F&` 
PP
P$` 
PD*`!
P)`"PD.`P!PD1`P
PD  P         	                   ڼ     r I   r     ڼ        %r I   v  ڼ   I     I              I   8        I	   %
   %;      ;      ;   v g            I   %   %   ڼ  I   I               %-   ڕ           I   %   %  I   %   %   %   %  I   %   %%-   ڼ  I   I   %   -        I      %%-   ڕ0         %-   ڼ   r  I   8      ;    ;!     I"   ;#     I$   ;%      ;     I&   ;&   '     I   %(   %;)     I*   ;*   l+   ;,   v -       ږE        I     H     I.   I   k  L   /         I0      O   1      O   2   O   r   ڼ     JI3   ߹  r       ږS       I      V        JI4   ߹    J  r   ڹ      JI   %  5     I.   %6   %    J%7   %  ڼ          JI8     r   %     JI8   ߹  r %Mڹ    I   %  ڼ  /'  ڗp     9        J%:   %%-  ڼ  /'  ڗ0v           %r I;   ߹  v ڼ        %<   %r I=   l>   r I?   l@   r IA   lB   v ڼ   I   3              %r IC   ߼  ID   v ڕ     I      -   v ڣF`P
PI`P
PD	`
 `AzF`% *JPD`K`% ` `@`	 ' . ` `@ `@#` %*&//)/1 /J#PDH`*	`f@K`@M` PHO` P(`FR`f ` 
P(`
 `  ` (P P&`OR2`@[`	K@I%`@_`P
PDa`P
"PJdPJkPDu` `P

PIy` 
P$P                     @       鬂   n                  
         I           I   r                ڼ     I   r I      r I   l   v ڣ@` P@`PP
PDP  ],  "        
       ;          ڼ     r I        I   %r    ڼ  I   @           r I        I   %r I   r  1           r I        I   %r      ڼ  I              I   ߼   r   ڹ  <      ڼ  I	   &      ڼ  I
   ߹     r     A   !     I   ߼     r I        I   %r v ڕ(      (        I      I   r <   -   ڼ  I	   &   0   ڼ  I
   ߹     r 3   A   4     I   ߼     r I        I   %r v ڕ;   &`P
	P(` P
	P
 P P
	PM
` `P(`@
 P 	`P
	PP0@`
PO P 	`P
	PPIP   '%P   f                           ڼ        %r I   ߼  I   v ڼ        %r I   ߼      r I   r  v ڣ&`P

P$`P
P
PP$P   ^g   K                          8      ;      ;      ;      ڼ     r I   ߹   v ڣ&`%**O`P
P$P   z   K                          8      ;     ;      ;      ڼ     r I   ߹   v ڣ&`%**O`P
P$P  \  =                )       8     ڶ   I   I      I   I   r   ڹ  I      r   k        ږ
        I         	     I
   ߹     Jr 	   ڹ  I   ߶   I   r j      	         ڶ	   I      <        	   J    	   Jr I   k      r Mڕ'      /'   ڗ.)     0 `J` P(` P(`J	`f ` 	P)`

P-	` ` 'P

PJ	`@`DQ         [        	-  2                #         I   8   8      ;     r    ڹ   I   I   $   	      I     ڼ  &   
     I                 I     ڹ  I	     I
      r r   ڶ      I	     I   ߼.  r %r r I   r     ڼ   r  I   8      ;   ;   l   ;   v ڼ  @`	%*CPH` `/`E&K` `E&F`/` 	PP(`PPP
IPI` %*&JPD%`%Ql    |l   1                              I   r I      r I   l   v ڣ `PP
PD	P  ?G           	                 ڼ     r I      r    ڹ   I      I   ߼.  r %r I   r    ڼ   I   ߹  r .           r I      r      &`PP(`PP
4P(	`P/`PP)`AV  rQ           	       S        I   8   8      ;      ;      ;      ;	   g    ;
   ;   ;     r    g       g       ڼ   r  I   8      ;   ;      I   ;      I   ;      I   ;      ;   l   ;   v         ږ         I   @             %   %   I	   %   %%-    ږ%        I
   I   c   )           I
     JJ%   %      I
     JJr %   %%-  ڹ  /'  ڗ7              J%   %%-  ڼ      JI   +   ?              J%   %%-  ڕC        %-  ڹ   /'   ڗF        %-  ڼ   r  I   8    !   ;   ;      I   ;      I   ;     ;"   l#   ;   v ڣ@`	%*****&&CP9 `+`K` %*&///*JP4" `*`f `	 	`f `	 % P@&7`@)`	 ` `	$@-`@$&`@/`@2` %*&//)J2PD@P         A  }             U  l   l   1                              I   r I      r I   l   v ڣ `PP
PDP   >                             ڼ   I   ߼     r I      r v ڼ     r I      r          I   ߹   I      r %r %   ڼ   I   ߹   v ڣ&`PPP$`PP(` PP)`P$Pl   al   2                            I             I   ߷   v ڕ   @` `PIPh   8!h   3                               ڹ   I      r I   l   r /` P
PCQ@   đ)U@                              ڹ   I      &`	&Q   ?   d                         ڼ  I   8   8   8   ;   ;   ;     r    g       ڹ  I   l	   v ڼ   F`	%*&&CP9 `K`
PD%`E'Q@  ('0                 +         8      ڹ  I     ڼ  I   ߼  I   l   v ڳ      ږ        I   1          JI     ڼ  I     J  ڹ           I	   A        I
   $        I      r J             ڹ           I               ڼ  I         ڹ      1                   JI     r Mڕ$         /'   ڗ)     I   ߼   v ڣ&` `N`
PD`f
 ` ` ` BP ` ` ' `!PJ0`@`PDP@         J   F  D   D                              ڼ      I      Mڣ&` Pd  yڀd  }                 2                                                        
                *     	   :  	   
   J  
      Z        I        Y     p              r    ڗp         8     r    ڗO         	     r    ڗ.              r    ڗ         '     r    ڗ               r    ڗ               r    ڗ   "            r    ڗ   %            r    ڗh   (            r    ڗG   +            r    ڗ&   .            r    ڗ   1      @`@`P)` `P)` `!P)` `P)` `#P)` `P)` `P)` `P)` `#P)` `P)` `P)`@)`P)`J,`%Q,   
,                                `#Q@   @                                  
r  `P#Q@   D.@                                  r  `P#Q\   Kqa\   /                                               ڹ    ` `$Q`   \V`   &                              I   k      r     `


PP#Q    A                '         I         %       I      r    ڹ   JI      r   ڹ  I   +      8      J;      J;         8      J;     JI	   k
      r ;     JI	   k      r ;     JI	   k      r ;     JI	   k      r ;     JI	   k      r ;   '    ` `A; `P($` P(` `K; `%+'
P((
P($
P()
P($
PHVD  ]4            	               I               g       ڷ  I      r      ږ        I   [   	    8        J   %     %J%r   ڹ   I   ߹  v ڼ   %   ڗ          ` `A; `*`P(`f ` P(`PD'`@
`DVD         H   p      A   Y                 
         I         =        I      r    8      J;      J;   
    ` `A; `P(`KVD  4            	               I               g       ڷ  I      r      ږ        I   [   	            J   %     %J%r   ڹ   I   ߹  v ڼ   %   ڗ          ` `A;  `*`P(`f ` P(`PD)`@
`DVD         H   p   4  nE$                           I               g       ڷ  I      r      ږ        I   U   	        JI   #         I   ߹     Jv ڕ      /'   ڗ          ` `A;  `*`P(`f ` `
PI)`@`DV4         H   j      @J   S                          I         7        I      r    ڼ       J   Jr     ` `A; `PH`PCV,  X,           	       *         I   8   8      ;      ;   ;     r    ڼ      r I	   l
   r I      r    ڹ   I      r   ڹ   I      r   ڼ   I   I   #        I   ߼   I   v ڕ      I           I   v  ڕ     I   ߹  I   r  r   g       ڹ  I      r I   l   v 8      ;     ;     ;     ;      ;   @`	%**&CPI`P
PJUH` P(` PH` `
PI` `PI`PPH`K` P
PDH`			 	*Q|   ߫S|   ?                	           ڼ      r I   r  I   r I   r     I   F`	P
PP
P+Q  #+  $        	                  ڼ     r I      r I      r    8      ڹ    x        I   ߹   r   ڳ        r    ڶ   I      r I	   l
   v ڼ  I   ߼   v ڗd         r  I   8      ;   ;   ;        r I      r ;   l   ;   v ڕ    F`PPPH`K`,"`P(`	PI` P
PD`P> ` %*&&PP(J	PI'P      l                          ڼ     r I      r I   r     ڼ     r I      r I   r    ڼ        Mڣ&`PP
P(`PP
P(`/Pp   'نp   1                              I   r I      r I   l   v ڣ@`PP
PDPx   2x   :                           ڼ  I   ߹   I   l   v ڼ  I   ߼   v ڣF`	PD`P$PX   Y(X   *                         I      ڷ I     ڼ        Mڣ `-`-	`/P0   C0                               "  @`EQ  Lkp        	                                     g      ڷ I   I          I   "   	       r  I   I   r       ڷ I      r 	         
                            {                        ~                        Q        R     Z        ڗZ      I      r              r                I    I      r r %   % I   ߷ I      r %r %   %  ڗz   ,       I   ߷ I      r %r %   % I    I      r r %    %  ڗ   9      ڗ   9   :  9    I!   "   r      ږ;        I   k   >     I#   $        J%%   %    &   I'   r %   %     %J%   %v ڹ   %   ڗM     I(   )   r   ڗw  O    I!   "   r   ڹ  J  ڗK  R    I   *   r   ڹ   %   V   +     r I,   r  .   Z   +     r I-   ߹  r I,   r  `     ڗ  `    I   *   r   ڹ   1   d   +     r I-   r I,   r  .   j   +     r I-   ߹  r I,   r  p     ڗA  p    I   .   r /       s   0   
  t   u  t     I   1   r 2   -   x     I   3   r  .  %4   %(   |     I   3   r  .  %5   %          %6   % I    I   "   r r %7   %    &   I'   r %   % I   ߷ I   "   r %r %   %  ڗ7      .   I   ߷ I   "   r %r %       %   % I   ߷ I   "   r %r %   %  ڗ       ,    I   8   r 9   r       I   % .  %  %6   % I    I   "   r r %7   %    &   I'   r %   % I   ߷ I   "   r %r %   %  ڗ            ,    I   8   r 9   r        ڷ I          I!   "   r      ږ        I   *        I#        % .  %  %6   %     )J%7   %    &   I'   r %   %     )%J%   %v ڹ   /'   ڗh     I(   )   r   ڗ       I   ߷ I   "   r %r  3       I   3   r % .  % 3  %   % 3  %   %  ڗ;         ڗ)         ڗ         ڗ        @` `Eu6 ` `*` 3PPM
`
P `(` `
P0 `PP*
PP/`: `
PP$ PP/`: `(`J"` `P(	`f `)*

P*@'PD&*`@+` P(` `P(`+` `P(`,	P
P-	P
 P
P-` `P(`,	PP
P-	P
 P
P-` `
P@A`P #P _ `% PP
C

P*
PP/`@I`
PP)`+
PP/`:N@P`
PP(`	% PP
C

P*
PP/`JV`@Y`
PPH[`*` `P(
`f `	% 5

P*@_PD^1`@d` P(` `
!PP)`P ` `(` `(` `(`Jt`$Q                     h     <  hpD,            	                     ږ         I   I                 %   %  I   I   ߹   r I   %   % 1     I   I   ߹   r I	   r %
   %%-  ڹ   /'   ڗk        %-  ڹ   `*`f `	;+P!
PP@)`@` `$Q<               x  ۥGx                 1         ڹ            %   %r K   I               K   ڗ                 %   %r K   I               K   ڗA            	     %
   %r K   I               K   ڗ                  %   %r K   I               K   ڗ                   %   %r K   I      '         K   ڗ`   (               %   %r K   I      /         K   ڗ   0      K   ڕ1   F`

P `@`

P `@`
+
P `@`
-
P `@`
-
P `@`
,
P ` `@P  ]  1         	       6       g       ڷ  I      1                  ~           U         I   ߷  I   I      r I	   r        g       v ڗP         I   ߷  I   I      r I
   r        g       v ڕ   -      j         I   ߼        I   I      r %   %r I	   r     #   g    $   v ڗF   %      I   ߷  I   I      r    *   g    +   v ڕ,   p   ,     I   I      r I      r    ڼ      r I      r I   l   v ڗ   6      6      @`K
` `-` P
P P ` P
P PI` `-` P
P
8P P ` P PI` ` PP(`PP
PD` `J`EQh   %h   .                           ڼ   I   ߼      r I   r  v ڣ&`P
PP$Pp   o΄-p   7                             %   % %   % %   %   ڼ       v ڣ `"**O`	P$P  J  F         	       ,             ڼ       r I   r  I         %   %  %v ڼ       r I   r    ڼ       r I	   r    ڼ    
   r I	   r  *  *&   %  ڼ    
   r I   r  *  *&d&   %  ڼ       r I   8      ;     ;     ;   r I   r  I      
      ?r I   l   v ڣ `*`P
P
'P$`P
P(`P
P(`P
	P `P
	P `P

		P
<P P
PDPd   O5d   )                           ڼ       r I      l   v ڣ&`PPDPT   T                              ڼ       r I   v  ڣ&`P
P$P   ՒoY   N                              %    r  I   I   8       r  I   I   r  ;    ;   r % `	V&%
PP(H*PDQ   WhYI   K   	                        ڼ   r  I   8      ;   ;     ;   l   ;   v ڼ   9@` %*&(JPD`EQ   ,Հ   B                              I   r I         %   %r I      r    ڣ `P
PP)P  :֐           	       #         ږ        I             J   ?         I    5       J      JJr %-K   ڗ          JI   C         I    5       JJ      JJJr %-K   ڗ:       /     I         %   %    J%   v ڕ!      /'   ڗ#   0@`f@` ` !P@	` ` !
P0 `PI$`@P                 d%   \                  	                I   k      r %   %   r    ڼ      r I	   l
   v ڼ   @`

PPI`P
.PD`%Q      Q                           ڼ   I   ߼      r I   r  r             r       F`P
PP-`PI`AV      ]                 
        I   r    ڷ    I   I   ߷    r K   ڷ    I   I   ߷    r K   ڷ   `P(` 6P)` 6P)`#Q   R9   Q                                                     %   %   %   %  %   % ` `

*Q\   Sf\   *                             I   ߶   I   r  r 
      ?& `PP-Q   R   o                           I      r       ڷ  I   ߼ .  r    (           %   %  %   %            `P %P '
 Qd   QOd   +                           I   ߷  I   ߼ .  r %  I   r  `

PP#Q   p   U                           I   k      r I   k      r I   k      r I   k   	   r  `

P

P

P

P#Q|   4H|   @                              '        I   k      r             ` `

PC; `CVH   4)H                              I   k      r  `

P#Q3  `P = M   A : B  @      `_  B 6       Y S  C  M      S      %  0  |       `=     P&  	  `T     `T _  S        p     p  `T  
  `          p  `;          pY S  C  M  S   G 0        PE  H     _ %          p h K   t j k ]      p   p  m   ` W b ^ L (   S   Y M  o p      [  _       P   C 0  B   k   A               @U  #    ? D @ V    m o  q   p*   `   S  e      p  `= M           `  0     _  
    ` 0  F  M       _      
    `;        $  p      0  F  M      _      %  p &  p#  T   ` [ L Y C   0  S _  #        k                  @U  #     D  V   m o #  p*   `    -    B 0  f    > _    ?  j       @ A 
   7   %      `  @  B   Y       @   = $    Z  p   `Y     !      `# $ 0  6   `  2    S           `  `    `    `0    `U      P/    `0        @b    @    P,    P   P   P   P   `0     f   `0       @    `0     f   `0     f    `0     !  `F      0   F _ Y   2   W           [    ,          f    5 (         1    1       0  "  ` & 0       ! " %  #  ` ] S 0  S  Y ~ C    M      %  `f T $  `Y S  C  M  f S    	  = j _ k ] %  o p        p&  ` B C D )  ` (  `l "   p'  `     >      a    @       ! s   p*  `_      @F V { ,  `;    % ] _ U +  ` 	  @@  #    V   p* -  `0  I   # ' ( ) /  `  T .  `Y  +     P- "   .      p0  ` "   ? 1  `   <  >  @ 2  `V  1 2 3  `6 3 [   4  `  0  5  `    P   P4   P5   P6 6  `I      P 7  `    P8 9  `# "  :  `   * 8  `    @  ! <  #    " $ % & ' ( ) * + , - . / 0 1 2 3 4 5 6 7 8 9 : ; < = > @ >  ? B C D E 0  F     8  9  :  ;  <  =  >  ?  @  A  B  C  D  E  F  G  H  I  J  K  L  M  N  O  P  Q  R  U  S  T  V  W  X  Y  Z  [  \  ]  ^  _   a  b  c  d  e  f  g  h  i  j  k  l  m  n  o  p  q  s  r  t  u  v  w  x  y  z  {  |  }  ~                                                                        $                                                                                                                                                                                                        	 
             G H I  J L M N O P Q R S T U V W X    Y C  Z [ \ ] ^ _ ` a b c d e    f g   h ' i j k l m n o p q r s t u v w x y z { | } ~                                         2                                                  ,                              a                               	 
                      @     p  # % $ ' &   p( * <  `;    < = ;  `0   3 4  5 6 ?  7 8     @   9   #    % $ : &   p( @  `^ _ ` a b c ?  `   \ E ]    
  p>  `;    R    	  pA  `D B  `D C  `D D  `D F  `D E  `g s   p=  `    @  @   ? @ A B C D E  F V k G I H J K L * M P S T V X Y C  Z   @[   @N  #       p  @ W b ^  e f S  M  g h   pj _ k ] l   pm   pn o p    q   pr      pH  ` S     0     ] T G  `    @  @   [ * M S T   Y C  _ t   |  k j ]  Z    0          o M  p         #  h   p K  `M    J  `;          p0  0   ] L  `M  `I  `    @  @   [           k  
  L * M  S T      @N  #     D V   pY S  C  M  g h    pj _ k ] l !  p Q  `_ ` a P  `   \ [ ]    *  pO  `;    R    )  pS  `= M     @    T  `_   6       Y S  C  M      S      %  0  |     V  `T   U  `_  S        /  pX  `T  W  `        1  pR  `;        ,  pY S  C  M  S   G 0        P[  H     _ %    -  p h t l o p   [     P    .  p 0  p  m N  `    @  @   ? @  C [  F V G I H k  q * M  S T  0       @N  #     (  p  @U  D   m o +  pY  `    @  @           %    ! " $ % & ' ) * + = , - . 0      @  [  `\  `  T _  > ? A =    @  B Z  `     @!  @1 0 "  @2 M ' 3    #  @0   $  @    F 8 U  9   4  p( Y  ; "   <    =    5  p    Pa  `_ O `  `;    0    :  p_  `_ c  (  @N  #     0 V 9  p* Q ^  `;    \ E ]    8  p]  `  %  @&  @   E F G G H * M I S T K  '  @N  #     F V 7  p0  R T U ?  V &  W  5 '  Y Z ; >      P\ ] ^  _ d  `_ ' c  `;    2    =  pf  `_  e  `;      ?  pb  `  )  @*  @   D V a k  +  @  #    /  <  p*  0   d   e ,  @U  f m o g q >  pj  `   _  i   f i  `    ;      C  ph  `_ %  0   0  @U  #    V  i  k   m o B  p* l  T =   n    o q k ~ { ]   s     s         5    g  `  -  @.  @j i k    m l  n p o r q s *  u ' F w x     P  P| /  @V ~ ]    A  pl  ` ;     ] _  i k  `  1  @2  @   D V i 3  @ 4  @0   5  @N  #     E  p* n  ` ;    \ ] _ c { m  `  6  @7  @   D V { 8  @ 9  @0   :  @N  #     G  p* p  ` 5 6 ?    I  W   	  P 
  P    F  f    0  (  &      _  o  `  ;  @<  @    '   F u 0   F  ` =  @V     I  p>  @ I   ?  =    5 r  `  T   s  `  T   q  `  ?  @@  @      M  S T  Y M   o p         A  @     _ B  @ 0  #      K  pL  pa   y  `  D 0   F = x  `_ '       0     R  p   w  `;       1 Q  p{  ` _  U z  `;        T  pv  `V 0  _ j      F  @R  # D '    P  p*  G  @  S  pu  `;    0    O  p}  `|  `;    0    V  p  `_      F     6   ~  `;      X  pt  `  C  @D  @   D V                #   <  =  _ =     E  @P  #    N  p* I  f 0  H  @N   U  pI  @U   k  m o W  p    `_ * a   `   \ [ ]    `  p  `;    R    _  p  `   M T f   `  J  @K  @   V [ & '  L  @N  #     0  F ^  p*    [    a  p1 2 4 5 6 7      `_  ;     < _ 6 ? a f 7 0    `    ;      e  p  `#  l m  =   `Q  @q p r I t s    `R  @w p I x s    ` #   0    O  @V C )  U X W Z Y  ;  k  <  < \  ] >     P  @U  #    9 D : V q   m o d  p*    > Y      g    6 g  h 7 i j T k s f  pn g  pu h  py A   `  M  @N  @   9 : ; [ k , q o = <     > ? @ B A D C M ~ ]  F _ ' I  T K  L o p      M N 8 P Q R S #  T c  p  `S  @    0    &    P!      5       P     `_     6 '   `;    0    l  p  `  T  @U  @   V 0   5  6  f      V  @P  #    k  p*   `f _   /   6    `;      o  p  `*   `  W  @X  @   D V k -   * M  Y  @U  #    g q n  p 0           Z  @\  ~ p  p  `   `   *   r  p  `      `^  @&     u  p 0  a         %  f   `  [  @\  @]  @      t  p  `  =    `    =    `a  %    `   &   pf   `;    2      p  `    _  a  @        pf  b  @  #         p*   `  _  @`  @          po [      0  T s  =  p      pc  @      `  `  p"  pY  p[  p\  pv  pw  px  py  pz  p{  p|  p}  p~  p  p  p  p  p  p  p  p  p  p  p  p  p  p  p  p  p  p  p  p  p  p  /        
                         "  $  &  (  *  ,  .  0  2  4     8  9  :  ;  <  =  >  ?  @  A  B  C  D  E  F  G  H  I  J  K  L  M  N  O  P  Q  R  S  T  U  V  W  X  Y  Z  [  \  ]  ^  _  `  a  b  c  d  e  f  g  h  i  j  k  l  m  n  o  p  q  r  s  t  u  v  w  x  y  z  {  |  }  ~                                                                                                                                                                                                                                                                              	 
            
  @        p   @ # D  + k m o , q -   P .  /  0    1         2     * !   pF   p>   pZ   p '  p 2  p 3  p/ 6  pD ;  p` @  ph D  p| F  p H  p J  p M  p ]  p% b  p8 i  pu j  pF m  p q  p s  p   p   p    `  p9 X                
  |               E                 
      (     
      H           (     
   F   J           *     
      L           M           N           N           N           N           N           O            i       x   @   P      F   2   *     
        R            R      2      R      )      S      .      S      @      R      =      S      ;  .   T      2  	   U      {  3   V      n     *     
 i     X      y     Y      z     Y        .                *     
       [            [            [      -  +   \           *     
      ^           _        3   *     
      ^           ^           ^           _           ^           _      X  #   `        $   a      {     (     
 |     c        /   d           *     
      f           *     
      h        !   i           *     
      k           *     
      k      o  $   l      >  1   m      6     *     
 .     o           p        	   *     
      r        	   *     
      t           u        *   v           w           w        7   x      z     *     
 d     z      S     *     
 F     |      >     }      ^     *     
 Y     |           *     
      z           *     
      z      X            5  #        
 i     
       o                             *     
                                  w	  4         2	  E         	     *     
 	           	           !	  	         *	           	           	           	     *     
 	           	  $         	     *     
 	  	         	     *     
 
           
           0
  
         
           
           t                                                                                                                                                h
           :
           R
           ?
           L
     *     
 G
           D
           
             :   	            (            R            }                  ,     U       7            3           1           N            ]  	   P       V     *     
 f     K       q     ,       n           |                 I            3            #                       
                           X       H      Ƃ     Ƃ                                  ;  D  ;  D  J                                      ܶ  ܵ  ܶ               L    D      -               ^    ^              m    e      /           u  %  m  %  ?                    @  6                
    A  P               1    1  _  .               G    G  f  ]               +    +  m  0               4    4  r  0                   v  C                     w  %                                                  L  d D  d                        <            H   @     >           	 f 	 f g  8            
 
 w
 
 k  :            
 Z 
 Z m                 v  7            z  r  x  9                 6           U  M    *            )  )   1           3$ o& +$ o&               $ !% $ !%   9             & 8' & 8' 
  -             ( _( 
( _(   i           * = ) = !            s2 5= k2 5= Z             2 *5 2 *5 ]  ;            8 <9 7 <9 x  ?            6: < .: <   ?           .> 9c &> 9c   -           H J H J             H J H J   6            8I J 0I J   O            .M b &M b              M O M O   ;            ^T .[ VT .[   =           ^ _ ^ _ O  7            C_ _ ;_ _ R  8           y` Ua q` Ua Z  7            ` Ja ` Ja \  8             c hm c hm w  1          !n x n x   -            r s r s              (u w  u w   \           z l 	z l  	  +           ~ D ~ D 	             <  < 	  ]            Q { H { #	              p  p $	  7           b  Z  M	  ,               ]	             d  \  ^	  4            ? ȏ 7 ȏ y	                 z	  =            ݠ  ݠ 	  -           ]  ] 	              q  q 	              h  h 	  >               	  4            &    	                	  4            B ê : ê 
             ѷ  ѷ !
  .               6
  .           +  "  e
  3           o ׿ g ׿ 
  .            j  b  
  .           g y ^ y 
  +            _  _ 
             V  V 
  5                
  "          R  J  
  B                
  >            J   A     "                 ;             (  ( '                 (  6                6             S  K  7  ?            N  N G              t C l C W               G y G }                                    .           Q  I                    6                  O                  ,                 ,          -  $                M  M @             5 D - D D  >             X  X u  0            m 	 d 	 x                                 b 0 Y 0   .           n  e    /           8  0               ~  v    4            N(  N(   6           " ($ " ($              I#  $ A#  $   =             ' A( ' A(             ) * ) *              ) * ) *   (           * 0 * 0 !            `, / X, / ,              - :- - :- 2                V0 5 C0 5 K              25 H5 5 H5 z              c5 5 K5 5 }              5 5 5 5               5 $6 5 $6               @6 s6 '6 s6               6 X9 x6 X9               y9 : [9 :                : ; : ;               ; 5= ; 5=   "            X= > 8= >   "            > ? > ?             SA K KA K   $           	C C C C   *           F J F J   .            jG G bG G 	  /            I kJ I kJ             gI aJ _I aJ   6             I J I J   (            K K wK K *  %             DM ^ 1M ^ 9              =_ ` +_ `              a jg a jg             h l uh l              k k xk k   5             l m rl m              bn 9q Qn 9q             p 3q p 3q               q ,q q ,q   %             q r q r             r t r t               s s s s #              u Ax u Ax 0            y { y { H             ){ { !{ { M  :             /} T~ } T~ Z  "            ~ 1 ~ 1 b                p  h                   m              ˀ    r              B  /  w               f ΁ f |                {              5(9!LH'P      ffFҰ           O^partitionKey=%28https%2Cginniemae.gov%29,:https://www.ginniemae.gov/Style%20Library/GNMA%20Scripts/jquery.SPServices-0.7.2.js strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAAAAgAAAAAAAAAAAAAAAAAAAAEAOQFmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAXzMIIF7zCCBNegAwIBAgIQCWQN2lpJ/BKC2iI0Af/RwjANBgkqhkiG9w0BAQsFADA8MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRwwGgYDVQQDExNBbWF6b24gUlNBIDIwNDggTTAyMB4XDTIzMTIxODAwMDAwMFoXDTI1MDExNjIzNTk1OVowGjEYMBYGA1UEAwwPKi5naW5uaWVtYWUuZ292MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4j/zHl3Mds85m/ltuCEm7aSWj80hSrNONjG1vB9XsFy5nS5/Ry4z6HrkUMZ4CrIIc1i6cu0Gt00ympwhha/8/q0nkPrEIiJvhBV5RauNeHMdO0FHZEtyT1hYLnkcOmv6Z8TCcjj8Zgw0/nPhfqpDcV1ENssXjQJJI43+3t/NkafbO3eb35pXASitXf816KKuoXSUvG4HJYS10lnJlaJwKyxDBv6/ykrGtbqVoVf0YmeYSyjZWywnNj0n1qj+xlYKl0zx9OBRbYLAByKq6sLIwrJgmFgvj1TQ0gSGmZQHgRGXA9KN1sCqSPgoxd4ekKUHmwfDkQmfwtT9gkB1my12SQIDAQABo4IDDTCCAwkwHwYDVR0jBBgwFoAUwDFSzVpQw4J8dHHOy+mc+XrrguIwHQYDVR0OBBYEFDEqaBewE1itby3poreOqW8Y0eIbMD0GA1UdEQQ2MDSCDyouZ2lubmllbWFlLmdvdoINZ2lubmllbWFlLmdvdoISKi5jYy5naW5uaWVtYWUuZ292MBMGA1UdIAQMMAowCAYGZ4EMAQIBMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwOwYDVR0fBDQwMjAwoC6gLIYqaHR0cDovL2NybC5yMm0wMi5hbWF6b250cnVzdC5jb20vcjJtMDIuY3JsMHUGCCsGAQUFBwEBBGkwZzAtBggrBgEFBQcwAYYhaHR0cDovL29jc3AucjJtMDIuYW1hem9udHJ1c3QuY29tMDYGCCsGAQUFBzAChipodHRwOi8vY3J0LnIybTAyLmFtYXpvbnRydXN0LmNvbS9yMm0wMi5jZXIwDAYDVR0TAQH/BAIwADCCAYAGCisGAQQB1nkCBAIEggFwBIIBbAFqAHYATnWjJ1yaEMM4W2zU3z9S6x3w4I4bjWnAsfpksWKaOd8AAAGMejzPFAAABAMARzBFAiAXfELTslWJCzyM0f/gtTzt1+eibIWsZLCv2I+gW8kw5AIhAKmE8jcGT131bBwb8KUd1QzU6ltdiSO6HXnD2iRRtk+mAHcAPxdLT9ciR1iUHWUchL4NEu2QN38fhWrrwb8ohez4ZG4AAAGMejzPVgAABAMASDBGAiEAkGXVf3U4v9X/J/E+WaGzX36zScbBGBHHjUgIRh4V1b0CIQDS7eeq2WvTN0UNY1qEfDROz1QCuB75H5E97vxWdS/q6gB3AH1ZHhLheCp7HGFnfF79+NCHXBSgTpWeuQMv2Q6MLnm4AAABjHo8z0UAAAQDAEgwRgIhAL6X52Mf5M1DddN1cRt7b6HMjo0GmebYVSfv4WiliSNgAiEAxDL+Gh92TpKt+5Gb6i0+jomNp9IYfxilY9NCqQz1AfAwDQYJKoZIhvcNAQELBQADggEBADSdVk1ly7UCJkRdoXenR5tNorg+PKhiMdD2BLsmKs9VbDvMaXdYyEX3Htrel18vz8SeEgsYDt8R/c1mO2VchtdiM4OxtU+F2ldZj5ZpkcVqt8glueRv/uh0sgwIJWPu7sS5qBerPNOwFvrhi/00yOy36MEcPH6ui1vTsUWitaWdhP9Ad3UbrpNw6MHVsts3hz9Ik8e5YCANhHHfplXa/dTlSVzv5TpuEtNcAM+Ohs9jo9abhxW9LZa2kvnf4V/tRkkohFh5eA1ctpQc120KcrBRxf/PQ/FPK/5hr/d9E2iNmLc8vsYQw6l4YQrmr12mf95HZjzVbi7yQNLEqMvnJh3ALwADAAAAAAABAQAAAAAAAARQMjU2AAAAEFJTQS1QS0NTMS1TSEEyNTYAA2YKMiaRXE/7uyCJhaYy3wW9w5eaVCJM1YWJaWtuluqDAAAAAAAABfMwggXvMIIE16ADAgECAhAJZA3aWkn8EoLaIjQB/9HCMA0GCSqGSIb3DQEBCwUAMDwxCzAJBgNVBAYTAlVTMQ8wDQYDVQQKEwZBbWF6b24xHDAaBgNVBAMTE0FtYXpvbiBSU0EgMjA0OCBNMDIwHhcNMjMxMjE4MDAwMDAwWhcNMjUwMTE2MjM1OTU5WjAaMRgwFgYDVQQDDA8qLmdpbm5pZW1hZS5nb3YwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDiP/MeXcx2zzmb+W24ISbtpJaPzSFKs042MbW8H1ewXLmdLn9HLjPoeuRQxngKsghzWLpy7Qa3TTKanCGFr/z+rSeQ+sQiIm+EFXlFq414cx07QUdkS3JPWFgueRw6a/pnxMJyOPxmDDT+c+F+qkNxXUQ2yxeNAkkjjf7e382Rp9s7d5vfmlcBKK1d/zXooq6hdJS8bgclhLXSWcmVonArLEMG/r/KSsa1upWhV/RiZ5hLKNlbLCc2PSfWqP7GVgqXTPH04FFtgsAHIqrqwsjCsmCYWC+PVNDSBIaZlAeBEZcD0o3WwKpI+CjF3h6QpQebB8ORCZ/C1P2CQHWbLXZJAgMBAAGjggMNMIIDCTAfBgNVHSMEGDAWgBTAMVLNWlDDgnx0cc7L6Zz5euuC4jAdBgNVHQ4EFgQUMSpoF7ATWK1vLemit46pbxjR4hswPQYDVR0RBDYwNIIPKi5naW5uaWVtYWUuZ292gg1naW5uaWVtYWUuZ292ghIqLmNjLmdpbm5pZW1hZS5nb3YwEwYDVR0gBAwwCjAIBgZngQwBAgEwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjA7BgNVHR8ENDAyMDCgLqAshipodHRwOi8vY3JsLnIybTAyLmFtYXpvbnRydXN0LmNvbS9yMm0wMi5jcmwwdQYIKwYBBQUHAQEEaTBnMC0GCCsGAQUFBzABhiFodHRwOi8vb2NzcC5yMm0wMi5hbWF6b250cnVzdC5jb20wNgYIKwYBBQUHMAKGKmh0dHA6Ly9jcnQucjJtMDIuYW1hem9udHJ1c3QuY29tL3IybTAyLmNlcjAMBgNVHRMBAf8EAjAAMIIBgAYKKwYBBAHWeQIEAgSCAXAEggFsAWoAdgBOdaMnXJoQwzhbbNTfP1LrHfDgjhuNacCx+mSxYpo53wAAAYx6PM8UAAAEAwBHMEUCIBd8QtOyVYkLPIzR/+C1PO3X56JshaxksK/Yj6BbyTDkAiEAqYTyNwZPXfVsHBvwpR3VDNTqW12JI7odecPaJFG2T6YAdwA/F0tP1yJHWJQdZRyEvg0S7ZA3fx+FauvBvyiF7PhkbgAAAYx6PM9WAAAEAwBIMEYCIQCQZdV/dTi/1f8n8T5ZobNffrNJxsEYEceNSAhGHhXVvQIhANLt56rZa9M3RQ1jWoR8NE7PVAK4HvkfkT3u/FZ1L+rqAHcAfVkeEuF4KnscYWd8Xv340IdcFKBOlZ65Ay/ZDowuebgAAAGMejzPRQAABAMASDBGAiEAvpfnYx/kzUN103VxG3tvocyOjQaZ5thVJ+/haKWJI2ACIQDEMv4aH3ZOkq37kZvqLT6OiY2n0hh/GKVj00KpDPUB8DANBgkqhkiG9w0BAQsFAAOCAQEANJ1WTWXLtQImRF2hd6dHm02iuD48qGIx0PYEuyYqz1VsO8xpd1jIRfce2t6XXy/PxJ4SCxgO3xH9zWY7ZVyG12Izg7G1T4XaV1mPlmmRxWq3yCW55G/+6HSyDAglY+7uxLmoF6s807AW+uGL/TTI7LfowRw8fq6LW9OxRaK1pZ2E/0B3dRuuk3DowdWy2zeHP0iTx7lgIA2Ecd+mVdr91OVJXO/lOm4S01wAz46Gz2Oj1puHFb0tlraS+d/hX+1GSSiEWHl4DVy2lBzXbQpysFHF/89D8U8r/mGv930TaI2Ytzy+xhDDqXhhCuavXaZ/3kdmPNVuLvJA0sSoy+cmHWYKMiaRXE/7uyCJhaYy3wW9w5eaVCJM1YWJaWtuluqDAAAAAAAABGIwggReMIIDRqADAgECAhMHcxJKS8vUTse1O+rxlIQtOg+hMA0GCSqGSIb3DQEBCwUAMDkxCzAJBgNVBAYTAlVTMQ8wDQYDVQQKEwZBbWF6b24xGTAXBgNVBAMTEEFtYXpvbiBSb290IENBIDEwHhcNMjIwODIzMjIyNTMwWhcNMzAwODIzMjIyNTMwWjA8MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRwwGgYDVQQDExNBbWF6b24gUlNBIDIwNDggTTAyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu0MYxlqoed4p6LVvLr6lQ88uWNMHXjdKLpWkRY9zqZKQWFlv/qquRnKgeVAtsNicjYPuEPSx3MSp+e4CMiy5dAsbcDxO9fpXegU0EVV7w2Uske8Gx4pjzyxovC5/GRlXCTviDidaU0xfOVr1jkXfDBEfAxUfjjfEbPpS0ZJlKpD3h4XHlftOWq3zCGLyoJop1nms1qT6v2dROE54KWoV3ihfJyH/9FztjR5fUo1YdhIjU2TfWZiCIrcm8fTreD4r20cDrdl5OAqCd2WH5Yj7O/uLjgd6lFmMDUVjBhn1W//1SQLljPz/JTrl+CNoT7BUczh79jILaiys9YTuAn51cwIDAQABo4IBWjCCAVYwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAYYwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB0GA1UdDgQWBBTAMVLNWlDDgnx0cc7L6Zz5euuC4jAfBgNVHSMEGDAWgBSEGMyFNOy8DJSULghZnMeyEE4KCDB7BggrBgEFBQcBAQRvMG0wLwYIKwYBBQUHMAGGI2h0dHA6Ly9vY3NwLnJvb3RjYTEuYW1hem9udHJ1c3QuY29tMDoGCCsGAQUFBzAChi5odHRwOi8vY3J0LnJvb3RjYTEuYW1hem9udHJ1c3QuY29tL3Jvb3RjYTEuY2VyMD8GA1UdHwQ4MDYwNKAyoDCGLmh0dHA6Ly9jcmwucm9vdGNhMS5hbWF6b250cnVzdC5jb20vcm9vdGNhMS5jcmwwEwYDVR0gBAwwCjAIBgZngQwBAgEwDQYJKoZIhvcNAQELBQADggEBAC1OLoWzQDN+L6LCbuOvP4JLEcf64eXstrDcxBJdW1HxFXnc+1Hqv/qA2mqXN2hmrgUpsAOLW/0G6fxFjwPnW551F+Oxt6h2LN4EHydeZ7IPfcSntUBOPijNx3fVgVV+BGG9NLE2utOU2laRSTSbcEw+/yyDfzUeEDq4RiiQTmr27Cz/diQqpGITPdOxpaYmohFmExuAB+ns7sVTAUhvtQiymiBlIrE8hYmnGI+jdNwFqZttW1A5w1FbPmoJB0OyUjbJrKrSfZNegfI0IsQfyumwlFUgsWyDSNzsFoWsycXjrb5qNJ6GCPXYiJ015E3jOX4Sg1pZ2mdad29KkASSrY9mCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAANFMIIDQTCCAimgAwIBAgITBmyfz5m/jAo54vB4ikPmljZbyjANBgkqhkiG9w0BAQsFADA5MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRkwFwYDVQQDExBBbWF6b24gUm9vdCBDQSAxMB4XDTE1MDUyNjAwMDAwMFoXDTM4MDExNzAwMDAwMFowOTELMAkGA1UEBhMCVVMxDzANBgNVBAoTBkFtYXpvbjEZMBcGA1UEAxMQQW1hem9uIFJvb3QgQ0EgMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALJ4gHHKeNXjca9HgFB0fW7Y14h29Jlo91ghYPl0hAEvrAIthtOgQ3pOsqTQNroBvo3bSMgHFzZM9O6II8c+6zf1tRn4SWiw3te5djgdYZ6k/oI2peVKVuRF4fn9tBb6dNqcmzU5L/qwIFAGbHrQgLKm+a/sRxmPUDgH3KKHOVj4utWp+UhnMJbulHheb4mjUcAwhmahRWa6VOujw5H5SNz/0egwLX0tdHA114gk957EWW67c4cX8jJGKLhD+rcdqsq08p8kDi1L93FcXmn/6pUCyziKrlA4b9v7LWIbxcceVOF34GfID5yHI9Y/QCB/IIDEgEw+OyQmjgSubJrIqg0CAwEAAaNCMEAwDwYDVR0TAQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwHQYDVR0OBBYEFIQYzIU07LwMlJQuCFmcx7IQTgoIMA0GCSqGSIb3DQEBCwUAA4IBAQCY8jdaQZChGsV2USggNiMOruYou6r4lK5IpDB/G/wkjUu0yKGX9rbxenDIU5PMCCjjmCXPI6T53iHTfIUJrU6adTrCC2qJeHZERxhlbI1Bjjt/msv0tadQ1wUsN+gDS63pYaACbvXy8MWy7Vu33PqUXHeeE6V/Uq2V8viTO96LXFvKWlJbYK8U90vvo/ufQJVtMVT8QtPHRh8jrdkPSHCa2XV4cdFyQzR1bldZwgJcJmApzyMZFo6IQ6XU5MsI+yMRQ+hDKXJioaldXgjUkK642M4UwtBV8ob2xJNDd2ZhwLnoQdeXeGADbkpyrqXRfboQnoZsG4q5WTP468SQvvG5AAAAAQAAAAJoMgABAAAAAFF0bHNmbGFnczB4MDAwMDAwMDA6d3d3Lmdpbm5pZW1hZS5nb3Y6NDQzXnBhcnRpdGlvbktleT0lMjhodHRwcyUyQ2dpbm5pZW1hZS5nb3YlMjkBAA== request-method GET response-head HTTP/2 200 
content-type: application/javascript
content-length: 164553
last-modified: Mon, 12 Oct 2020 22:53:18 GMT
etag: "{21B19355-DAB9-4891-A105-E87EAAEA215F},34"
resourcetag: rt:21B19355-DAB9-4891-A105-E87EAAEA215F@00000000034
content-disposition: attachment; filename*=utf-8''jquery%2eSPServices%2d0%2e7%2e2%2ejs; filename="jquery.SPServices-0.7.2.js"
x-download-options: noopen
strict-transport-security: max-age=31536000; includeSubDomains; preload
x-frame-options: SAMEORIGIN, SAMEORIGIN
content-security-policy: frame-ancestors 'self' teams.microsoft.com *.teams.microsoft.com *.skype.com *.teams.microsoft.us local.teams.office.com *.powerapps.com *.yammer.com *.officeapps.live.com *.office.com *.stream.azure-test.net *.microsoftstream.com *.dynamics.com *.microsoft.com onedrive.live.com *.onedrive.live.com;, frame-ancestors 'self'
date: Sat, 06 Apr 2024 20:16:54 GMT
expires: Fri, 22 Mar 2024 20:16:54 GMT,0
sprequestguid: b6731ca1-d630-2062-3bd5-97da6fc086bf
request-id: b6731ca1-d630-2062-3bd5-97da6fc086bf
sprequestduration: 1193
cache-control: private,max-age=0,no-cache
pragma: no-cache
accept-ranges: bytes
x-sharepointhealthscore: 0
public-extension: http://schemas.microsoft.com/repl-2
spiislatency: 0
microsoftsharepointteamservices: 16.0.0.10407
x-content-type-options: nosniff
x-ms-invokeapp: 1; RequireReadOnly
x-from: WEB01
access-control-allow-headers: Origin, X-Requested-With, Content-Type, Accept
access-control-allow-methods: POST,GET,OPTIONS,PUT,DELETE
x-xss-protection: 1; mode=block
X-Firefox-Spdy: h2
 original-response-headers date: Sat, 06 Apr 2024 19:40:08 GMT
content-type: application/javascript
content-length: 164553
set-cookie: AWSALB=IbsCZWDSt5bkxwAeF7Yy6O9wAbICPjkuWhG64EttvTgrr0YJJCuNzGm6NM0NO4/wiH1c3cnP1smIh1ovLLYKV2seCN7ogXHPOY8oKBBHM4lKrSL3RtqZWtat7MbN; Expires=Sat, 13 Apr 2024 19:40:07 GMT; Path=/
set-cookie: AWSALBCORS=IbsCZWDSt5bkxwAeF7Yy6O9wAbICPjkuWhG64EttvTgrr0YJJCuNzGm6NM0NO4/wiH1c3cnP1smIh1ovLLYKV2seCN7ogXHPOY8oKBBHM4lKrSL3RtqZWtat7MbN; Expires=Sat, 13 Apr 2024 19:40:07 GMT; Path=/; SameSite=None; Secure
set-cookie: AWSALB=BUF8Y/ekKk5sMQRr6tG7pLQYtNg/VxVkNUSf+jnWuca6pxFNzUASWoYsczQQeUkE0VZKuv/pxSHOCesCjaPLTjbEZ5iqZNqNKFcnpz85wfvRY5cXCeJjlKUfDKKR; Expires=Sat, 13 Apr 2024 19:40:07 GMT; Path=/
set-cookie: AWSALBCORS=BUF8Y/ekKk5sMQRr6tG7pLQYtNg/VxVkNUSf+jnWuca6pxFNzUASWoYsczQQeUkE0VZKuv/pxSHOCesCjaPLTjbEZ5iqZNqNKFcnpz85wfvRY5cXCeJjlKUfDKKR; Expires=Sat, 13 Apr 2024 19:40:07 GMT; Path=/; SameSite=None; Secure
cache-control: private,max-age=0,no-cache
pragma: no-cache
expires: Fri, 22 Mar 2024 19:40:08 GMT,0
last-modified: Mon, 12 Oct 2020 22:53:18 GMT
accept-ranges: bytes
etag: "{21B19355-DAB9-4891-A105-E87EAAEA215F},34"
x-sharepointhealthscore: 0
resourcetag: rt:21B19355-DAB9-4891-A105-E87EAAEA215F@00000000034
content-disposition: attachment; filename*=utf-8''jquery%2eSPServices%2d0%2e7%2e2%2ejs; filename="jquery.SPServices-0.7.2.js"
x-download-options: noopen
public-extension: http://schemas.microsoft.com/repl-2
sprequestguid: 9b711ca1-b6b0-2062-aa45-1ea85b2261ab
request-id: 9b711ca1-b6b0-2062-aa45-1ea85b2261ab
x-frame-options: SAMEORIGIN
content-security-policy: frame-ancestors 'self' teams.microsoft.com *.teams.microsoft.com *.skype.com *.teams.microsoft.us local.teams.office.com *.powerapps.com *.yammer.com *.officeapps.live.com *.office.com *.stream.azure-test.net *.microsoftstream.com *.dynamics.com *.microsoft.com onedrive.live.com *.onedrive.live.com;
sprequestduration: 1082
spiislatency: 1
microsoftsharepointteamservices: 16.0.0.10407
x-content-type-options: nosniff
x-ms-invokeapp: 1; RequireReadOnly
x-from: WEB02
x-frame-options: SAMEORIGIN
content-security-policy: frame-ancestors 'self'
access-control-allow-headers: Origin, X-Requested-With, Content-Type, Accept
access-control-allow-methods: POST,GET,OPTIONS,PUT,DELETE
strict-transport-security: max-age=31536000; includeSubDomains; preload
x-xss-protection: 1; mode=block
X-Firefox-Spdy: h2
 ctid 2 uncompressed-len 0 net-response-time-onstart 1671 net-response-time-onstop 1857 alt-data 1;164553,javascript/moz-script-bytecode-20240222211730-8l alt-data-from-child 1  